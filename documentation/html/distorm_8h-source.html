<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>IRIS: distorm.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_014faa727c0b2aaba2cbdd8f326de4f6.html">source</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_4516642e80adc9bf50ea604a2fbf2492.html">zesto</a>
  </div>
</div>
<div class="contents">
<h1>distorm.h</h1><a href="distorm_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* diStorm64 1.7.30 */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment">distorm.h</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">Copyright (C) 2003-2008 Gil Dabah, http://ragestorm.net/distorm/</span>
<a name="l00007"></a>00007 <span class="comment">This library is licensed under the BSD license. See the file COPYING.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">This file is used in win32proj and linuxproj.</span>
<a name="l00010"></a>00010 <span class="comment">*/</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#ifndef DISTORM_H</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span><span class="preprocessor">#define DISTORM_H</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a>00015 <span class="comment">/*</span>
<a name="l00016"></a>00016 <span class="comment"> * 64 bit offsets support:</span>
<a name="l00017"></a>00017 <span class="comment"> * If the diStorm library you use was compiled with 64 bits offsets,</span>
<a name="l00018"></a>00018 <span class="comment"> * make sure you compile your own code with the following macro set:</span>
<a name="l00019"></a>00019 <span class="comment"> * SUPPORT_64BIT_OFFSET</span>
<a name="l00020"></a>00020 <span class="comment"> * Otherwise comment it out, or you will get a linker error of an unresolved symbol...</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="comment">/* TINYC has a problem with some 64bits library functions, so pass. */</span>
<a name="l00024"></a>00024 <span class="preprocessor">#ifndef __TINYC__</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>    <span class="comment">/* Make sure it wasn't already defined by the compiler itself. */</span>
<a name="l00026"></a>00026 <span class="preprocessor">    #ifndef SUPPORT_64BIT_OFFSET</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span><span class="preprocessor">            #define SUPPORT_64BIT_OFFSET</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a>00031 <span class="comment">/* If your compiler doesn't support stdint.h, define your own 64 bits type. */</span>
<a name="l00032"></a>00032 <span class="preprocessor">#ifdef SUPPORT_64BIT_OFFSET</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span><span class="preprocessor">        #ifdef _MSC_VER</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">                #define OFFSET_INTEGER unsigned __int64</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">        #else</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">                #include &lt;stdint.h&gt;</span>
<a name="l00037"></a><a class="code" href="distorm_8h.html#a88792793a9409e8feb291c7a0e6018d">00037</a> <span class="preprocessor">                #define OFFSET_INTEGER uint64_t</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">        #endif</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>        <span class="comment">/* 32 bit offsets are used. */</span>
<a name="l00041"></a>00041 <span class="preprocessor">        #define OFFSET_INTEGER unsigned long</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">/* Support C++ compilers */</span>
<a name="l00046"></a>00046 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
<a name="l00048"></a>00048 <span class="preprocessor">#endif</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="comment">/* Decodes modes of the disassembler, 16 bits or 32 bits or 64 bits for AMD64, x86-64. */</span>
<a name="l00051"></a><a class="code" href="distorm_8h.html#93c9e358f502f628b9216e3331647b576af0ecb4dfbfb31c661fb39c99b70d73">00051</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code" href="distorm_8h.html#93c9e358f502f628b9216e3331647b5716660e8d515bbce843c98dc8a85a46c2">Decode16Bits</a> = 0, <a class="code" href="distorm_8h.html#93c9e358f502f628b9216e3331647b57edd76d676fcc7e792b2d41410b8ea0f6">Decode32Bits</a> = 1, <a class="code" href="distorm_8h.html#93c9e358f502f628b9216e3331647b576af0ecb4dfbfb31c661fb39c99b70d73">Decode64Bits</a> = 2} <a class="code" href="distorm_8h.html#93c9e358f502f628b9216e3331647b57">_DecodeType</a>;
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="distorm_8h.html#65c86b0bc6d5815b4d8206f4febc3f71">00053</a> <span class="keyword">typedef</span> <a class="code" href="distorm_8h.html#a88792793a9409e8feb291c7a0e6018d">OFFSET_INTEGER</a> <a class="code" href="distorm_8h.html#65c86b0bc6d5815b4d8206f4febc3f71">_OffsetType</a>;
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="comment">/* Static size of strings. Do not change this value. */</span>
<a name="l00056"></a><a class="code" href="distorm_8h.html#18729f2eeae081f632853442b7d99f86">00056</a> <span class="preprocessor">#define MAX_TEXT_SIZE (60)</span>
<a name="l00057"></a><a class="code" href="struct__WString.html">00057</a> <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00058"></a><a class="code" href="struct__WString.html#f672a36bd5ac43eb02c489ca2ffdbe8f">00058</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length;
<a name="l00059"></a><a class="code" href="struct__WString.html#3b8b97fdc19efc61b848a24d6d4b80fe">00059</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p[<a class="code" href="distorm_8h.html#18729f2eeae081f632853442b7d99f86">MAX_TEXT_SIZE</a>]; <span class="comment">/* p is a null terminated string. */</span>
<a name="l00060"></a>00060 } <a class="code" href="struct__WString.html">_WString</a>;
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/* This structure holds all information the disassembler generates per instruction. */</span>
<a name="l00063"></a><a class="code" href="struct__DecodedInst.html">00063</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00064"></a><a class="code" href="struct__DecodedInst.html#42296a0d0848dc8da63c0e1a60cdaae6">00064</a>         <a class="code" href="struct__WString.html">_WString</a> mnemonic; <span class="comment">/* Mnemonic of decoded instruction, prefixed if required by REP, LOCK etc. */</span>
<a name="l00065"></a><a class="code" href="struct__DecodedInst.html#9d6267b4909e3718789d1af525808744">00065</a>         <a class="code" href="struct__WString.html">_WString</a> operands; <span class="comment">/* Operands of the decoded instruction, up to 3 operands, comma-seperated. */</span>
<a name="l00066"></a><a class="code" href="struct__DecodedInst.html#d84500ddfd0f4039a9f97145bc395e3f">00066</a>         <a class="code" href="struct__WString.html">_WString</a> instructionHex; <span class="comment">/* Hex dump - little endian, including prefixes. */</span>
<a name="l00067"></a><a class="code" href="struct__DecodedInst.html#e392ec7573ed166c5c0b856455c1e3ec">00067</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size; <span class="comment">/* Size of decoded instruction. */</span>
<a name="l00068"></a><a class="code" href="struct__DecodedInst.html#47f844e2770222483cefe9b0b069eba7">00068</a>         _OffsetType offset; <span class="comment">/* Start offset of the decoded instruction. */</span>
<a name="l00069"></a>00069 } <a class="code" href="struct__DecodedInst.html">_DecodedInst</a>;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">/* Return code of the decoding function. */</span>
<a name="l00072"></a><a class="code" href="distorm_8h.html#c283e6002ac5f51e11f4f90207b87b00a6aedfd474305276b80def44b7730017">00072</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code" href="distorm_8h.html#c283e6002ac5f51e11f4f90207b87b009551a9d6ea9b3d75d84cc74c1d4ff86c">DECRES_NONE</a>, <a class="code" href="distorm_8h.html#c283e6002ac5f51e11f4f90207b87b00a6aedfd474305276b80def44b7730017">DECRES_SUCCESS</a>, <a class="code" href="distorm_8h.html#c283e6002ac5f51e11f4f90207b87b004cd6726e1eefbbaf578edf55966fb74d">DECRES_MEMORYERR</a>, <a class="code" href="distorm_8h.html#c283e6002ac5f51e11f4f90207b87b0083c7628700b0583f81279c021dcbe424">DECRES_INPUTERR</a>} <a class="code" href="distorm_8h.html#c283e6002ac5f51e11f4f90207b87b00">_DecodeResult</a>;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">/* distorm_decode</span>
<a name="l00075"></a>00075 <span class="comment"> * Input:</span>
<a name="l00076"></a>00076 <span class="comment"> *         offset - Origin of the given code (virtual address that is), NOT an offset in code.</span>
<a name="l00077"></a>00077 <span class="comment"> *         code - Pointer to the code buffer to be disassembled.</span>
<a name="l00078"></a>00078 <span class="comment"> *         length - Amount of bytes that should be decoded from the code buffer.</span>
<a name="l00079"></a>00079 <span class="comment"> *         dt - Decoding mode, 16 bits (Decode16Bits), 32 bits (Decode32Bits) or AMD64 (Decode64Bits).</span>
<a name="l00080"></a>00080 <span class="comment"> *         result - Array of type _DecodeInst which will be used by this function in order to return the disassembled instructions.</span>
<a name="l00081"></a>00081 <span class="comment"> *         maxInstructions - The maximum number of entries in the result array that you pass to this function, so it won't exceed its bound.</span>
<a name="l00082"></a>00082 <span class="comment"> *         usedInstructionsCount - Number of the instruction that successfully were disassembled and written to the result array.</span>
<a name="l00083"></a>00083 <span class="comment"> * Output: usedInstructionsCount will hold the number of entries used in the result array</span>
<a name="l00084"></a>00084 <span class="comment"> *         and the result array itself will be filled with the disassembled instructions.</span>
<a name="l00085"></a>00085 <span class="comment"> * Return: DECRES_SUCCESS on success (no more to disassemble), DECRES_INPUTERR on input error (null code buffer, invalid decoding mode, etc...),</span>
<a name="l00086"></a>00086 <span class="comment"> *         DECRES_MEMORYERR when there are not enough entries to use in the result array, BUT YOU STILL have to check for usedInstructionsCount!</span>
<a name="l00087"></a>00087 <span class="comment"> * Side-Effects: Even if the return code is DECRES_MEMORYERR, there might STILL be data in the</span>
<a name="l00088"></a>00088 <span class="comment"> *               array you passed, this function will try to use as much entries as possible!</span>
<a name="l00089"></a>00089 <span class="comment"> * Notes:  1)The minimal size of maxInstructions is 15.</span>
<a name="l00090"></a>00090 <span class="comment"> *         2)You will have to synchronize the offset,code and length by yourself if you pass code fragments and not a complete code block!</span>
<a name="l00091"></a>00091 <span class="comment"> */</span>
<a name="l00092"></a>00092 <span class="preprocessor">#ifdef SUPPORT_64BIT_OFFSET</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span>        <a class="code" href="distorm_8h.html#c283e6002ac5f51e11f4f90207b87b00">_DecodeResult</a> <a class="code" href="distorm_8h.html#838b7e26526231f1f8b8c09bdd29d7b2">distorm_decode64</a>(_OffsetType codeOffset, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* code, <span class="keywordtype">int</span> codeLen, <a class="code" href="distorm_8h.html#93c9e358f502f628b9216e3331647b57">_DecodeType</a> dt, <a class="code" href="struct__DecodedInst.html">_DecodedInst</a> result[], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxInstructions, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* usedInstructionsCount);
<a name="l00094"></a><a class="code" href="distorm_8h.html#3fe135bd26151eeaed3f69f4fae0c884">00094</a> <span class="preprocessor">        #define distorm_decode distorm_decode64</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span>        <a class="code" href="distorm_8h.html#c283e6002ac5f51e11f4f90207b87b00">_DecodeResult</a> distorm_decode32(_OffsetType codeOffset, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* code, <span class="keywordtype">int</span> codeLen, <a class="code" href="distorm_8h.html#93c9e358f502f628b9216e3331647b57">_DecodeType</a> dt, <a class="code" href="struct__DecodedInst.html">_DecodedInst</a> result[], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxInstructions, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* usedInstructionsCount);
<a name="l00097"></a>00097 <span class="preprocessor">        #define distorm_decode distorm_decode32</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span>
<a name="l00100"></a>00100 <span class="comment">/*</span>
<a name="l00101"></a>00101 <span class="comment"> * distorm_version</span>
<a name="l00102"></a>00102 <span class="comment"> * Input:</span>
<a name="l00103"></a>00103 <span class="comment"> *        none</span>
<a name="l00104"></a>00104 <span class="comment"> *</span>
<a name="l00105"></a>00105 <span class="comment"> * Output: unsigned int - version of compiler library.</span>
<a name="l00106"></a>00106 <span class="comment"> */</span>
<a name="l00107"></a>00107 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distorm_8h.html#f8d26966ba41e03f19997b4bea5484a8">distorm_version</a>();
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00110"></a>00110 <span class="preprocessor"></span>} <span class="comment">/* End Of Extern */</span>
<a name="l00111"></a>00111 <span class="preprocessor">#endif</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>
<a name="l00113"></a>00113 <span class="preprocessor">#endif </span><span class="comment">/* DISTORM_H */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 23 00:20:56 2010 for IRIS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
