<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>IRIS: zesto-bpred.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_014faa727c0b2aaba2cbdd8f326de4f6.html">source</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_4516642e80adc9bf50ea604a2fbf2492.html">zesto</a>
  </div>
</div>
<div class="contents">
<h1>zesto-bpred.h</h1><a href="zesto-bpred_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef ZESTO_BPRED_INCLUDED</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define ZESTO_BPRED_INCLUDED</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="comment">/* zesto-bpred.h - Zesto branch predictor classes</span>
<a name="l00005"></a>00005 <span class="comment"> * </span>
<a name="l00006"></a>00006 <span class="comment"> * Copyright © 2009 by Gabriel H. Loh and the Georgia Tech Research Corporation</span>
<a name="l00007"></a>00007 <span class="comment"> * Atlanta, GA  30332-0415</span>
<a name="l00008"></a>00008 <span class="comment"> * All Rights Reserved.</span>
<a name="l00009"></a>00009 <span class="comment"> * </span>
<a name="l00010"></a>00010 <span class="comment"> * THIS IS A LEGAL DOCUMENT BY DOWNLOADING ZESTO, YOU ARE AGREEING TO THESE</span>
<a name="l00011"></a>00011 <span class="comment"> * TERMS AND CONDITIONS.</span>
<a name="l00012"></a>00012 <span class="comment"> * </span>
<a name="l00013"></a>00013 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span>
<a name="l00014"></a>00014 <span class="comment"> * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<a name="l00015"></a>00015 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<a name="l00016"></a>00016 <span class="comment"> * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNERS OR CONTRIBUTORS BE</span>
<a name="l00017"></a>00017 <span class="comment"> * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<a name="l00018"></a>00018 <span class="comment"> * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<a name="l00019"></a>00019 <span class="comment"> * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<a name="l00020"></a>00020 <span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<a name="l00021"></a>00021 <span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<a name="l00022"></a>00022 <span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<a name="l00023"></a>00023 <span class="comment"> * POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00024"></a>00024 <span class="comment"> * </span>
<a name="l00025"></a>00025 <span class="comment"> * NOTE: Portions of this release are directly derived from the SimpleScalar</span>
<a name="l00026"></a>00026 <span class="comment"> * Toolset (property of SimpleScalar LLC), and as such, those portions are</span>
<a name="l00027"></a>00027 <span class="comment"> * bound by the corresponding legal terms and conditions.  All source files</span>
<a name="l00028"></a>00028 <span class="comment"> * derived directly or in part from the SimpleScalar Toolset bear the original</span>
<a name="l00029"></a>00029 <span class="comment"> * user agreement.</span>
<a name="l00030"></a>00030 <span class="comment"> * </span>
<a name="l00031"></a>00031 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00032"></a>00032 <span class="comment"> * modification, are permitted provided that the following conditions are met:</span>
<a name="l00033"></a>00033 <span class="comment"> * </span>
<a name="l00034"></a>00034 <span class="comment"> * 1. Redistributions of source code must retain the above copyright notice,</span>
<a name="l00035"></a>00035 <span class="comment"> * this list of conditions and the following disclaimer.</span>
<a name="l00036"></a>00036 <span class="comment"> * </span>
<a name="l00037"></a>00037 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright notice,</span>
<a name="l00038"></a>00038 <span class="comment"> * this list of conditions and the following disclaimer in the documentation</span>
<a name="l00039"></a>00039 <span class="comment"> * and/or other materials provided with the distribution.</span>
<a name="l00040"></a>00040 <span class="comment"> * </span>
<a name="l00041"></a>00041 <span class="comment"> * 3. Neither the name of the Georgia Tech Research Corporation nor the names of</span>
<a name="l00042"></a>00042 <span class="comment"> * its contributors may be used to endorse or promote products derived from</span>
<a name="l00043"></a>00043 <span class="comment"> * this software without specific prior written permission.</span>
<a name="l00044"></a>00044 <span class="comment"> * </span>
<a name="l00045"></a>00045 <span class="comment"> * 4. Zesto is distributed freely for commercial and non-commercial use.  Note,</span>
<a name="l00046"></a>00046 <span class="comment"> * however, that the portions derived from the SimpleScalar Toolset are bound</span>
<a name="l00047"></a>00047 <span class="comment"> * by the terms and agreements set forth by SimpleScalar, LLC.  In particular:</span>
<a name="l00048"></a>00048 <span class="comment"> * </span>
<a name="l00049"></a>00049 <span class="comment"> *   "Nonprofit and noncommercial use is encouraged. SimpleScalar may be</span>
<a name="l00050"></a>00050 <span class="comment"> *   downloaded, compiled, executed, copied, and modified solely for nonprofit,</span>
<a name="l00051"></a>00051 <span class="comment"> *   educational, noncommercial research, and noncommercial scholarship</span>
<a name="l00052"></a>00052 <span class="comment"> *   purposes provided that this notice in its entirety accompanies all copies.</span>
<a name="l00053"></a>00053 <span class="comment"> *   Copies of the modified software can be delivered to persons who use it</span>
<a name="l00054"></a>00054 <span class="comment"> *   solely for nonprofit, educational, noncommercial research, and</span>
<a name="l00055"></a>00055 <span class="comment"> *   noncommercial scholarship purposes provided that this notice in its</span>
<a name="l00056"></a>00056 <span class="comment"> *   entirety accompanies all copies."</span>
<a name="l00057"></a>00057 <span class="comment"> * </span>
<a name="l00058"></a>00058 <span class="comment"> * User is responsible for reading and adhering to the terms set forth by</span>
<a name="l00059"></a>00059 <span class="comment"> * SimpleScalar, LLC where appropriate.</span>
<a name="l00060"></a>00060 <span class="comment"> * </span>
<a name="l00061"></a>00061 <span class="comment"> * 5. No nonprofit user may place any restrictions on the use of this software,</span>
<a name="l00062"></a>00062 <span class="comment"> * including as modified by the user, by any other authorized user.</span>
<a name="l00063"></a>00063 <span class="comment"> * </span>
<a name="l00064"></a>00064 <span class="comment"> * 6. Noncommercial and nonprofit users may distribute copies of Zesto in</span>
<a name="l00065"></a>00065 <span class="comment"> * compiled or executable form as set forth in Section 2, provided that either:</span>
<a name="l00066"></a>00066 <span class="comment"> * (A) it is accompanied by the corresponding machine-readable source code, or</span>
<a name="l00067"></a>00067 <span class="comment"> * (B) it is accompanied by a written offer, with no time limit, to give anyone</span>
<a name="l00068"></a>00068 <span class="comment"> * a machine-readable copy of the corresponding source code in return for</span>
<a name="l00069"></a>00069 <span class="comment"> * reimbursement of the cost of distribution. This written offer must permit</span>
<a name="l00070"></a>00070 <span class="comment"> * verbatim duplication by anyone, or (C) it is distributed by someone who</span>
<a name="l00071"></a>00071 <span class="comment"> * received only the executable form, and is accompanied by a copy of the</span>
<a name="l00072"></a>00072 <span class="comment"> * written offer of source code.</span>
<a name="l00073"></a>00073 <span class="comment"> * </span>
<a name="l00074"></a>00074 <span class="comment"> * 7. Zesto was developed by Gabriel H. Loh, Ph.D.  US Mail: 266 Ferst Drive,</span>
<a name="l00075"></a>00075 <span class="comment"> * Georgia Institute of Technology, Atlanta, GA 30332-0765</span>
<a name="l00076"></a>00076 <span class="comment"> */</span>
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="preprocessor">#include "<a class="code" href="machine_8h.html">machine.h</a>"</span>
<a name="l00079"></a>00079 <span class="preprocessor">#include "<a class="code" href="zesto-structs_8h.html">zesto-structs.h</a>"</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/* Top-level "branch predictor" this handles direction, target, return address, etc. */</span>
<a name="l00082"></a><a class="code" href="classbpred__t.html">00082</a> <span class="keyword">class </span><a class="code" href="classbpred__t.html">bpred_t</a>
<a name="l00083"></a>00083 {
<a name="l00084"></a>00084   <span class="keyword">protected</span>:
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="classbpred__t.html#c8e6b65af23e18f5de1b3ad465bf5c69">00086</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classbpred__t.html#c8e6b65af23e18f5de1b3ad465bf5c69">num_pred</a>;
<a name="l00087"></a><a class="code" href="classbpred__t.html#7de55e7d3aa1ff1206e1de8eade29bdb">00087</a>   <span class="keyword">class </span><a class="code" href="classbpred__dir__t.html">bpred_dir_t</a> ** <a class="code" href="classbpred__t.html#7de55e7d3aa1ff1206e1de8eade29bdb">bpreds</a>;     <span class="comment">/* branch direction predictor state(s) */</span>
<a name="l00088"></a><a class="code" href="classbpred__t.html#300cba846e9628def5bf6256e9b1cc87">00088</a>   <span class="keyword">class </span><a class="code" href="classfusion__t.html">fusion_t</a> * <a class="code" href="classbpred__t.html#300cba846e9628def5bf6256e9b1cc87">fusion</a>;         <span class="comment">/* meta-predictor state, combines preds from</span>
<a name="l00089"></a>00089 <span class="comment">                                       the branch direction predictors */</span>
<a name="l00090"></a><a class="code" href="classbpred__t.html#19b366397440390436a4dd3617e87746">00090</a>   <span class="keyword">class </span><a class="code" href="classRAS__t.html">RAS_t</a> * <a class="code" href="classbpred__t.html#19b366397440390436a4dd3617e87746">ras</a>;                <span class="comment">/* subroutine return address predictor state */</span>
<a name="l00091"></a><a class="code" href="classbpred__t.html#5371b500167cc248dabd8a3244713a82">00091</a>   <span class="keyword">class </span><a class="code" href="classBTB__t.html">BTB_t</a> * <a class="code" href="classbpred__t.html#5371b500167cc248dabd8a3244713a82">dirjmp_BTB</a>;         <span class="comment">/* direct (pc-relative) br/jmp target predictor */</span>
<a name="l00092"></a><a class="code" href="classbpred__t.html#b1c6ee96f45980916c5a25b3453e5115">00092</a>   <span class="keyword">class </span><a class="code" href="classBTB__t.html">BTB_t</a> * <a class="code" href="classbpred__t.html#b1c6ee96f45980916c5a25b3453e5115">indirjmp_BTB</a>;       <span class="comment">/* indirect (computed) br/jmp target predictor;</span>
<a name="l00093"></a>00093 <span class="comment">                                       if only one BTB is used for all targets, then</span>
<a name="l00094"></a>00094 <span class="comment">                                       these pointers will point to the same place. */</span>
<a name="l00095"></a><a class="code" href="classbpred__t.html#020bbd24e0522b6a82b7e571c175b4b0">00095</a>   <span class="keywordtype">int</span> <a class="code" href="classbpred__t.html#020bbd24e0522b6a82b7e571c175b4b0">bpredSCC_size</a>;
<a name="l00096"></a><a class="code" href="classbpred__t.html#c0a1914924a2fd079f3bdcbace4b48d0">00096</a>   <span class="keywordtype">int</span> <a class="code" href="classbpred__t.html#c0a1914924a2fd079f3bdcbace4b48d0">bpredSCC_head</a>;
<a name="l00097"></a><a class="code" href="classbpred__t.html#4503313bf5a35ddfd7d8ee94f0d60d7c">00097</a>   <span class="keyword">class </span><a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a> ** <a class="code" href="classbpred__t.html#4503313bf5a35ddfd7d8ee94f0d60d7c">bpredSCC</a>;
<a name="l00098"></a><a class="code" href="classbpred__t.html#2059f9daab0482f8a3c0a4769732f6be">00098</a>   <span class="keywordtype">int</span> <a class="code" href="classbpred__t.html#2059f9daab0482f8a3c0a4769732f6be">SC_debt</a>;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="comment">/* stats on branch type distributions */</span>
<a name="l00101"></a><a class="code" href="classbpred__t.html#5ce0df824b86b90926f3f23147ebbf9c">00101</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#5ce0df824b86b90926f3f23147ebbf9c">num_lookups</a>;
<a name="l00102"></a><a class="code" href="classbpred__t.html#1daed1dfe9ffc4f9348e8389cb5124c7">00102</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#1daed1dfe9ffc4f9348e8389cb5124c7">num_updates</a>;
<a name="l00103"></a><a class="code" href="classbpred__t.html#2106c58e9dd647314e5ec90ae70c46f6">00103</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#2106c58e9dd647314e5ec90ae70c46f6">num_spec_updates</a>;
<a name="l00104"></a><a class="code" href="classbpred__t.html#c16452be4da77e73e8524685b750b750">00104</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#c16452be4da77e73e8524685b750b750">num_cond</a>;
<a name="l00105"></a><a class="code" href="classbpred__t.html#d5a398f1789e25ad0a9af9d88d1af99c">00105</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#d5a398f1789e25ad0a9af9d88d1af99c">num_call</a>;
<a name="l00106"></a><a class="code" href="classbpred__t.html#bd80009e12bcbe934967ae1b1d166ae4">00106</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#bd80009e12bcbe934967ae1b1d166ae4">num_ret</a>;
<a name="l00107"></a><a class="code" href="classbpred__t.html#53953ed71e763537bedb1fb12bdd6979">00107</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#53953ed71e763537bedb1fb12bdd6979">num_uncond</a>;
<a name="l00108"></a><a class="code" href="classbpred__t.html#445e72f075736ec44e7972cef6626dd9">00108</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#445e72f075736ec44e7972cef6626dd9">num_dir_hits</a>;  <span class="comment">/* for *all* branches, conditional or not */</span>
<a name="l00109"></a><a class="code" href="classbpred__t.html#b866fbaf6482bdc5192786b4f902293f">00109</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__t.html#b866fbaf6482bdc5192786b4f902293f">num_addr_hits</a>; <span class="comment">/* ditto */</span>
<a name="l00110"></a><a class="code" href="classbpred__t.html#fc29e92b0c869eafc6065952c99d7063">00110</a>   <span class="keywordtype">bool</span> <a class="code" href="classbpred__t.html#fc29e92b0c869eafc6065952c99d7063">frozen</a>;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112   <span class="keyword">public</span>:
<a name="l00113"></a>00113 
<a name="l00114"></a>00114   <a class="code" href="classbpred__t.html#079b520ec2ae62a561ede3cb4d4994b1">bpred_t</a>(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**, <span class="keywordtype">char</span>*, <span class="keywordtype">char</span>*, <span class="keywordtype">char</span>*, <span class="keywordtype">char</span>*);
<a name="l00115"></a>00115   <a class="code" href="classbpred__t.html#835d572c43d6dbfcdc2076e2518f42c6">~bpred_t</a>();
<a name="l00116"></a>00116 
<a name="l00117"></a>00117   <span class="comment">/* PC = current PC of the branch being predicted</span>
<a name="l00118"></a>00118 <span class="comment">     fallthruPC = PC if branch is not taken (varies in x86 due to non-uniform instruction lengths)</span>
<a name="l00119"></a>00119 <span class="comment">     targetPC = PC if branch is taken</span>
<a name="l00120"></a>00120 <span class="comment">     oraclePC = correct next-instruction PC</span>
<a name="l00121"></a>00121 <span class="comment">     outcome = correct taken/not-taken decision */</span>
<a name="l00122"></a>00122   <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="classbpred__t.html#eb9b5d4a17fb1fb8ea0055de44874d4e">lookup</a>(
<a name="l00123"></a>00123       <span class="keyword">class</span> <a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a> * <span class="keyword">const</span> scvp,
<a name="l00124"></a>00124       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> opflags,
<a name="l00125"></a>00125       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00126"></a>00126       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> fallthruPC,
<a name="l00127"></a>00127       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> targetPC,
<a name="l00128"></a>00128       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oraclePC,
<a name="l00129"></a>00129       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   <span class="keywordtype">void</span> <a class="code" href="classbpred__t.html#8c7073a32e9c65c31b1af33b6c16b754">update</a>(
<a name="l00132"></a>00132       <span class="keyword">class</span> <a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a> * <span class="keyword">const</span> scvp,
<a name="l00133"></a>00133       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> opflags,
<a name="l00134"></a>00134       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00135"></a>00135       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> targetPC,
<a name="l00136"></a>00136       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oraclePC,
<a name="l00137"></a>00137       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   <span class="keywordtype">void</span> <a class="code" href="classbpred__t.html#90e48993937d7ed40623003e6d76b138">spec_update</a>(
<a name="l00140"></a>00140       <span class="keyword">class</span> <a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a> * <span class="keyword">const</span> scvp,
<a name="l00141"></a>00141       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> opflags,
<a name="l00142"></a>00142       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00143"></a>00143       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> targetPC,
<a name="l00144"></a>00144       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oraclePC,
<a name="l00145"></a>00145       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome);
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="keywordtype">void</span> <a class="code" href="classbpred__t.html#d355ab253a6029ba45cc4fa10229081d">recover</a>(
<a name="l00148"></a>00148       <span class="keyword">class</span> <a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a> * <span class="keyword">const</span> scvp,
<a name="l00149"></a>00149       <span class="keywordtype">bool</span> outcome);
<a name="l00150"></a>00150 
<a name="l00151"></a>00151   <span class="keywordtype">void</span> <a class="code" href="classbpred__t.html#5e29cd0982fcca98f66db5f4cc11321a">flush</a>(<span class="keyword">class</span> <a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a> * <span class="keyword">const</span> scvp);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153   <span class="keywordtype">void</span> <a class="code" href="classbpred__t.html#e3a461a94838883fc3571879d08b4c75">reg_stats</a>(
<a name="l00154"></a>00154       <span class="keyword">struct</span> <a class="code" href="structstat__sdb__t.html">stat_sdb_t</a> * <span class="keyword">const</span> sdb,
<a name="l00155"></a>00155       <span class="keyword">struct</span> <a class="code" href="classcore__t.html">core_t</a> * <span class="keyword">const</span> core);
<a name="l00156"></a>00156 
<a name="l00157"></a>00157   <span class="keywordtype">void</span> <a class="code" href="classbpred__t.html#256cf64d1d35419885b964316cfa95f2">reset_stats</a>();
<a name="l00158"></a>00158   <span class="keywordtype">void</span> <a class="code" href="classbpred__t.html#6ccd38354851e9913ad09445cd5bcd5e">freeze_stats</a>();
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <span class="comment">/* instead of the bpred_update structs used in the</span>
<a name="l00161"></a>00161 <span class="comment">     old bpred.[ch], each predictor can provide its</span>
<a name="l00162"></a>00162 <span class="comment">     own structs for caching away whatever state it</span>
<a name="l00163"></a>00163 <span class="comment">     wants to between lookup and update. */</span>
<a name="l00164"></a>00164   <span class="keyword">class </span><a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a> * <a class="code" href="classbpred__t.html#48647ea733ca43990ea2a9b8c4d03ab8">get_state_cache</a>(<span class="keywordtype">void</span>);
<a name="l00165"></a>00165   <span class="keywordtype">void</span>   <a class="code" href="classbpred__t.html#f9c3b3c249ede7672c20b900ff8768e9">return_state_cache</a>(<span class="keyword">class</span> <a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a> * <span class="keyword">const</span> <span class="comment">/* state cache being returned */</span>);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167   <span class="keyword">private</span>: <span class="comment">/* called from constructor/destructor */</span>
<a name="l00168"></a>00168   <span class="keywordtype">void</span>   <a class="code" href="classbpred__t.html#20daf02e6bf98c4ab5ee282b22e735c3">init_state_cache_pool</a>(<span class="keywordtype">int</span> <span class="comment">/* initial pool size */</span>);
<a name="l00169"></a>00169   <span class="keywordtype">void</span>   <a class="code" href="classbpred__t.html#2cc9b44a57aa40da4430f0b3598d3d53">destroy_state_cache_pool</a>(<span class="keywordtype">void</span>);
<a name="l00170"></a>00170 };
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 <span class="comment">/* TODO: split dir, fusion, btb, ras into separate files */</span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">/* default State Cache; everyone should have an updated</span>
<a name="l00176"></a>00176 <span class="comment">   flag: you can be speculatively updated multiple times, but</span>
<a name="l00177"></a>00177 <span class="comment">   should only be "really" updated once. */</span>
<a name="l00178"></a><a class="code" href="classbpred__sc__t.html">00178</a> <span class="keyword">class </span><a class="code" href="classbpred__sc__t.html">bpred_sc_t</a>
<a name="l00179"></a>00179 {
<a name="l00180"></a>00180   <span class="keyword">public</span>:
<a name="l00181"></a><a class="code" href="classbpred__sc__t.html#c3847392b57d2dcdf0d05e5880bf4354">00181</a>   <span class="keywordtype">bool</span> <a class="code" href="classbpred__sc__t.html#c3847392b57d2dcdf0d05e5880bf4354">updated</a>;
<a name="l00182"></a><a class="code" href="classbpred__sc__t.html#f958009f8e5e751dfc236006ddbbb420">00182</a>   <a class="code" href="classbpred__sc__t.html#f958009f8e5e751dfc236006ddbbb420">bpred_sc_t</a>(): <a class="code" href="classbpred__sc__t.html#c3847392b57d2dcdf0d05e5880bf4354">updated</a>(false) {};
<a name="l00183"></a>00183 };
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="comment">/* Branch direction predictor */</span>
<a name="l00186"></a><a class="code" href="classbpred__dir__t.html">00186</a> <span class="keyword">class </span><a class="code" href="classbpred__dir__t.html">bpred_dir_t</a>
<a name="l00187"></a>00187 {
<a name="l00188"></a><a class="code" href="classbpred__dir__t.html#44319d3cf67079457eb46e2c6fcfeb49">00188</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classbpred__t.html">bpred_t</a>;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   <span class="keyword">protected</span>:
<a name="l00191"></a><a class="code" href="classbpred__dir__t.html#9013be37a8f9cbcc52cc01fc1f8aafa9">00191</a>   <span class="keywordtype">char</span> * <a class="code" href="classbpred__dir__t.html#9013be37a8f9cbcc52cc01fc1f8aafa9">name</a>;
<a name="l00192"></a><a class="code" href="classbpred__dir__t.html#af2aa983e49e8feae174ab4fb5e1449c">00192</a>   <span class="keywordtype">char</span> * <a class="code" href="classbpred__dir__t.html#af2aa983e49e8feae174ab4fb5e1449c">type</a>;
<a name="l00193"></a><a class="code" href="classbpred__dir__t.html#43d45896b2fa5c0aa4cbc20239785981">00193</a>   <span class="keywordtype">int</span> <a class="code" href="classbpred__dir__t.html#43d45896b2fa5c0aa4cbc20239785981">bits</a>;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195   <span class="keywordtype">void</span> <a class="code" href="classbpred__dir__t.html#d705e0919d6c44fbecbb22d0cb9b4472">init</a>(<span class="keywordtype">void</span>);
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="classbpred__dir__t.html#d06da5a7f4a14c4fc9aaeccfe372d670">00197</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__dir__t.html#d06da5a7f4a14c4fc9aaeccfe372d670">num_hits</a>;
<a name="l00198"></a><a class="code" href="classbpred__dir__t.html#ecc5eb77ad09556f9aa4508bf97b22bc">00198</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__dir__t.html#ecc5eb77ad09556f9aa4508bf97b22bc">lookups</a>;
<a name="l00199"></a><a class="code" href="classbpred__dir__t.html#4d16ce2c6b4483b91ded994c32c5be0b">00199</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__dir__t.html#4d16ce2c6b4483b91ded994c32c5be0b">updates</a>;
<a name="l00200"></a><a class="code" href="classbpred__dir__t.html#4c97447b42a0b9e1d79dd6e4df8f1430">00200</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classbpred__dir__t.html#4c97447b42a0b9e1d79dd6e4df8f1430">spec_updates</a>;
<a name="l00201"></a><a class="code" href="classbpred__dir__t.html#976eb78d60d0956a4cc13018b110c102">00201</a>   <span class="keywordtype">bool</span> <a class="code" href="classbpred__dir__t.html#976eb78d60d0956a4cc13018b110c102">frozen</a>; <span class="comment">/* set to TRUE when the core has reached its inst limit and stats should not longer be updated */</span>
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <span class="keyword">public</span>:
<a name="l00204"></a>00204            <a class="code" href="classbpred__dir__t.html#d966ab44f9a56a8c75f94da4df9ca01f">bpred_dir_t</a>();
<a name="l00205"></a>00205   <span class="keyword">virtual</span> <a class="code" href="classbpred__dir__t.html#20e50d4272da7ce52cc2574610762be0">~bpred_dir_t</a>();
<a name="l00206"></a>00206 
<a name="l00207"></a>00207   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classbpred__dir__t.html#dba28e61c7848e2fd5b9e66a6a1436c4">lookup</a>(
<a name="l00208"></a>00208       <span class="keyword">class</span> <a class="code" href="classbpred__sc__t.html">bpred_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00209"></a>00209       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00210"></a>00210       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00211"></a>00211       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00212"></a>00212       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome) = 0;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbpred__dir__t.html#97de6b26c27583e4b50d6589239a6a70">update</a>(
<a name="l00215"></a>00215       <span class="keyword">class</span> <a class="code" href="classbpred__sc__t.html">bpred_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00216"></a>00216       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00217"></a>00217       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00218"></a>00218       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00219"></a>00219       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome,
<a name="l00220"></a>00220       <span class="keyword">const</span> <span class="keywordtype">bool</span> our_pred);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbpred__dir__t.html#5cc6a00701056ccfac14645b8f7d8d42">spec_update</a>(
<a name="l00223"></a>00223       <span class="keyword">class</span> <a class="code" href="classbpred__sc__t.html">bpred_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00224"></a>00224       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00225"></a>00225       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00226"></a>00226       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00227"></a>00227       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome,
<a name="l00228"></a>00228       <span class="keyword">const</span> <span class="keywordtype">bool</span> our_pred);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbpred__dir__t.html#129ea8908118df7d544af134f418f051">recover</a>(
<a name="l00231"></a>00231       <span class="keyword">class</span> <a class="code" href="classbpred__sc__t.html">bpred_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00232"></a>00232       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbpred__dir__t.html#7ab8f00f12623bef37493663d2626954">flush</a>(<span class="keyword">class</span> <a class="code" href="classbpred__sc__t.html">bpred_sc_t</a> * <span class="keyword">const</span> scvp);
<a name="l00235"></a>00235 
<a name="l00236"></a>00236   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbpred__dir__t.html#319dc721621dfdd5024c3aa7efd966dd">reg_stats</a>(
<a name="l00237"></a>00237       <span class="keyword">struct</span> <a class="code" href="structstat__sdb__t.html">stat_sdb_t</a> * <span class="keyword">const</span> sdb,
<a name="l00238"></a>00238       <span class="keyword">struct</span> <a class="code" href="classcore__t.html">core_t</a> * <span class="keyword">const</span> core);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbpred__dir__t.html#3de25d231524346cf152a56110b962db">reset_stats</a>(<span class="keywordtype">void</span>);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   <span class="keyword">virtual</span> <span class="keyword">class </span><a class="code" href="classbpred__sc__t.html">bpred_sc_t</a> * <a class="code" href="classbpred__dir__t.html#0b63c3ce792598d30615dc412dfec66c">get_cache</a>(<span class="keywordtype">void</span>);
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbpred__dir__t.html#f3515ecca72f2b35a35f53168beda0e3">ret_cache</a>(<span class="keyword">class</span> <a class="code" href="classbpred__sc__t.html">bpred_sc_t</a> * <span class="keyword">const</span> scvp);
<a name="l00245"></a>00245 };
<a name="l00246"></a>00246 
<a name="l00247"></a><a class="code" href="classfusion__sc__t.html">00247</a> <span class="keyword">class </span><a class="code" href="classfusion__sc__t.html">fusion_sc_t</a>:<span class="keyword">public</span> <a class="code" href="classbpred__sc__t.html">bpred_sc_t</a>
<a name="l00248"></a>00248 {
<a name="l00249"></a>00249 };
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 <span class="comment">/* Branch direction meta-predictor */</span>
<a name="l00252"></a><a class="code" href="classfusion__t.html">00252</a> <span class="keyword">class </span><a class="code" href="classfusion__t.html">fusion_t</a>
<a name="l00253"></a>00253 {
<a name="l00254"></a><a class="code" href="classfusion__t.html#44319d3cf67079457eb46e2c6fcfeb49">00254</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classbpred__t.html">bpred_t</a>;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256   <span class="keyword">protected</span>:
<a name="l00257"></a><a class="code" href="classfusion__t.html#9fc6daa850cc2f748b839bcd8dedf9ea">00257</a>   <span class="keywordtype">char</span> * <a class="code" href="classfusion__t.html#9fc6daa850cc2f748b839bcd8dedf9ea">name</a>;
<a name="l00258"></a><a class="code" href="classfusion__t.html#7cccd266cdca11cad51fa7bd848391c6">00258</a>   <span class="keywordtype">char</span> * <a class="code" href="classfusion__t.html#7cccd266cdca11cad51fa7bd848391c6">type</a>;
<a name="l00259"></a><a class="code" href="classfusion__t.html#da3872e69676e0d38f54db3f549d471b">00259</a>   <span class="keywordtype">int</span> <a class="code" href="classfusion__t.html#da3872e69676e0d38f54db3f549d471b">bits</a>;
<a name="l00260"></a><a class="code" href="classfusion__t.html#ce0fc3061288ad024a3fd3295ada0ae9">00260</a>   <span class="keywordtype">int</span> <a class="code" href="classfusion__t.html#ce0fc3061288ad024a3fd3295ada0ae9">num_pred</a>;
<a name="l00261"></a>00261 
<a name="l00262"></a><a class="code" href="classfusion__t.html#f1f594aa25cd5c1226431ad412549ca5">00262</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classfusion__t.html#f1f594aa25cd5c1226431ad412549ca5">num_hits</a>;
<a name="l00263"></a><a class="code" href="classfusion__t.html#ca5bb14f422e74aa3d055b41b45c75aa">00263</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classfusion__t.html#ca5bb14f422e74aa3d055b41b45c75aa">lookups</a>;
<a name="l00264"></a><a class="code" href="classfusion__t.html#7788554edd47ba65da50c9def7cff27a">00264</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classfusion__t.html#7788554edd47ba65da50c9def7cff27a">updates</a>;
<a name="l00265"></a><a class="code" href="classfusion__t.html#00685b4010d24234f2cb730c66d6e5a6">00265</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classfusion__t.html#00685b4010d24234f2cb730c66d6e5a6">spec_updates</a>;
<a name="l00266"></a><a class="code" href="classfusion__t.html#34715b7ae32a370b5ab8b6665500d474">00266</a>   <span class="keywordtype">bool</span> <a class="code" href="classfusion__t.html#34715b7ae32a370b5ab8b6665500d474">frozen</a>; <span class="comment">/* set to TRUE when the core has reached its inst limit and stats should not longer be updated */</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268   <span class="keywordtype">void</span> <a class="code" href="classfusion__t.html#65608af086c04e3ce10acf9c3bcbe8de">init</a>(<span class="keywordtype">void</span>);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270   <span class="keyword">public</span>:
<a name="l00271"></a>00271            <a class="code" href="classfusion__t.html#0bb39051ad152e546033b564a608cada">fusion_t</a>();
<a name="l00272"></a>00272   <span class="keyword">virtual</span> <a class="code" href="classfusion__t.html#a1f8e38b8c0185c3f432766095931aab">~fusion_t</a>();
<a name="l00273"></a>00273 
<a name="l00274"></a>00274   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classfusion__t.html#f656d3765cd45035faa19d0fee146c85">lookup</a>(
<a name="l00275"></a>00275       <span class="keyword">class</span> <a class="code" href="classfusion__sc__t.html">fusion_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00276"></a>00276       <span class="keyword">const</span> <span class="keywordtype">bool</span> * <span class="keyword">const</span> preds,
<a name="l00277"></a>00277       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00278"></a>00278       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00279"></a>00279       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00280"></a>00280       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome) = 0;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfusion__t.html#cdf80727ed478611329437f387895bc4">update</a>(
<a name="l00283"></a>00283       <span class="keyword">class</span> <a class="code" href="classfusion__sc__t.html">fusion_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00284"></a>00284       <span class="keyword">const</span> <span class="keywordtype">bool</span> * <span class="keyword">const</span> preds,
<a name="l00285"></a>00285       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00286"></a>00286       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00287"></a>00287       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00288"></a>00288       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome,
<a name="l00289"></a>00289       <span class="keyword">const</span> <span class="keywordtype">bool</span> our_pred);
<a name="l00290"></a>00290 
<a name="l00291"></a>00291   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfusion__t.html#dc1a1da27e0dff07da77684e8c5a1fb8">spec_update</a>(
<a name="l00292"></a>00292       <span class="keyword">class</span> <a class="code" href="classfusion__sc__t.html">fusion_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00293"></a>00293       <span class="keyword">const</span> <span class="keywordtype">bool</span> * <span class="keyword">const</span> preds,
<a name="l00294"></a>00294       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00295"></a>00295       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00296"></a>00296       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00297"></a>00297       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome,
<a name="l00298"></a>00298       <span class="keyword">const</span> <span class="keywordtype">bool</span> our_pred);
<a name="l00299"></a>00299 
<a name="l00300"></a>00300   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfusion__t.html#fa7bc7d99f4556983efd089a60664cee">recover</a>(
<a name="l00301"></a>00301       <span class="keyword">class</span> <a class="code" href="classfusion__sc__t.html">fusion_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00302"></a>00302       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome);
<a name="l00303"></a>00303 
<a name="l00304"></a>00304   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfusion__t.html#3eb17c25f002d13bf06b4235a6215a7a">flush</a>(<span class="keyword">class</span> <a class="code" href="classfusion__sc__t.html">fusion_sc_t</a> * <span class="keyword">const</span> scvp);
<a name="l00305"></a>00305 
<a name="l00306"></a>00306   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfusion__t.html#45c940f6458a028bd8a86684e5edce4a">reg_stats</a>(
<a name="l00307"></a>00307       <span class="keyword">struct</span> <a class="code" href="structstat__sdb__t.html">stat_sdb_t</a> * <span class="keyword">const</span> sdb,
<a name="l00308"></a>00308       <span class="keyword">struct</span> <a class="code" href="classcore__t.html">core_t</a> * <span class="keyword">const</span> core);
<a name="l00309"></a>00309 
<a name="l00310"></a>00310   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfusion__t.html#4165e6ee084855edb02c6ec02110c614">reset_stats</a>(<span class="keywordtype">void</span>);
<a name="l00311"></a>00311 
<a name="l00312"></a>00312   <span class="keyword">virtual</span> <span class="keyword">class </span><a class="code" href="classfusion__sc__t.html">fusion_sc_t</a> * <a class="code" href="classfusion__t.html#5d98c1e50bf6003e7d73d5a9fd603736">get_cache</a>(<span class="keywordtype">void</span>);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfusion__t.html#cd9d90c41c0eceaf5fdbc4aaac9f1edf">ret_cache</a>(<span class="keyword">class</span> <a class="code" href="classfusion__sc__t.html">fusion_sc_t</a> * <span class="keyword">const</span> scvp);
<a name="l00315"></a>00315 };
<a name="l00316"></a>00316 
<a name="l00317"></a><a class="code" href="classBTB__sc__t.html">00317</a> <span class="keyword">class </span><a class="code" href="classBTB__sc__t.html">BTB_sc_t</a>:<span class="keyword">public</span> <a class="code" href="classbpred__sc__t.html">bpred_sc_t</a>
<a name="l00318"></a>00318 {
<a name="l00319"></a>00319 };
<a name="l00320"></a>00320 <span class="comment">/* general target address predictor */</span>
<a name="l00321"></a><a class="code" href="classBTB__t.html">00321</a> <span class="keyword">class </span><a class="code" href="classBTB__t.html">BTB_t</a>
<a name="l00322"></a>00322 {
<a name="l00323"></a><a class="code" href="classBTB__t.html#44319d3cf67079457eb46e2c6fcfeb49">00323</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classbpred__t.html">bpred_t</a>;
<a name="l00324"></a>00324 
<a name="l00325"></a>00325   <span class="keyword">protected</span>:
<a name="l00326"></a><a class="code" href="classBTB__t.html#272d5f2c0460c8b8431109ee69c7f187">00326</a>   <span class="keywordtype">char</span> * <a class="code" href="classBTB__t.html#272d5f2c0460c8b8431109ee69c7f187">name</a>;
<a name="l00327"></a><a class="code" href="classBTB__t.html#e991fcedc1dbf7ebaa71aedc085c144f">00327</a>   <span class="keywordtype">char</span> * <a class="code" href="classBTB__t.html#e991fcedc1dbf7ebaa71aedc085c144f">type</a>;
<a name="l00328"></a><a class="code" href="classBTB__t.html#2782a3d27579b0248402ce00e7919c19">00328</a>   <span class="keywordtype">int</span> <a class="code" href="classBTB__t.html#2782a3d27579b0248402ce00e7919c19">bits</a>;
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="classBTB__t.html#58cb344c2870517900223cd1d1f59a20">00330</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classBTB__t.html#58cb344c2870517900223cd1d1f59a20">num_hits</a>;
<a name="l00331"></a><a class="code" href="classBTB__t.html#9d2b4c038ab6a3ada925695d2a20067c">00331</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classBTB__t.html#9d2b4c038ab6a3ada925695d2a20067c">lookups</a>;
<a name="l00332"></a><a class="code" href="classBTB__t.html#8faf4c07e18f7b0a848c36516b1b1d51">00332</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classBTB__t.html#8faf4c07e18f7b0a848c36516b1b1d51">updates</a>;
<a name="l00333"></a><a class="code" href="classBTB__t.html#c17c0bf4e6618c7124dc99eb0b9875cb">00333</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classBTB__t.html#c17c0bf4e6618c7124dc99eb0b9875cb">spec_updates</a>;
<a name="l00334"></a><a class="code" href="classBTB__t.html#07a06f83ab8c0c494415ec99795d761c">00334</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classBTB__t.html#07a06f83ab8c0c494415ec99795d761c">num_nt</a>;
<a name="l00335"></a><a class="code" href="classBTB__t.html#f1ccd796d1cd8fcb8f33abeefd47cb4b">00335</a>   <span class="keywordtype">bool</span> <a class="code" href="classBTB__t.html#f1ccd796d1cd8fcb8f33abeefd47cb4b">frozen</a>;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337   <span class="keywordtype">void</span> <a class="code" href="classBTB__t.html#ac35b3c68a69d553e5394423591cf936">init</a>(<span class="keywordtype">void</span>);
<a name="l00338"></a>00338 
<a name="l00339"></a>00339   <span class="keyword">public</span>:
<a name="l00340"></a>00340 
<a name="l00341"></a>00341            <a class="code" href="classBTB__t.html#906ebf9a82a43e4d10d869c66b397138">BTB_t</a>();
<a name="l00342"></a>00342   <span class="keyword">virtual</span> <a class="code" href="classBTB__t.html#9a858280291c82c076333b3318ac4b0b">~BTB_t</a>();
<a name="l00343"></a>00343 
<a name="l00344"></a>00344   <span class="keyword">virtual</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="classBTB__t.html#1bf028f9f8cf5dd78a0590ebcef73b80">lookup</a>(
<a name="l00345"></a>00345       <span class="keyword">class</span> <a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00346"></a>00346       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00347"></a>00347       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00348"></a>00348       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00349"></a>00349       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome,
<a name="l00350"></a>00350       <span class="keyword">const</span> <span class="keywordtype">bool</span> our_pred) = 0;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classBTB__t.html#2e44e8499c9d2926bf958c40b1dc0b4c">update</a>(
<a name="l00353"></a>00353       <span class="keyword">class</span> <a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00354"></a>00354       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00355"></a>00355       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00356"></a>00356       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00357"></a>00357       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> our_target,
<a name="l00358"></a>00358       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome,
<a name="l00359"></a>00359       <span class="keyword">const</span> <span class="keywordtype">bool</span> our_pred) = 0;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classBTB__t.html#2ab69add8d43f5292d48653701050a71">spec_update</a>(
<a name="l00362"></a>00362       <span class="keyword">class</span> <a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00363"></a>00363       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00364"></a>00364       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00365"></a>00365       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC,
<a name="l00366"></a>00366       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> our_target,
<a name="l00367"></a>00367       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome,
<a name="l00368"></a>00368       <span class="keyword">const</span> <span class="keywordtype">bool</span> our_pred);
<a name="l00369"></a>00369 
<a name="l00370"></a>00370   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classBTB__t.html#120f5d41cf791935150de6ec051ea560">recover</a>(
<a name="l00371"></a>00371       <span class="keyword">class</span> <a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <span class="keyword">const</span> scvp,
<a name="l00372"></a>00372       <span class="keyword">const</span> <span class="keywordtype">bool</span> outcome);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classBTB__t.html#4790cf808e2f4c99a92c32ed649bbc38">flush</a>(<span class="keyword">class</span> <a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <span class="keyword">const</span> scvp);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classBTB__t.html#6987bbb8bee1289335a9ec57bd1226e5">reg_stats</a>(
<a name="l00377"></a>00377       <span class="keyword">struct</span> <a class="code" href="structstat__sdb__t.html">stat_sdb_t</a> * <span class="keyword">const</span> sdb,
<a name="l00378"></a>00378       <span class="keyword">struct</span> <a class="code" href="classcore__t.html">core_t</a> * <span class="keyword">const</span> core);
<a name="l00379"></a>00379 
<a name="l00380"></a>00380   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classBTB__t.html#daa5ae0e0ee266058334c4c39ffb8bc7">reset_stats</a>();
<a name="l00381"></a>00381 
<a name="l00382"></a>00382   <span class="keyword">virtual</span> <span class="keyword">class </span><a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <a class="code" href="classBTB__t.html#32e582b73ba10d49a70208b29c823af4">get_cache</a>(<span class="keywordtype">void</span>);
<a name="l00383"></a>00383 
<a name="l00384"></a>00384   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classBTB__t.html#f22788bee3f764daa978989198adb927">ret_cache</a>(<span class="keyword">class</span> <a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <span class="keyword">const</span> scvp);
<a name="l00385"></a>00385 };
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 <span class="comment">/* subroutine return address predictor */</span>
<a name="l00388"></a><a class="code" href="classRAS__chkpt__t.html">00388</a> <span class="keyword">class </span><a class="code" href="classRAS__chkpt__t.html">RAS_chkpt_t</a>
<a name="l00389"></a>00389 {
<a name="l00390"></a>00390   <span class="keyword">public</span>:
<a name="l00391"></a>00391 };
<a name="l00392"></a>00392 
<a name="l00393"></a><a class="code" href="classRAS__t.html">00393</a> <span class="keyword">class </span><a class="code" href="classRAS__t.html">RAS_t</a>
<a name="l00394"></a>00394 {
<a name="l00395"></a><a class="code" href="classRAS__t.html#44319d3cf67079457eb46e2c6fcfeb49">00395</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classbpred__t.html">bpred_t</a>;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <span class="keyword">protected</span>:
<a name="l00398"></a><a class="code" href="classRAS__t.html#46f76793b29dbda5e83fb1c703f005ff">00398</a>   <span class="keywordtype">char</span> * <a class="code" href="classRAS__t.html#46f76793b29dbda5e83fb1c703f005ff">name</a>;
<a name="l00399"></a><a class="code" href="classRAS__t.html#7efaa4ffdd024674ee3fc2bc0405eb3b">00399</a>   <span class="keywordtype">char</span> * <a class="code" href="classRAS__t.html#7efaa4ffdd024674ee3fc2bc0405eb3b">type</a>;
<a name="l00400"></a><a class="code" href="classRAS__t.html#a00f75f412eedf4730ed2d922f348b1a">00400</a>   <span class="keywordtype">int</span> <a class="code" href="classRAS__t.html#a00f75f412eedf4730ed2d922f348b1a">bits</a>;
<a name="l00401"></a>00401 
<a name="l00402"></a><a class="code" href="classRAS__t.html#a7ec70afff01a487015d09903af6ec02">00402</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classRAS__t.html#a7ec70afff01a487015d09903af6ec02">num_hits</a>;
<a name="l00403"></a><a class="code" href="classRAS__t.html#592316929c75f97e653429b2531d6207">00403</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classRAS__t.html#592316929c75f97e653429b2531d6207">num_pushes</a>;
<a name="l00404"></a><a class="code" href="classRAS__t.html#1b52281a4eaca759fd29375105add8b1">00404</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classRAS__t.html#1b52281a4eaca759fd29375105add8b1">num_pops</a>;
<a name="l00405"></a><a class="code" href="classRAS__t.html#b2ca3b15bad8f511893986be6284c17a">00405</a>   <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="classRAS__t.html#b2ca3b15bad8f511893986be6284c17a">num_recovers</a>;
<a name="l00406"></a><a class="code" href="classRAS__t.html#23d8b517275399dd1938f9224352e16b">00406</a>   <span class="keywordtype">bool</span> <a class="code" href="classRAS__t.html#23d8b517275399dd1938f9224352e16b">frozen</a>;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   <span class="keywordtype">void</span> <a class="code" href="classRAS__t.html#8dd96780ed5d3250cae96ff2fe36e059">init</a>(<span class="keywordtype">void</span>);
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   <span class="keyword">public</span>:
<a name="l00411"></a>00411 
<a name="l00412"></a>00412            <a class="code" href="classRAS__t.html#7684b42f305e1236f149a0d2a5eaebea">RAS_t</a>();
<a name="l00413"></a>00413   <span class="keyword">virtual</span> <a class="code" href="classRAS__t.html#3d2e8b0f1768f640d1a8a83b17e05ef0">~RAS_t</a>();
<a name="l00414"></a>00414 
<a name="l00415"></a>00415   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classRAS__t.html#a1df3cc12d4def9b2242a5f52171d8c3">push</a>(
<a name="l00416"></a>00416       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00417"></a>00417       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> fallthruPC,
<a name="l00418"></a>00418       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00419"></a>00419       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421   <span class="keyword">virtual</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="classRAS__t.html#dae128acdfd775738dbe7e72590cff89">pop</a>(
<a name="l00422"></a>00422       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> PC,
<a name="l00423"></a>00423       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> tPC,
<a name="l00424"></a>00424       <span class="keyword">const</span> <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> oPC) = 0;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classRAS__t.html#abae08514fc83550748c20d576670cf7">recover</a>(<span class="keyword">class</span> <a class="code" href="classRAS__chkpt__t.html">RAS_chkpt_t</a> * <span class="keyword">const</span> cpvp); <span class="comment">/* actually perform a recovery */</span>
<a name="l00427"></a>00427 
<a name="l00428"></a>00428   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classRAS__t.html#34fda2c32bc8bc2787c544b00a0984de">recover_state</a>(<span class="keyword">class</span> <a class="code" href="classRAS__chkpt__t.html">RAS_chkpt_t</a> * <span class="keyword">const</span> cpvp);
<a name="l00429"></a>00429 
<a name="l00430"></a>00430   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classRAS__t.html#3f45ebc7d9e077724a823563c72d2fd6">reg_stats</a>(
<a name="l00431"></a>00431       <span class="keyword">struct</span> <a class="code" href="structstat__sdb__t.html">stat_sdb_t</a> * <span class="keyword">const</span> sdb,
<a name="l00432"></a>00432       <span class="keyword">struct</span> <a class="code" href="classcore__t.html">core_t</a> * <span class="keyword">const</span> core);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classRAS__t.html#e24714df216c2694c75ef8d7f872ed35">reset_stats</a>();
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="keyword">virtual</span> <span class="keyword">class </span><a class="code" href="classRAS__chkpt__t.html">RAS_chkpt_t</a> * <a class="code" href="classRAS__t.html#59bd61821697c014ac040ded2153cfcd">get_state</a>(<span class="keywordtype">void</span>);
<a name="l00437"></a>00437 
<a name="l00438"></a>00438   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classRAS__t.html#e76acc444f340ba7c5170992c5e3ec3c">ret_state</a>(<span class="keyword">class</span> <a class="code" href="classRAS__chkpt__t.html">RAS_chkpt_t</a> * <span class="keyword">const</span> cpvp);
<a name="l00439"></a>00439 };
<a name="l00440"></a>00440 
<a name="l00441"></a>00441 <span class="comment">/* This is analogous to the various update_ptr's in the original</span>
<a name="l00442"></a>00442 <span class="comment">   bpred.[ch].  The type of information that a predictor might</span>
<a name="l00443"></a>00443 <span class="comment">   want to cache away to avoid redundant computations (like</span>
<a name="l00444"></a>00444 <span class="comment">   calculating indices and what not) will vary greatly from one</span>
<a name="l00445"></a>00445 <span class="comment">   predictor to the next, and so we allow each predictor to</span>
<a name="l00446"></a>00446 <span class="comment">   define any kind of state container or cache that they wish</span>
<a name="l00447"></a>00447 <span class="comment">   to.  As part of the standard predictor interface, each predictor</span>
<a name="l00448"></a>00448 <span class="comment">   provides functions for allocating and destroying these</span>
<a name="l00449"></a>00449 <span class="comment">   containers. */</span>
<a name="l00450"></a><a class="code" href="classbpred__state__cache__t.html">00450</a> <span class="keyword">class </span><a class="code" href="classbpred__state__cache__t.html">bpred_state_cache_t</a>
<a name="l00451"></a>00451 {
<a name="l00452"></a><a class="code" href="classbpred__state__cache__t.html#44319d3cf67079457eb46e2c6fcfeb49">00452</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classbpred__t.html">bpred_t</a>;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454   <span class="keyword">protected</span>:
<a name="l00455"></a><a class="code" href="classbpred__state__cache__t.html#dc9e375a218a14bee7c64c069a25fbf0">00455</a>   <span class="keywordtype">bool</span> * <a class="code" href="classbpred__state__cache__t.html#dc9e375a218a14bee7c64c069a25fbf0">preds</a>;               <span class="comment">/* predictions (direction of each component predictor) */</span>
<a name="l00456"></a><a class="code" href="classbpred__state__cache__t.html#b86b749246b95fe7cedf505c4f69f3f8">00456</a>   <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="classbpred__state__cache__t.html#b86b749246b95fe7cedf505c4f69f3f8">our_target</a>;       <span class="comment">/* the predicted target */</span>
<a name="l00457"></a>00457 
<a name="l00458"></a><a class="code" href="classbpred__state__cache__t.html#0caa9290d262b185658b68ff0ad1a859">00458</a>   <span class="keyword">class </span><a class="code" href="classbpred__sc__t.html">bpred_sc_t</a> **<a class="code" href="classbpred__state__cache__t.html#0caa9290d262b185658b68ff0ad1a859">pcache</a>;              <span class="comment">/* br direction predictors' state containers/caches */</span>
<a name="l00459"></a><a class="code" href="classbpred__state__cache__t.html#16db1caa3444899168c8386f6e41a9cd">00459</a>   <span class="keyword">class </span><a class="code" href="classfusion__sc__t.html">fusion_sc_t</a> * <a class="code" href="classbpred__state__cache__t.html#16db1caa3444899168c8386f6e41a9cd">fcache</a>;              <span class="comment">/* fusion/meta-predictor's state cache */</span>
<a name="l00460"></a><a class="code" href="classbpred__state__cache__t.html#18fc0f9e45a4925cfa20a32580a0acf0">00460</a>   <span class="keyword">class </span><a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <a class="code" href="classbpred__state__cache__t.html#18fc0f9e45a4925cfa20a32580a0acf0">dirjmp</a>;              <span class="comment">/* direct br/jmp target predictor's state cache */</span>
<a name="l00461"></a><a class="code" href="classbpred__state__cache__t.html#b8fd131a650115451a1c8e5cbf77614b">00461</a>   <span class="keyword">class </span><a class="code" href="classBTB__sc__t.html">BTB_sc_t</a> * <a class="code" href="classbpred__state__cache__t.html#b8fd131a650115451a1c8e5cbf77614b">indirjmp</a>;            <span class="comment">/* indirect br/jmp target predictor's state cache */</span>
<a name="l00462"></a><a class="code" href="classbpred__state__cache__t.html#2b62c64b1cd517768e59f9f17face06c">00462</a>   <span class="keyword">class </span><a class="code" href="classRAS__chkpt__t.html">RAS_chkpt_t</a> * <a class="code" href="classbpred__state__cache__t.html#2b62c64b1cd517768e59f9f17face06c">ras_checkpoint</a>;   <span class="comment">/* RAS recovery information */</span>
<a name="l00463"></a>00463 
<a name="l00464"></a>00464   <span class="keyword">public</span>:
<a name="l00465"></a><a class="code" href="classbpred__state__cache__t.html#6ae3589b3c282461078dc80d4f9935db">00465</a>   <span class="keywordtype">bool</span>   <a class="code" href="classbpred__state__cache__t.html#6ae3589b3c282461078dc80d4f9935db">our_pred</a>;            <span class="comment">/* the direction prediction */</span>
<a name="l00466"></a>00466 
<a name="l00467"></a><a class="code" href="classbpred__state__cache__t.html#52dc7d033f4f1c95aa44029fc9d40629">00467</a>   <a class="code" href="classbpred__state__cache__t.html#52dc7d033f4f1c95aa44029fc9d40629">bpred_state_cache_t</a>(<span class="keywordtype">void</span>): <a class="code" href="classbpred__state__cache__t.html#dc9e375a218a14bee7c64c069a25fbf0">preds</a>(NULL), <a class="code" href="classbpred__state__cache__t.html#b86b749246b95fe7cedf505c4f69f3f8">our_target</a>(0), <a class="code" href="classbpred__state__cache__t.html#0caa9290d262b185658b68ff0ad1a859">pcache</a>(NULL), <a class="code" href="classbpred__state__cache__t.html#16db1caa3444899168c8386f6e41a9cd">fcache</a>(NULL), <a class="code" href="classbpred__state__cache__t.html#18fc0f9e45a4925cfa20a32580a0acf0">dirjmp</a>(NULL), <a class="code" href="classbpred__state__cache__t.html#b8fd131a650115451a1c8e5cbf77614b">indirjmp</a>(NULL),
<a name="l00468"></a>00468                              <a class="code" href="classbpred__state__cache__t.html#2b62c64b1cd517768e59f9f17face06c">ras_checkpoint</a>(NULL), <a class="code" href="classbpred__state__cache__t.html#6ae3589b3c282461078dc80d4f9935db">our_pred</a>(false) {};
<a name="l00469"></a>00469 };
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="comment">/*----------------------------------------------------------*/</span>
<a name="l00472"></a>00472 <span class="comment">/* saturating two bit counter implemented with no branching */</span>
<a name="l00473"></a>00473 <span class="comment">/*----------------------------------------------------------*/</span>
<a name="l00474"></a><a class="code" href="zesto-bpred_8h.html#bda9e00a2a6157fdad8ec356e7ba4820">00474</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="zesto-bpred_8h.html#bda9e00a2a6157fdad8ec356e7ba4820">my2bc_t</a>;
<a name="l00475"></a>00475 
<a name="l00476"></a><a class="code" href="zesto-bpred_8h.html#b0d3c7f383a6a35b0feb0b7b9bb8faa2">00476</a> <span class="preprocessor">#define _2BC_TABLE 0xD4E8</span>
<a name="l00477"></a><a class="code" href="zesto-bpred_8h.html#d575efe27a358d2ed96a8611608a4ba6">00477</a> <span class="preprocessor"></span><span class="preprocessor">#define MY2BC_DIR_MASK 0x01</span>
<a name="l00478"></a><a class="code" href="zesto-bpred_8h.html#fdf1125d6be60c842b7f273a15fa6903">00478</a> <span class="preprocessor"></span><span class="preprocessor">#define MY2BC_HYST_MASK 0x02</span>
<a name="l00479"></a><a class="code" href="zesto-bpred_8h.html#0ecda0251f34a526b1e45daf27c4d0d9">00479</a> <span class="preprocessor"></span><span class="preprocessor">#define MY2BC_DIR(ctr) ((ctr)&amp;MY2BC_DIR_MASK)</span>
<a name="l00480"></a><a class="code" href="zesto-bpred_8h.html#c9c1aec004b8cbb04c9482ccb038cd0d">00480</a> <span class="preprocessor"></span><span class="preprocessor">#define MY2BC_HYST(ctr) ((ctr)&amp;MY2BC_HYST_MASK)</span>
<a name="l00481"></a>00481 <span class="preprocessor"></span>
<a name="l00482"></a><a class="code" href="zesto-bpred_8h.html#0282d44b09c8be75d9ab177af9ebb2fe">00482</a> <span class="preprocessor">#define MY2BC_UPDATE(ctr,dir) (ctr)=(_2BC_TABLE&gt;&gt;(((ctr&lt;&lt;1)+(dir))&lt;&lt;1))&amp;3</span>
<a name="l00483"></a>00483 <span class="preprocessor"></span><span class="comment">/* _2BC_table is a bit packed version of the state transition table</span>
<a name="l00484"></a>00484 <span class="comment">   for the 2bC:</span>
<a name="l00485"></a>00485 <span class="comment"></span>
<a name="l00486"></a>00486 <span class="comment">   The bits are switched in their places (i.e. bit 0 = direction bit</span>
<a name="l00487"></a>00487 <span class="comment">   and bit 1 = confidence/hysteresis bit).  This allows the extraction</span>
<a name="l00488"></a>00488 <span class="comment">   of the direction bit with a simple AND instead of a SHIFT+AND.</span>
<a name="l00489"></a>00489 <span class="comment"></span>
<a name="l00490"></a>00490 <span class="comment">   prev</span>
<a name="l00491"></a>00491 <span class="comment">   2bC</span>
<a name="l00492"></a>00492 <span class="comment">   LD  inc  dec</span>
<a name="l00493"></a>00493 <span class="comment">      +--------</span>
<a name="l00494"></a>00494 <span class="comment">   00 | 10   00  (8)</span>
<a name="l00495"></a>00495 <span class="comment">   01 | 11   10  (E)</span>
<a name="l00496"></a>00496 <span class="comment">   10 | 01   00  (4)</span>
<a name="l00497"></a>00497 <span class="comment">   11 | 11   01  (D)</span>
<a name="l00498"></a>00498 <span class="comment"></span>
<a name="l00499"></a>00499 <span class="comment">   (LD: 'L'east Signif. Bit of 2bc,</span>
<a name="l00500"></a>00500 <span class="comment">   'D'irection Bit)</span>
<a name="l00501"></a>00501 <span class="comment"></span>
<a name="l00502"></a>00502 <span class="comment">   The previous counter value and the branch outcome direction are</span>
<a name="l00503"></a>00503 <span class="comment">   used to shift the packed table by the proper amount, and then the</span>
<a name="l00504"></a>00504 <span class="comment">   two bits are masked out.</span>
<a name="l00505"></a>00505 <span class="comment"></span>
<a name="l00506"></a>00506 <span class="comment"> */</span>
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 <span class="comment">/* similar to MY2BC_UPDATE, but these macros inc/dec (saturating) if</span>
<a name="l00509"></a>00509 <span class="comment">   the predicate p is true.</span>
<a name="l00510"></a>00510 <span class="comment"></span>
<a name="l00511"></a>00511 <span class="comment">      (COND_INC)          (COND_DEC)</span>
<a name="l00512"></a>00512 <span class="comment">   LD   p=1 p=0        LD   p=1 p=0</span>
<a name="l00513"></a>00513 <span class="comment">      +--------           +--------</span>
<a name="l00514"></a>00514 <span class="comment">   00 | 10  00  (8)    00 | 00  00  (0)</span>
<a name="l00515"></a>00515 <span class="comment">   01 | 11  01  (D)    01 | 10  01  (9)</span>
<a name="l00516"></a>00516 <span class="comment">   10 | 01  10  (6)    10 | 00  10  (2)</span>
<a name="l00517"></a>00517 <span class="comment">   11 | 11  11  (F)    11 | 01  11  (7)</span>
<a name="l00518"></a>00518 <span class="comment"> */</span>
<a name="l00519"></a><a class="code" href="zesto-bpred_8h.html#19d6e1d2a8ba2f79e7568a8c6dfbdbab">00519</a> <span class="preprocessor">#define _2BC_CINC_TABLE 0xF6D8</span>
<a name="l00520"></a><a class="code" href="zesto-bpred_8h.html#d10fcd3b2e4614678abfd91a68707c45">00520</a> <span class="preprocessor"></span><span class="preprocessor">#define _2BC_CDEC_TABLE 0x7290</span>
<a name="l00521"></a>00521 <span class="preprocessor"></span>
<a name="l00522"></a><a class="code" href="zesto-bpred_8h.html#dc5a79b5bebc786c728da4737d2ac6ff">00522</a> <span class="preprocessor">#define MY2BC_COND_INC(ctr,p) (ctr)=(_2BC_CINC_TABLE&gt;&gt;(((ctr&lt;&lt;1)+(p))&lt;&lt;1))&amp;3</span>
<a name="l00523"></a><a class="code" href="zesto-bpred_8h.html#861d9cdb4f798747ffb4b10321f430d3">00523</a> <span class="preprocessor"></span><span class="preprocessor">#define MY2BC_COND_DEC(ctr,p) (ctr)=(_2BC_CDEC_TABLE&gt;&gt;(((ctr&lt;&lt;1)+(p))&lt;&lt;1))&amp;3</span>
<a name="l00524"></a>00524 <span class="preprocessor"></span>
<a name="l00525"></a><a class="code" href="zesto-bpred_8h.html#391b33a37cdf2ef70dbe9d7e18755b71">00525</a> <span class="preprocessor">#define MY2BC_STRONG_TAKEN (3)</span>
<a name="l00526"></a><a class="code" href="zesto-bpred_8h.html#a3944e6a0db9efce75495ea792264ee0">00526</a> <span class="preprocessor"></span><span class="preprocessor">#define MY2BC_WEAKLY_TAKEN (1)</span>
<a name="l00527"></a><a class="code" href="zesto-bpred_8h.html#b9b4f68a03c03f93301c736ec88227be">00527</a> <span class="preprocessor"></span><span class="preprocessor">#define MY2BC_WEAKLY_NT (2)</span>
<a name="l00528"></a><a class="code" href="zesto-bpred_8h.html#5c85ac4938b8aaad4098261c61881d62">00528</a> <span class="preprocessor"></span><span class="preprocessor">#define MY2BC_STRONG_NT (0)</span>
<a name="l00529"></a>00529 <span class="preprocessor"></span>
<a name="l00530"></a>00530 
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 <span class="preprocessor">#endif </span><span class="comment">/* ZESTO_BPRED_INCLUDED */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 23 00:20:57 2010 for IRIS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
