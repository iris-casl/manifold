<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>IRIS: commit-DPM.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_014faa727c0b2aaba2cbdd8f326de4f6.html">source</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_4516642e80adc9bf50ea604a2fbf2492.html">zesto</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e9462c8a8fa0956c3f003f6393e2a80d.html">ZPIPE-commit</a>
  </div>
</div>
<div class="contents">
<h1>commit-DPM.cpp</h1><a href="commit-DPM_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* commit-DPM.cpp - Detailed Pipeline Model */</span>
<a name="l00002"></a>00002 <span class="comment">/*</span>
<a name="l00003"></a>00003 <span class="comment"> * __COPYRIGHT__ GT</span>
<a name="l00004"></a>00004 <span class="comment"> */</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#ifdef ZESTO_PARSE_ARGS</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(!strcasecmp(commit_opt_string,<span class="stringliteral">"DPM"</span>))
<a name="l00008"></a>00008     <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classcore__commit__DPM__t.html">core_commit_DPM_t</a>(core);
<a name="l00009"></a>00009 <span class="preprocessor">#else</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a><a class="code" href="classcore__commit__DPM__t.html">00011</a> <span class="keyword">class </span><a class="code" href="classcore__commit__DPM__t.html">core_commit_DPM_t</a>:<span class="keyword">public</span> <a class="code" href="classcore__commit__t.html">core_commit_t</a>
<a name="l00012"></a>00012 {
<a name="l00013"></a><a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7a9ca1359e0e2c3557c8c9ac77439a9c2">00013</a>   <span class="keyword">enum</span> <a class="code" href="classcore__commit__t.html#cf283124880a10ce01e0fb68f2aa69ce">commit_stall_t</a> {<a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7a9ca1359e0e2c3557c8c9ac77439a9c2">CSTALL_NONE</a>,      <span class="comment">/* no stall */</span>
<a name="l00014"></a><a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb729cde678fb551ee86b8a506daa600cbb">00014</a>                        <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb729cde678fb551ee86b8a506daa600cbb">CSTALL_NOT_READY</a>, <span class="comment">/* oldest inst not done (no uops finished) */</span>
<a name="l00015"></a><a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7b33cb6d430a0f2a4841d42ba1fdcbc42">00015</a>                        <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7b33cb6d430a0f2a4841d42ba1fdcbc42">CSTALL_PARTIAL</a>,   <span class="comment">/* oldest inst not done (but some uops finished) */</span>
<a name="l00016"></a><a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb72432ee6a04f56d4f6288569a152deb63">00016</a>                        <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb72432ee6a04f56d4f6288569a152deb63">CSTALL_EMPTY</a>,     <span class="comment">/* ROB is empty, nothing to commit */</span>
<a name="l00017"></a><a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7a7048d33b9b811882574ca343c75ed23">00017</a>                        <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7a7048d33b9b811882574ca343c75ed23">CSTALL_JECLEAR_INFLIGHT</a>, <span class="comment">/* Mop is done, but its jeclear hasn't been handled yet */</span>
<a name="l00018"></a><a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb758fe5cdefc2980e6e0881c54736130dd">00018</a>                        <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb758fe5cdefc2980e6e0881c54736130dd">CSTALL_MAX_BRANCHES</a>, <span class="comment">/* exceeded maximum number of branches committed per cycle */</span>
<a name="l00019"></a><a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb75e89ab30f628ead28a1eeb733ffe0cd1">00019</a>                        <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb75e89ab30f628ead28a1eeb733ffe0cd1">CSTALL_num</a>
<a name="l00020"></a>00020                      };
<a name="l00021"></a>00021 
<a name="l00022"></a>00022   <span class="keyword">public</span>:
<a name="l00023"></a>00023 
<a name="l00024"></a>00024   <a class="code" href="classcore__commit__DPM__t.html#0917603da00e97ab8572aac3671ee675">core_commit_DPM_t</a>(<span class="keyword">struct</span> <a class="code" href="classcore__t.html">core_t</a> * <span class="keyword">const</span> <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>);
<a name="l00025"></a>00025   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#c0dabf4754fda813064a450ee55584c5">reg_stats</a>(<span class="keyword">struct</span> <a class="code" href="structstat__sdb__t.html">stat_sdb_t</a> * <span class="keyword">const</span> sdb);
<a name="l00026"></a>00026   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#14bc2b8a134d2a8fd46e598149e08f46">update_occupancy</a>(<span class="keywordtype">void</span>);
<a name="l00027"></a>00027 
<a name="l00028"></a>00028   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#b3b35af5a3e6aa82d61761a07da5642a">step</a>(<span class="keywordtype">void</span>);
<a name="l00029"></a>00029   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#b0ca7c01d6c22c55f529bd9cec7a809b">recover</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structMop__t.html">Mop_t</a> * <span class="keyword">const</span> Mop);
<a name="l00030"></a>00030   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#b0ca7c01d6c22c55f529bd9cec7a809b">recover</a>(<span class="keywordtype">void</span>);
<a name="l00031"></a>00031 
<a name="l00032"></a>00032   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classcore__commit__DPM__t.html#eba764df3f73e22de74685b52976bd14">ROB_available</a>(<span class="keywordtype">void</span>);
<a name="l00033"></a>00033   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classcore__commit__DPM__t.html#42a6e65fd798bfb75b5a036efd9e4ae1">ROB_empty</a>(<span class="keywordtype">void</span>);
<a name="l00034"></a>00034   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#0bce05d30731b67e31f691bf95f87851">ROB_insert</a>(<span class="keyword">struct</span> <a class="code" href="structuop__t.html">uop_t</a> * <span class="keyword">const</span> uop);
<a name="l00035"></a>00035   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#a8e1a57946e18f029d405718664a4b54">ROB_fuse_insert</a>(<span class="keyword">struct</span> <a class="code" href="structuop__t.html">uop_t</a> * <span class="keyword">const</span> uop);
<a name="l00036"></a>00036 
<a name="l00037"></a>00037   <span class="keyword">protected</span>:
<a name="l00038"></a>00038 
<a name="l00039"></a><a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">00039</a>   <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> ** <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>;
<a name="l00040"></a><a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">00040</a>   <span class="keywordtype">int</span> <a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a>;
<a name="l00041"></a><a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">00041</a>   <span class="keywordtype">int</span> <a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a>;
<a name="l00042"></a><a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">00042</a>   <span class="keywordtype">int</span> <a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a>;
<a name="l00043"></a><a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">00043</a>   <span class="keywordtype">int</span> <a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a>;
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="classcore__commit__DPM__t.html#43a64e6d323f15ad135b52bc55313dbd">00045</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classcore__commit__DPM__t.html#43a64e6d323f15ad135b52bc55313dbd">commit_stall_str</a>[<a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb75e89ab30f628ead28a1eeb733ffe0cd1">CSTALL_num</a>];
<a name="l00046"></a>00046 
<a name="l00047"></a>00047   <span class="comment">/* additional temps to track timing of REP insts */</span>
<a name="l00048"></a><a class="code" href="classcore__commit__DPM__t.html#072fde6e7911be1d94a2e5ef7ad1220e">00048</a>   <a class="code" href="host_8h.html#72c250924ea62bad7fee5d58765cdc86">tick_t</a> <a class="code" href="classcore__commit__DPM__t.html#072fde6e7911be1d94a2e5ef7ad1220e">when_rep_fetch_started</a>;
<a name="l00049"></a><a class="code" href="classcore__commit__DPM__t.html#01091807e59a8234ae1e226f6c84b84c">00049</a>   <a class="code" href="host_8h.html#72c250924ea62bad7fee5d58765cdc86">tick_t</a> <a class="code" href="classcore__commit__DPM__t.html#01091807e59a8234ae1e226f6c84b84c">when_rep_fetched</a>;
<a name="l00050"></a><a class="code" href="classcore__commit__DPM__t.html#010d8926bef914213586b5f07e01fa57">00050</a>   <a class="code" href="host_8h.html#72c250924ea62bad7fee5d58765cdc86">tick_t</a> <a class="code" href="classcore__commit__DPM__t.html#010d8926bef914213586b5f07e01fa57">when_rep_decode_started</a>;
<a name="l00051"></a><a class="code" href="classcore__commit__DPM__t.html#41fa0a9ac8cb5a538d42c9a48fc1b4b2">00051</a>   <a class="code" href="host_8h.html#72c250924ea62bad7fee5d58765cdc86">tick_t</a> <a class="code" href="classcore__commit__DPM__t.html#41fa0a9ac8cb5a538d42c9a48fc1b4b2">when_rep_commit_started</a>;
<a name="l00052"></a>00052 };
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="comment">/* number of buckets in uop-flow-length histogram */</span>
<a name="l00055"></a><a class="code" href="commit-DPM_8cpp.html#7e301e88bf620815320ee07e9bda6e62">00055</a> <span class="preprocessor">#define FLOW_HISTO_SIZE 9</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span>
<a name="l00057"></a>00057 <span class="comment">/* VARIABLES/TYPES */</span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classcore__commit__DPM__t.html#43a64e6d323f15ad135b52bc55313dbd">core_commit_DPM_t::commit_stall_str</a>[CSTALL_num] = {
<a name="l00060"></a>00060   <span class="stringliteral">"no stall                   "</span>,
<a name="l00061"></a>00061   <span class="stringliteral">"oldest inst not done       "</span>,
<a name="l00062"></a>00062   <span class="stringliteral">"oldest inst partially done "</span>,
<a name="l00063"></a>00063   <span class="stringliteral">"ROB is empty               "</span>,
<a name="l00064"></a>00064   <span class="stringliteral">"Mop done, jeclear in flight"</span>,
<a name="l00065"></a>00065   <span class="stringliteral">"branch commit limit        "</span>
<a name="l00066"></a>00066 };
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="comment">/*******************/</span>
<a name="l00069"></a>00069 <span class="comment">/* SETUP FUNCTIONS */</span>
<a name="l00070"></a>00070 <span class="comment">/*******************/</span>
<a name="l00071"></a>00071 
<a name="l00072"></a><a class="code" href="classcore__commit__DPM__t.html#0917603da00e97ab8572aac3671ee675">00072</a> <a class="code" href="classcore__commit__DPM__t.html#0917603da00e97ab8572aac3671ee675">core_commit_DPM_t::core_commit_DPM_t</a>(<span class="keyword">struct</span> <a class="code" href="classcore__t.html">core_t</a> * <span class="keyword">const</span> arg_core):
<a name="l00073"></a>00073   ROB_head(0), ROB_tail(0), ROB_num(0), ROB_eff_num(0),
<a name="l00074"></a>00074   when_rep_fetch_started(0), when_rep_fetched(0),
<a name="l00075"></a>00075   when_rep_decode_started(0), when_rep_commit_started(0)
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077   <span class="keyword">struct </span><a class="code" href="structcore__knobs__t.html">core_knobs_t</a> * <a class="code" href="sim-zesto_8cpp.html#89a180011adecec49b08c8ef843388fa">knobs</a> = arg_core-&gt;<a class="code" href="classcore__t.html#a397a3f36f045e3c2a19dafc16dab1c1">knobs</a>;
<a name="l00078"></a>00078   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a> = arg_core;
<a name="l00079"></a>00079   <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a> = (<span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a>**) calloc(knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>,<span class="keyword">sizeof</span>(*<a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>));
<a name="l00080"></a>00080   <span class="keywordflow">if</span>(!<a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>)
<a name="l00081"></a>00081     <a class="code" href="misc_8h.html#677da14e8c4326bde43622f233f1ead3">fatal</a>(<span class="stringliteral">"couldn't calloc ROB"</span>);
<a name="l00082"></a>00082 }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="keywordtype">void</span>
<a name="l00085"></a><a class="code" href="classcore__commit__DPM__t.html#c0dabf4754fda813064a450ee55584c5">00085</a> <a class="code" href="classcore__commit__DPM__t.html#c0dabf4754fda813064a450ee55584c5">core_commit_DPM_t::reg_stats</a>(<span class="keyword">struct</span> <a class="code" href="structstat__sdb__t.html">stat_sdb_t</a> * <span class="keyword">const</span> sdb)
<a name="l00086"></a>00086 {
<a name="l00087"></a>00087   <span class="keywordtype">char</span> buf[1024];
<a name="l00088"></a>00088   <span class="keywordtype">char</span> buf2[1024];
<a name="l00089"></a>00089   <span class="keyword">struct </span><a class="code" href="structthread__t.html">thread_t</a> * arch = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <a class="code" href="zesto_2stats_8h.html#ed9b9c4535e4fc2e59a090d6e8157d4f">stat_reg_note</a>(sdb,<span class="stringliteral">"\n#### COMMIT STATS ####"</span>);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   sprintf(buf,<span class="stringliteral">"c%d.commit_bytes"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00094"></a>00094   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of bytes committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#55d2bfdc168268ce43fc373ccd7d3420">commit_bytes</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#55d2bfdc168268ce43fc373ccd7d3420">commit_bytes</a>, NULL);
<a name="l00095"></a>00095   sprintf(buf,<span class="stringliteral">"c%d.commit_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00096"></a>00096   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of instructions committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#695be096dc6d4c3ef8dadfb9875a3c38">commit_insn</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#695be096dc6d4c3ef8dadfb9875a3c38">commit_insn</a>, NULL);
<a name="l00097"></a>00097   sprintf(buf,<span class="stringliteral">"c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00098"></a>00098   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of uops committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#92a5adf70cb88182f89436f5be116715">commit_uops</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#92a5adf70cb88182f89436f5be116715">commit_uops</a>, NULL);
<a name="l00099"></a>00099   sprintf(buf,<span class="stringliteral">"c%d.commit_eff_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00100"></a>00100   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of effective uops committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b9b59be72d347627a29fff615fee71e6">commit_eff_uops</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b9b59be72d347627a29fff615fee71e6">commit_eff_uops</a>, NULL);
<a name="l00101"></a>00101   sprintf(buf,<span class="stringliteral">"c%d.commit_BPC"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00102"></a>00102   sprintf(buf2,<span class="stringliteral">"c%d.commit_bytes/c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00103"></a>00103   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"BPC (bytes per cycle) at commit"</span>, buf2, NULL);
<a name="l00104"></a>00104   sprintf(buf,<span class="stringliteral">"c%d.commit_IPC"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00105"></a>00105   sprintf(buf2,<span class="stringliteral">"c%d.commit_insn/c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00106"></a>00106   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"IPC at commit"</span>, buf2, NULL);
<a name="l00107"></a>00107   sprintf(buf,<span class="stringliteral">"c%d.commit_uPC"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00108"></a>00108   sprintf(buf2,<span class="stringliteral">"c%d.commit_uops/c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00109"></a>00109   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"uPC at commit"</span>, buf2, NULL);
<a name="l00110"></a>00110   sprintf(buf,<span class="stringliteral">"c%d.commit_euPC"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00111"></a>00111   sprintf(buf2,<span class="stringliteral">"c%d.commit_eff_uops/c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00112"></a>00112   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"effective uPC at commit"</span>, buf2, NULL);
<a name="l00113"></a>00113   sprintf(buf,<span class="stringliteral">"c%d.commit_byte_per_inst"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00114"></a>00114   sprintf(buf2,<span class="stringliteral">"c%d.commit_bytes/c%d.commit_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00115"></a>00115   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average bytes per instruction"</span>, buf2, NULL);
<a name="l00116"></a>00116   sprintf(buf,<span class="stringliteral">"c%d.commit_byte_per_uop"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00117"></a>00117   sprintf(buf2,<span class="stringliteral">"c%d.commit_bytes/c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00118"></a>00118   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average bytes per uop"</span>, buf2, NULL);
<a name="l00119"></a>00119   sprintf(buf,<span class="stringliteral">"c%d.commit_byte_per_eff_uop"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00120"></a>00120   sprintf(buf2,<span class="stringliteral">"c%d.commit_bytes/c%d.commit_eff_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00121"></a>00121   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average bytes per effective uop"</span>, buf2, NULL);
<a name="l00122"></a>00122   sprintf(buf,<span class="stringliteral">"c%d.avg_commit_flowlen"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00123"></a>00123   sprintf(buf2,<span class="stringliteral">"c%d.commit_uops/c%d.commit_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00124"></a>00124   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"uops per instruction at commit"</span>, buf2, NULL);
<a name="l00125"></a>00125   sprintf(buf,<span class="stringliteral">"c%d.avg_commit_eff_flowlen"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00126"></a>00126   sprintf(buf2,<span class="stringliteral">"c%d.commit_eff_uops/c%d.commit_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00127"></a>00127   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"effective uops per instruction at commit"</span>, buf2, NULL);
<a name="l00128"></a>00128   sprintf(buf,<span class="stringliteral">"c%d.commit_fusions"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00129"></a>00129   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of fused uops committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6c057bd1e63107df76c484a31595b75e">commit_fusions</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6c057bd1e63107df76c484a31595b75e">commit_fusions</a>, NULL);
<a name="l00130"></a>00130   sprintf(buf,<span class="stringliteral">"c%d.commit_fusion_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00131"></a>00131   sprintf(buf2,<span class="stringliteral">"(c%d.commit_eff_uops - c%d.commit_uops) + c%d.commit_fusions"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00132"></a>00132   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"fused uops at commit"</span>, buf2, <span class="stringliteral">"%12.0f"</span>);
<a name="l00133"></a>00133   sprintf(buf,<span class="stringliteral">"c%d.commit_frac_fusion_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00134"></a>00134   sprintf(buf2,<span class="stringliteral">"c%d.commit_fusion_uops / c%d.commit_eff_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00135"></a>00135   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"fraction of effective uops fused at commit"</span>, buf2, NULL);
<a name="l00136"></a>00136   sprintf(buf,<span class="stringliteral">"c%d.commit_fusion_compression"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00137"></a>00137   sprintf(buf2,<span class="stringliteral">"(c%d.commit_eff_uops - c%d.commit_uops) / c%d.commit_eff_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00138"></a>00138   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"fraction of effective uops compressed via fusion at commit"</span>, buf2, NULL);
<a name="l00139"></a>00139   sprintf(buf,<span class="stringliteral">"c%d.commit_fusion_expansion"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00140"></a>00140   sprintf(buf2,<span class="stringliteral">"c%d.commit_eff_uops / c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00141"></a>00141   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average number of effective uops per uop (fused or standalone) commit"</span>, buf2, NULL);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143   sprintf(buf,<span class="stringliteral">"c%d.commit_dead_lock_flushes"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00144"></a>00144   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of pipe-flushes due to dead-locked pipeline"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6c0721ecba9c68f18708d4b2fb155285">commit_deadlock_flushes</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6c0721ecba9c68f18708d4b2fb155285">commit_deadlock_flushes</a>, NULL);
<a name="l00145"></a>00145   sprintf(buf,<span class="stringliteral">"c%d.ROB_empty"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00146"></a>00146   sprintf(buf,<span class="stringliteral">"c%d.ROB_occupancy"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00147"></a>00147   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total ROB occupancy"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#899085658ec2043bdc858c5d80c77042">ROB_occupancy</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#899085658ec2043bdc858c5d80c77042">ROB_occupancy</a>, NULL);
<a name="l00148"></a>00148   sprintf(buf,<span class="stringliteral">"c%d.ROB_eff_occupancy"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00149"></a>00149   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total ROB effective_occupancy"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#2bfcce3e6cb1e4fde8078e30842627e8">ROB_eff_occupancy</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#2bfcce3e6cb1e4fde8078e30842627e8">ROB_eff_occupancy</a>, NULL);
<a name="l00150"></a>00150   sprintf(buf,<span class="stringliteral">"c%d.ROB_empty"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00151"></a>00151   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total cycles ROB was empty"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#2eda3dc8169484641c1b9fd2e511e85c">ROB_empty_cycles</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#2eda3dc8169484641c1b9fd2e511e85c">ROB_empty_cycles</a>, NULL);
<a name="l00152"></a>00152   sprintf(buf,<span class="stringliteral">"c%d.ROB_full"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00153"></a>00153   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total cycles ROB was full"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#beff139f1bd9e6510270680bcb52d775">ROB_full_cycles</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#beff139f1bd9e6510270680bcb52d775">ROB_full_cycles</a>, NULL);
<a name="l00154"></a>00154   sprintf(buf,<span class="stringliteral">"c%d.ROB_avg"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00155"></a>00155   sprintf(buf2,<span class="stringliteral">"c%d.ROB_occupancy/c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00156"></a>00156   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average ROB occupancy"</span>, buf2, NULL);
<a name="l00157"></a>00157   sprintf(buf,<span class="stringliteral">"c%d.ROB_eff_avg"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00158"></a>00158   sprintf(buf2,<span class="stringliteral">"c%d.ROB_eff_occupancy/c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00159"></a>00159   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average ROB effective occupancy"</span>, buf2, NULL);
<a name="l00160"></a>00160   sprintf(buf,<span class="stringliteral">"c%d.ROB_frac_empty"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00161"></a>00161   sprintf(buf2,<span class="stringliteral">"c%d.ROB_empty/c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00162"></a>00162   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"fraction of cycles ROB was empty"</span>, buf2, NULL);
<a name="l00163"></a>00163   sprintf(buf,<span class="stringliteral">"c%d.ROB_frac_full"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00164"></a>00164   sprintf(buf2,<span class="stringliteral">"c%d.ROB_full/c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00165"></a>00165   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"fraction of cycles ROB was full"</span>, buf2, NULL);
<a name="l00166"></a>00166   sprintf(buf,<span class="stringliteral">"c%d.DL1_store_split_accesses"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00167"></a>00167   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"number of stores requiring split accesses"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#e3f4766c49b7d48cff4cdcbf0db8f24a">DL1_store_split_accesses</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#e3f4766c49b7d48cff4cdcbf0db8f24a">DL1_store_split_accesses</a>, NULL);
<a name="l00168"></a>00168   sprintf(buf,<span class="stringliteral">"c%d.DL1_store_split_frac"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00169"></a>00169   sprintf(buf2,<span class="stringliteral">"c%d.DL1_store_split_accesses/(c%d.DL1.store_lookups-c%d.DL1_store_split_accesses)"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>); <span class="comment">/* need to subtract since each split access generated two store accesses */</span>
<a name="l00170"></a>00170   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"fraction of stores requiring split accesses"</span>, buf2, NULL);
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   sprintf(buf,<span class="stringliteral">"c%d.commit_stall"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00173"></a>00173   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#9aa1b782d670256448505543248b88dd">commit_stall</a> = <a class="code" href="zesto_2stats_8h.html#b68118a778041ff66b7dec8bf1030ef4">stat_reg_dist</a>(sdb, buf,
<a name="l00174"></a>00174                                            <span class="stringliteral">"breakdown of stalls at commit"</span>,
<a name="l00175"></a>00175                                            <span class="comment">/* initial value */</span>0,
<a name="l00176"></a>00176                                            <span class="comment">/* array size */</span><a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb75e89ab30f628ead28a1eeb733ffe0cd1">CSTALL_num</a>,
<a name="l00177"></a>00177                                            <span class="comment">/* bucket size */</span>1,
<a name="l00178"></a>00178                                            <span class="comment">/* print format */</span>(<a class="code" href="zesto_2stats_8h.html#a2ea8c2ebd4b70b8bb60561c6fada674">PF_COUNT</a>|<a class="code" href="zesto_2stats_8h.html#7e857abbfb7e3dc6d4446052a96653a3">PF_PDF</a>),
<a name="l00179"></a>00179                                            <span class="comment">/* format */</span>NULL,
<a name="l00180"></a>00180                                            <span class="comment">/* index map */</span><a class="code" href="classcore__commit__DPM__t.html#43a64e6d323f15ad135b52bc55313dbd">commit_stall_str</a>,
<a name="l00181"></a>00181                                            <span class="comment">/* print fn */</span>NULL);
<a name="l00182"></a>00182 
<a name="l00183"></a>00183   <a class="code" href="zesto_2stats_8h.html#ed9b9c4535e4fc2e59a090d6e8157d4f">stat_reg_note</a>(sdb,<span class="stringliteral">"#### TIMING STATS ####"</span>);
<a name="l00184"></a>00184   sprintf(buf,<span class="stringliteral">"c%d.sim_cycle"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00185"></a>00185   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of cycles when last instruction (or uop) committed"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5bdfc20ac509b4f10d9ac1b28f8c5a35">final_sim_cycle</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5bdfc20ac509b4f10d9ac1b28f8c5a35">final_sim_cycle</a>, NULL);
<a name="l00186"></a>00186   <span class="comment">/* cumulative slip cycles (not printed) */</span>
<a name="l00187"></a>00187   sprintf(buf,<span class="stringliteral">"c%d.Mop_fetch_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00188"></a>00188   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total Mop fetch slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a15f0041c9b3bed648185155199f5718">Mop_fetch_slip</a>, 0, NULL);
<a name="l00189"></a>00189   sprintf(buf,<span class="stringliteral">"c%d.Mop_f2d_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00190"></a>00190   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total Mop fetch-to-decode slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b64f8c00b6daf64bb83abecc174be7a6">Mop_fetch2decode_slip</a>, 0, NULL);
<a name="l00191"></a>00191   sprintf(buf,<span class="stringliteral">"c%d.Mop_decode_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00192"></a>00192   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total Mop decode slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5b29d573d49d3e185fcf636cbd41d098">Mop_decode_slip</a>, 0, NULL);
<a name="l00193"></a>00193   sprintf(buf,<span class="stringliteral">"c%d.uop_d2a_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00194"></a>00194   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total uop decode-to-alloc slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a68f914b607a15a547982a11acb46de6">uop_decode2alloc_slip</a>, 0, NULL);
<a name="l00195"></a>00195   sprintf(buf,<span class="stringliteral">"c%d.uop_a2r_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00196"></a>00196   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total uop alloc-to-ready slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#2558608f59a0d6feeb4ca9b7c0a56ad9">uop_alloc2ready_slip</a>, 0, NULL);
<a name="l00197"></a>00197   sprintf(buf,<span class="stringliteral">"c%d.uop_r2i_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00198"></a>00198   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total uop ready-to-issue slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a149b0bc43f0c6f36c02c682535ef69b">uop_ready2issue_slip</a>, 0, NULL);
<a name="l00199"></a>00199   sprintf(buf,<span class="stringliteral">"c%d.uop_i2e_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00200"></a>00200   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total uop issue-to-exec slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#0091584a14f71deacbbb940022cfee09">uop_issue2exec_slip</a>, 0, NULL);
<a name="l00201"></a>00201   sprintf(buf,<span class="stringliteral">"c%d.uop_e2w_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00202"></a>00202   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total uop exec-to-WB slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#615ce46ec3e9886d71524faa67c1d7f9">uop_exec2complete_slip</a>, 0, NULL);
<a name="l00203"></a>00203   sprintf(buf,<span class="stringliteral">"c%d.uop_w2c_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00204"></a>00204   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total uop WB-to-commit slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#dcedefe56d42005a7e99bb8aabca20bb">uop_complete2commit_slip</a>, 0, NULL);
<a name="l00205"></a>00205   sprintf(buf,<span class="stringliteral">"c%d.Mop_d2c_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00206"></a>00206   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total Mop decode-to-commit slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#519e564423324c4a9a81ed285d6b98a6">Mop_decode2commit_slip</a>, 0, NULL);
<a name="l00207"></a>00207   sprintf(buf,<span class="stringliteral">"c%d.Mop_commit_Tslip"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00208"></a>00208   <a class="code" href="zesto_2stats_8h.html#d3b207566a223483451c345114249ac6">stat_reg_qword</a>(sdb, <span class="keyword">false</span>, buf, <span class="stringliteral">"total Mop commit slip cycles"</span>, (qword_t*) &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#34d777376f04eeaeb7a930b8e3df9fdd">Mop_commit_slip</a>, 0, NULL);
<a name="l00209"></a>00209   <span class="comment">/* average slip cycles */</span>
<a name="l00210"></a>00210   sprintf(buf,<span class="stringliteral">"c%d.Mop_fetch_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00211"></a>00211   sprintf(buf2,<span class="stringliteral">"c%d.Mop_fetch_Tslip / (c%d.commit_insn - c%d.num_traps)"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00212"></a>00212   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"Mop fetch average delay"</span>, buf2, NULL);
<a name="l00213"></a>00213   sprintf(buf,<span class="stringliteral">"c%d.Mop_f2d_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00214"></a>00214   sprintf(buf2,<span class="stringliteral">"c%d.Mop_f2d_Tslip / (c%d.commit_insn - c%d.num_traps)"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00215"></a>00215   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"Mop fetch-to-decode average delay"</span>, buf2, NULL);
<a name="l00216"></a>00216   sprintf(buf,<span class="stringliteral">"c%d.Mop_decode_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00217"></a>00217   sprintf(buf2,<span class="stringliteral">"c%d.Mop_decode_Tslip / (c%d.commit_insn - c%d.num_traps)"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00218"></a>00218   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"Mop decode average delay"</span>, buf2, NULL);
<a name="l00219"></a>00219   sprintf(buf,<span class="stringliteral">"c%d.uop_d2a_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00220"></a>00220   sprintf(buf2,<span class="stringliteral">"c%d.uop_d2a_Tslip / c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00221"></a>00221   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"uop decode-to-alloc average delay"</span>, buf2, NULL);
<a name="l00222"></a>00222   sprintf(buf,<span class="stringliteral">"c%d.uop_a2r_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00223"></a>00223   sprintf(buf2,<span class="stringliteral">"c%d.uop_a2r_Tslip / c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00224"></a>00224   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"uop alloc-to-ready average delay"</span>, buf2, NULL);
<a name="l00225"></a>00225   sprintf(buf,<span class="stringliteral">"c%d.uop_r2i_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00226"></a>00226   sprintf(buf2,<span class="stringliteral">"c%d.uop_r2i_Tslip / c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00227"></a>00227   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"uop ready-to-issue average delay"</span>, buf2, NULL);
<a name="l00228"></a>00228   sprintf(buf,<span class="stringliteral">"c%d.uop_i2e_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00229"></a>00229   sprintf(buf2,<span class="stringliteral">"c%d.uop_i2e_Tslip / c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00230"></a>00230   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"uop issue-to-exec average delay"</span>, buf2, NULL);
<a name="l00231"></a>00231   sprintf(buf,<span class="stringliteral">"c%d.uop_e2w_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00232"></a>00232   sprintf(buf2,<span class="stringliteral">"c%d.uop_e2w_Tslip / c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00233"></a>00233   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"uop exec-to-WB average delay"</span>, buf2, NULL);
<a name="l00234"></a>00234   sprintf(buf,<span class="stringliteral">"c%d.uop_w2c_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00235"></a>00235   sprintf(buf2,<span class="stringliteral">"c%d.uop_w2c_Tslip / c%d.commit_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00236"></a>00236   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"uop WB-to-commit average delay"</span>, buf2, NULL);
<a name="l00237"></a>00237   sprintf(buf,<span class="stringliteral">"c%d.Mop_d2c_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00238"></a>00238   sprintf(buf2,<span class="stringliteral">"c%d.Mop_d2c_Tslip / (c%d.commit_insn - c%d.num_traps)"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00239"></a>00239   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"Mop decode-to-commit average delay"</span>, buf2, NULL);
<a name="l00240"></a>00240   sprintf(buf,<span class="stringliteral">"c%d.Mop_commit_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00241"></a>00241   sprintf(buf2,<span class="stringliteral">"c%d.Mop_commit_Tslip / (c%d.commit_insn - c%d.num_traps)"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00242"></a>00242   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"Mop commit average delay"</span>, buf2, NULL);
<a name="l00243"></a>00243   sprintf(buf,<span class="stringliteral">"c%d.Mop_avg_end_to_end"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00244"></a>00244   sprintf(buf2,<span class="stringliteral">"c%d.Mop_fetch_avg_slip + c%d.Mop_f2d_avg_slip + c%d.Mop_d2c_avg_slip + c%d.Mop_commit_avg_slip"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00245"></a>00245   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"Mop average end-to-end pipeline delay"</span>, buf2, NULL);
<a name="l00246"></a>00246   <span class="comment">/* instruction distribution stats */</span>
<a name="l00247"></a>00247   <a class="code" href="zesto_2stats_8h.html#ed9b9c4535e4fc2e59a090d6e8157d4f">stat_reg_note</a>(sdb,<span class="stringliteral">"\n#### INSTRUCTION STATS (no wrong-path) ####"</span>);
<a name="l00248"></a>00248   sprintf(buf,<span class="stringliteral">"c%d.num_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00249"></a>00249   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of instructions committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#695be096dc6d4c3ef8dadfb9875a3c38">commit_insn</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#695be096dc6d4c3ef8dadfb9875a3c38">commit_insn</a>, NULL);
<a name="l00250"></a>00250   sprintf(buf,<span class="stringliteral">"c%d.num_refs"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00251"></a>00251   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of loads and stores committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#f7dad952fb9b6af8fa5e7bd24f793c7c">commit_refs</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#f7dad952fb9b6af8fa5e7bd24f793c7c">commit_refs</a>, NULL);
<a name="l00252"></a>00252   sprintf(buf,<span class="stringliteral">"c%d.num_loads"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00253"></a>00253   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of loads committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6795007baed703f79069c605b342462c">commit_loads</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6795007baed703f79069c605b342462c">commit_loads</a>, NULL);
<a name="l00254"></a>00254   sprintf(buf2,<span class="stringliteral">"c%d.num_refs - c%d.num_loads"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00255"></a>00255   sprintf(buf,<span class="stringliteral">"c%d.num_stores"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00256"></a>00256   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of stores committed"</span>, buf2, <span class="stringliteral">"%12.0f"</span>);
<a name="l00257"></a>00257   sprintf(buf,<span class="stringliteral">"c%d.num_branches"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00258"></a>00258   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of branches committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#ab2545830130a7d2c6cc828e896bee0b">commit_branches</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#ab2545830130a7d2c6cc828e896bee0b">commit_branches</a>, NULL);
<a name="l00259"></a>00259   sprintf(buf,<span class="stringliteral">"c%d.num_traps"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00260"></a>00260   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of traps committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#e8807b9f2691c7f2f705541a69733514">commit_traps</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#e8807b9f2691c7f2f705541a69733514">commit_traps</a>, NULL);
<a name="l00261"></a>00261   sprintf(buf,<span class="stringliteral">"c%d.num_rep_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00262"></a>00262   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of REP insts committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6ed6d4bf6827a4b7f5f947ee1fe06461">commit_rep_insn</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6ed6d4bf6827a4b7f5f947ee1fe06461">commit_rep_insn</a>, NULL);
<a name="l00263"></a>00263   sprintf(buf,<span class="stringliteral">"c%d.num_rep_iter"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00264"></a>00264   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of REP iterations committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5fde43047a0bf209409fd84fea291cb7">commit_rep_iterations</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5fde43047a0bf209409fd84fea291cb7">commit_rep_iterations</a>, NULL);
<a name="l00265"></a>00265   sprintf(buf,<span class="stringliteral">"c%d.num_rep_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00266"></a>00266   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of uops in REP insts committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a4ceed200ed821113ab79de29aa771d3">commit_rep_uops</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a4ceed200ed821113ab79de29aa771d3">commit_rep_uops</a>, NULL);
<a name="l00267"></a>00267   sprintf(buf,<span class="stringliteral">"c%d.num_avg_reps"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00268"></a>00268   sprintf(buf2,<span class="stringliteral">"c%d.num_rep_iter/c%d.num_rep_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00269"></a>00269   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average iterations per REP inst"</span>, buf2, <span class="stringliteral">"%12.2f"</span>);
<a name="l00270"></a>00270   sprintf(buf,<span class="stringliteral">"c%d.num_avg_rep_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00271"></a>00271   sprintf(buf2,<span class="stringliteral">"c%d.num_rep_uops/c%d.num_rep_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00272"></a>00272   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average uops per REP inst"</span>, buf2, <span class="stringliteral">"%12.2f"</span>);
<a name="l00273"></a>00273   sprintf(buf,<span class="stringliteral">"c%d.num_UROM_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00274"></a>00274   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of insn using the UROM committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#f74f8ee918a3458e8c6eeda7519f1967">commit_UROM_insn</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#f74f8ee918a3458e8c6eeda7519f1967">commit_UROM_insn</a>, NULL);
<a name="l00275"></a>00275   sprintf(buf,<span class="stringliteral">"c%d.num_UROM_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00276"></a>00276   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of uops using the UROM committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#392acd37d5938f3a2b2623edc443ee19">commit_UROM_uops</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#392acd37d5938f3a2b2623edc443ee19">commit_UROM_uops</a>, NULL);
<a name="l00277"></a>00277   sprintf(buf,<span class="stringliteral">"c%d.num_UROM_eff_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00278"></a>00278   <a class="code" href="machine_8h.html#d5b220607569cd144bbc637326632a1d">stat_reg_counter</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"total number of effective uops using the UROM committed"</span>, &amp;<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#bf911fc8f2203830b120207411ea1260">commit_UROM_eff_uops</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#bf911fc8f2203830b120207411ea1260">commit_UROM_eff_uops</a>, NULL);
<a name="l00279"></a>00279   sprintf(buf,<span class="stringliteral">"c%d.num_avg_UROM_uops"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00280"></a>00280   sprintf(buf2,<span class="stringliteral">"c%d.num_UROM_uops/c%d.num_UROM_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00281"></a>00281   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average uops per UROM inst"</span>, buf2, <span class="stringliteral">"%12.2f"</span>);
<a name="l00282"></a>00282   sprintf(buf,<span class="stringliteral">"c%d.avg_flowlen"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00283"></a>00283   sprintf(buf2,<span class="stringliteral">"c%d.commit_uops/c%d.commit_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00284"></a>00284   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average uops per instruction"</span>, buf2, NULL);
<a name="l00285"></a>00285   sprintf(buf,<span class="stringliteral">"c%d.avg_eff_flowlen"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00286"></a>00286   sprintf(buf2,<span class="stringliteral">"c%d.commit_eff_uops/c%d.commit_insn"</span>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,arch-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00287"></a>00287   <a class="code" href="zesto_2stats_8h.html#f2f491659903b1b21de69fe6c767a64a">stat_reg_formula</a>(sdb, <span class="keyword">true</span>, buf, <span class="stringliteral">"average effective uops per instruction"</span>, buf2, NULL);
<a name="l00288"></a>00288   sprintf(buf,<span class="stringliteral">"c%d.flow_lengths"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00289"></a>00289   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#fedfecd010b8b8c8f91aac0e0e8700d6">flow_histo</a> = <a class="code" href="zesto_2stats_8h.html#b68118a778041ff66b7dec8bf1030ef4">stat_reg_dist</a>(sdb, buf,
<a name="l00290"></a>00290                                            <span class="stringliteral">"histogram of uop flow lengths"</span>,
<a name="l00291"></a>00291                                            <span class="comment">/* initial value */</span>0,
<a name="l00292"></a>00292                                            <span class="comment">/* array size */</span><a class="code" href="commit-DPM_8cpp.html#7e301e88bf620815320ee07e9bda6e62">FLOW_HISTO_SIZE</a>,
<a name="l00293"></a>00293                                            <span class="comment">/* bucket size */</span>1,
<a name="l00294"></a>00294                                            <span class="comment">/* print format */</span>(<a class="code" href="zesto_2stats_8h.html#a2ea8c2ebd4b70b8bb60561c6fada674">PF_COUNT</a>|<a class="code" href="zesto_2stats_8h.html#7e857abbfb7e3dc6d4446052a96653a3">PF_PDF</a>),
<a name="l00295"></a>00295                                            <span class="comment">/* format */</span>NULL,
<a name="l00296"></a>00296                                            <span class="comment">/* index map */</span>NULL,
<a name="l00297"></a>00297                                            <span class="comment">/* print fn */</span>NULL);
<a name="l00298"></a>00298   sprintf(buf,<span class="stringliteral">"c%d.eff_flow_lengths"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00299"></a>00299   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b6a60a80d28dae8b4d70540af78fc0ba">eff_flow_histo</a> = <a class="code" href="zesto_2stats_8h.html#b68118a778041ff66b7dec8bf1030ef4">stat_reg_dist</a>(sdb, buf,
<a name="l00300"></a>00300                                            <span class="stringliteral">"histogram of effective uop flow lengths"</span>,
<a name="l00301"></a>00301                                            <span class="comment">/* initial value */</span>0,
<a name="l00302"></a>00302                                            <span class="comment">/* array size */</span><a class="code" href="commit-DPM_8cpp.html#7e301e88bf620815320ee07e9bda6e62">FLOW_HISTO_SIZE</a>,
<a name="l00303"></a>00303                                            <span class="comment">/* bucket size */</span>1,
<a name="l00304"></a>00304                                            <span class="comment">/* print format */</span>(<a class="code" href="zesto_2stats_8h.html#a2ea8c2ebd4b70b8bb60561c6fada674">PF_COUNT</a>|<a class="code" href="zesto_2stats_8h.html#7e857abbfb7e3dc6d4446052a96653a3">PF_PDF</a>),
<a name="l00305"></a>00305                                            <span class="comment">/* format */</span>NULL,
<a name="l00306"></a>00306                                            <span class="comment">/* index map */</span>NULL,
<a name="l00307"></a>00307                                            <span class="comment">/* print fn */</span>NULL);
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 
<a name="l00310"></a><a class="code" href="classcore__commit__DPM__t.html#14bc2b8a134d2a8fd46e598149e08f46">00310</a> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#14bc2b8a134d2a8fd46e598149e08f46">core_commit_DPM_t::update_occupancy</a>(<span class="keywordtype">void</span>)
<a name="l00311"></a>00311 {
<a name="l00312"></a>00312     <span class="comment">/* ROB */</span>
<a name="l00313"></a>00313   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#899085658ec2043bdc858c5d80c77042">ROB_occupancy</a> += <a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a>;
<a name="l00314"></a>00314   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#2bfcce3e6cb1e4fde8078e30842627e8">ROB_eff_occupancy</a> += <a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a>;
<a name="l00315"></a>00315   <span class="keywordflow">if</span>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &gt;= <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#a397a3f36f045e3c2a19dafc16dab1c1">knobs</a>-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>)
<a name="l00316"></a>00316     <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#beff139f1bd9e6510270680bcb52d775">ROB_full_cycles</a>++;
<a name="l00317"></a>00317   <span class="keywordflow">if</span>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &lt;= 0)
<a name="l00318"></a>00318     <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#2eda3dc8169484641c1b9fd2e511e85c">ROB_empty_cycles</a>++;
<a name="l00319"></a>00319 }
<a name="l00320"></a>00320 
<a name="l00321"></a>00321 <span class="comment">/*************************/</span>
<a name="l00322"></a>00322 <span class="comment">/* MAIN COMMIT FUNCTIONS */</span>
<a name="l00323"></a>00323 <span class="comment">/*************************/</span>
<a name="l00324"></a>00324 
<a name="l00325"></a>00325 <span class="comment">/* In-order instruction commit.  Individual uops cannot commit</span>
<a name="l00326"></a>00326 <span class="comment">   until it is guaranteed that the entire Mop's worth of uops will</span>
<a name="l00327"></a>00327 <span class="comment">   commit. */</span>
<a name="l00328"></a><a class="code" href="classcore__commit__DPM__t.html#b3b35af5a3e6aa82d61761a07da5642a">00328</a> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#b3b35af5a3e6aa82d61761a07da5642a">core_commit_DPM_t::step</a>(<span class="keywordtype">void</span>)
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330   <span class="keyword">struct </span><a class="code" href="structcore__knobs__t.html">core_knobs_t</a> * <a class="code" href="sim-zesto_8cpp.html#89a180011adecec49b08c8ef843388fa">knobs</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#a397a3f36f045e3c2a19dafc16dab1c1">knobs</a>;
<a name="l00331"></a>00331   <span class="keywordtype">int</span> commit_count = 0;
<a name="l00332"></a>00332   <span class="keyword">enum</span> <a class="code" href="classcore__commit__t.html#cf283124880a10ce01e0fb68f2aa69ce">commit_stall_t</a> stall_reason = <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7a9ca1359e0e2c3557c8c9ac77439a9c2">CSTALL_NONE</a>;
<a name="l00333"></a>00333   <span class="keywordtype">int</span> branches_committed = 0;
<a name="l00334"></a>00334 
<a name="l00335"></a>00335   <span class="comment">/* This is just a deadlock watchdog.  If something got messed up</span>
<a name="l00336"></a>00336 <span class="comment">     in the pipeline and no forward progress is being made, this</span>
<a name="l00337"></a>00337 <span class="comment">     code will eventually detect it and flush the pipeline in an</span>
<a name="l00338"></a>00338 <span class="comment">     attempt to un-wedge the processor.  If the processor then</span>
<a name="l00339"></a>00339 <span class="comment">     deadlocks again without having first made any more forward</span>
<a name="l00340"></a>00340 <span class="comment">     progress, we give up and kill the simulator. */</span>
<a name="l00341"></a>00341   <span class="keywordflow">if</span>((<a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a> - <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#cdd57a5cb5d71ea527ef696086d97bee">last_completed</a>) &gt; <a class="code" href="classcore__commit__t.html#53d4826f7dee27103a4065799875796a">deadlock_threshold</a>)
<a name="l00342"></a>00342   {
<a name="l00343"></a>00343     <span class="keywordflow">if</span>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#a1444430b4a5c68a31066fed05b3f774">last_completed_count</a> == <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a41c519bf86d69b41a84c7253bf14276">eio_commit_insn</a>)
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345       <span class="keywordtype">char</span> buf[256];
<a name="l00346"></a>00346       snprintf(buf,<span class="keyword">sizeof</span>(buf),<span class="stringliteral">"At cycle %lld, core[%d] has not completed a uop in %d cycles... definite deadlock"</span>,(<span class="keywordtype">long</span> <span class="keywordtype">long</span>)<a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,<a class="code" href="classcore__commit__t.html#53d4826f7dee27103a4065799875796a">deadlock_threshold</a>);
<a name="l00347"></a>00347 <span class="preprocessor">#ifdef ZTRACE</span>
<a name="l00348"></a>00348 <span class="preprocessor"></span>      ztrace_print(<span class="stringliteral">"DEADLOCK DETECTED: TERMINATING SIMULATION"</span>);
<a name="l00349"></a>00349 <span class="preprocessor">#endif</span>
<a name="l00350"></a>00350 <span class="preprocessor"></span>      <a class="code" href="zesto-MC_8h.html#a62f33e5d3102234e8f957f4722f5f51">zesto_fatal</a>(buf,(<span class="keywordtype">void</span>)0);
<a name="l00351"></a>00351     }
<a name="l00352"></a>00352     <span class="keywordflow">else</span>
<a name="l00353"></a>00353     {
<a name="l00354"></a>00354 
<a name="l00355"></a>00355       <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * uop = <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[<a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a>];
<a name="l00356"></a>00356      <span class="comment">//fprintf(stderr,"\nMop at the head "); </span>
<a name="l00357"></a>00357       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii=0;ii&lt; uop-&gt;<a class="code" href="structuop__t.html#5752c48ff1454c5c470509db2fa46b7a">Mop</a>-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#268a8bdf9dc08de70db61fbbdd52480d">inst</a>.<a class="code" href="structmd__inst__t.html#d7a24ed96b5a93217bf1cbd39c2bb859">qemu_len</a>;ii++)
<a name="l00358"></a>00358       {
<a name="l00359"></a>00359         <span class="comment">//fprintf(stderr,"%d ", uop-&gt;Mop-&gt;fetch.inst.qemu_len);</span>
<a name="l00360"></a>00360         <span class="comment">//fprintf(stderr,"%x ", uop-&gt;Mop-&gt;fetch.inst.code[ii]);</span>
<a name="l00361"></a>00361       }
<a name="l00362"></a>00362       <a class="code" href="misc_8h.html#f80d19f1297a11626fab61a248959c71">warn</a>(<span class="stringliteral">"At cycle %lld, core[%d] has not completed a uop in %d cycles... possible deadlock, flushing pipeline"</span>,(<span class="keywordtype">long</span> <span class="keywordtype">long</span>)<a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>,<a class="code" href="classcore__commit__t.html#53d4826f7dee27103a4065799875796a">deadlock_threshold</a>);
<a name="l00363"></a>00363 <span class="preprocessor">#ifdef ZTRACE</span>
<a name="l00364"></a>00364 <span class="preprocessor"></span>      ztrace_print(<span class="stringliteral">"DEADLOCK DETECTED: FLUSHING PIPELINE"</span>);
<a name="l00365"></a>00365 <span class="preprocessor">#endif</span>
<a name="l00366"></a>00366 <span class="preprocessor"></span>
<a name="l00367"></a>00367       <span class="comment">/* flush the entire pipeline, correct path or not... */</span>
<a name="l00368"></a>00368       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#e4ae7e910eea6077916a780537d3210e">oracle</a>-&gt;<a class="code" href="classcore__oracle__t.html#9f125e90b225555a2632277161f3b27c">complete_flush</a>();
<a name="l00369"></a>00369       <span class="comment">/*core-&gt;commit-&gt;*/</span><a class="code" href="classcore__commit__DPM__t.html#b0ca7c01d6c22c55f529bd9cec7a809b">recover</a>();
<a name="l00370"></a>00370       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#b9edcea5d76d1bbdbe89696ddf876c73">recover</a>();
<a name="l00371"></a>00371       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#20394b8c7a44d5ad56a16e9cd635299e">alloc</a>-&gt;<a class="code" href="classcore__alloc__t.html#e8350cafe32ac5219eaea41e6fb11f57">recover</a>();
<a name="l00372"></a>00372       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#5a8f490b74ace2edeb7f90c493c98691">decode</a>-&gt;<a class="code" href="classcore__decode__t.html#4cc12f3baa24ee5764ae57d87b759743">recover</a>();
<a name="l00373"></a>00373       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#bb3b5f18fa768382f617bcdec3ee7d7e">fetch</a>-&gt;<a class="code" href="classcore__fetch__t.html#5f9f05d72804be74a2a622eeb5456e51">recover</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#91103da0506a0127e32ad580eef763f2">regs</a>.<a class="code" href="structregs__t.html#70500e5215c4ebb383c43c05a670346c">regs_NPC</a>);
<a name="l00374"></a>00374       <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="zesto_2stats_8h.html#702503b8068fdcce1dc8712be9791d42">stat_add_sample</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#9aa1b782d670256448505543248b88dd">commit_stall</a>, (<span class="keywordtype">int</span>)<a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb72432ee6a04f56d4f6288569a152deb63">CSTALL_EMPTY</a>);)
<a name="l00375"></a>00375       <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6c0721ecba9c68f18708d4b2fb155285">commit_deadlock_flushes</a>++;)
<a name="l00376"></a>00376       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#cdd57a5cb5d71ea527ef696086d97bee">last_completed</a> = sim_cycle; <span class="comment">/* so we don't do this again next cycle */</span>
<a name="l00377"></a>00377       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#a1444430b4a5c68a31066fed05b3f774">last_completed_count</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a41c519bf86d69b41a84c7253bf14276">eio_commit_insn</a>;
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379     <span class="keywordflow">return</span>;
<a name="l00380"></a>00380   }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382   <span class="comment">/* deallocate at most one store from the (senior) STQ per cycle */</span>
<a name="l00383"></a>00383   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#d0eb8078d0ec0809e3ce7741826babbc">STQ_deallocate_senior</a>();
<a name="l00384"></a>00384 
<a name="l00385"></a>00385   <span class="comment">/* MAIN COMMIT LOOP */</span>
<a name="l00386"></a>00386   <span class="keywordflow">for</span>(commit_count=0;commit_count&lt;knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#b58b777420f6904e072325942a0c2415">width</a>;commit_count++)
<a name="l00387"></a>00387   {
<a name="l00388"></a>00388     <span class="keywordflow">if</span>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &lt;= 0) <span class="comment">/* nothing to commit */</span>
<a name="l00389"></a>00389     {
<a name="l00390"></a>00390       stall_reason = <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb72432ee6a04f56d4f6288569a152deb63">CSTALL_EMPTY</a>;
<a name="l00391"></a>00391       <span class="keywordflow">break</span>;
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     <span class="keyword">struct </span><a class="code" href="structMop__t.html">Mop_t</a> * Mop = <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[<a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a>]-&gt;<a class="code" href="structuop__t.html#5752c48ff1454c5c470509db2fa46b7a">Mop</a>;
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="comment">/* For branches, don't commit until the corresponding jeclear</span>
<a name="l00397"></a>00397 <span class="comment">       (if any) has been processed by the front-end. */</span>
<a name="l00398"></a>00398     <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#e6995a52499b926cb6b9f929208a5fff">jeclear_in_flight</a>)
<a name="l00399"></a>00399     {
<a name="l00400"></a>00400       stall_reason = <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7a7048d33b9b811882574ca343c75ed23">CSTALL_JECLEAR_INFLIGHT</a>;
<a name="l00401"></a>00401       <span class="keywordflow">break</span>;
<a name="l00402"></a>00402     }
<a name="l00403"></a>00403 
<a name="l00404"></a>00404     <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#64bb9f9c135012445c43e8823e98bb3d">is_ctrl</a> &amp;&amp; knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#0b19d96dc6890d63fa3bfc5d11221302">branch_limit</a> &amp;&amp; (branches_committed &gt;= knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#0b19d96dc6890d63fa3bfc5d11221302">branch_limit</a>))
<a name="l00405"></a>00405     {
<a name="l00406"></a>00406       stall_reason = <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb758fe5cdefc2980e6e0881c54736130dd">CSTALL_MAX_BRANCHES</a>;
<a name="l00407"></a>00407       <span class="keywordflow">break</span>;
<a name="l00408"></a>00408     }
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#f445a1796fbcfb01bb7094b956b4361a">oracle</a>.<a class="code" href="structMop__t.html#92d2861b39c23b47dd58854da3288e81">spec_mode</a>)
<a name="l00411"></a>00411       <a class="code" href="zesto-MC_8h.html#a62f33e5d3102234e8f957f4722f5f51">zesto_fatal</a>(<span class="stringliteral">"oldest instruction in processor is on wrong-path"</span>,(<span class="keywordtype">void</span>)0);
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <span class="comment">/* Are all uops in the Mop completed? */</span>
<a name="l00414"></a>00414     <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#bf12e6ea4212ed366a436c76d7b72fad">complete_index</a> != -1) <span class="comment">/* still some outstanding insts */</span>
<a name="l00415"></a>00415     {
<a name="l00416"></a>00416       <span class="keywordflow">while</span>(Mop-&gt;<a class="code" href="structMop__t.html#b435acfedb392843bc50658c7650cbdd">uop</a>[Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#bf12e6ea4212ed366a436c76d7b72fad">complete_index</a>].<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#bad67330b68f9df896e3846b50df1f14">when_completed</a> &lt;= <a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a>)
<a name="l00417"></a>00417       {
<a name="l00418"></a>00418         <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * uop = &amp;Mop-&gt;<a class="code" href="structMop__t.html#b435acfedb392843bc50658c7650cbdd">uop</a>[Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#bf12e6ea4212ed366a436c76d7b72fad">complete_index</a>];
<a name="l00419"></a>00419 
<a name="l00420"></a>00420         Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#bf12e6ea4212ed366a436c76d7b72fad">complete_index</a> += uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#5f5acb91cf98e7630d1fff849c0458be">has_imm</a> ? 3 : 1;
<a name="l00421"></a>00421         <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#bf12e6ea4212ed366a436c76d7b72fad">complete_index</a> &gt;= Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#7718f3555efe88921d86e395fc3fbc74">flow_length</a>)
<a name="l00422"></a>00422         {
<a name="l00423"></a>00423           Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#bf12e6ea4212ed366a436c76d7b72fad">complete_index</a> = -1; <span class="comment">/* Mark this Mop as all done */</span>
<a name="l00424"></a>00424 <span class="preprocessor">#ifdef ZTRACE</span>
<a name="l00425"></a>00425 <span class="preprocessor"></span>          ztrace_print(Mop,<span class="stringliteral">"c|complete|all uops completed execution"</span>);
<a name="l00426"></a>00426 <span class="preprocessor">#endif</span>
<a name="l00427"></a>00427 <span class="preprocessor"></span>          <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#f33535affa9efa0509db7e31a70bea08">bpred_update</a>)
<a name="l00428"></a>00428           {
<a name="l00429"></a>00429             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#bb3b5f18fa768382f617bcdec3ee7d7e">fetch</a>-&gt;<a class="code" href="classcore__fetch__t.html#0dd5fd2d75f870de5fb95a496e3e6844">bpred</a>-&gt;<a class="code" href="classbpred__t.html#8c7073a32e9c65c31b1af33b6c16b754">update</a>(Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#f33535affa9efa0509db7e31a70bea08">bpred_update</a>,Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#7301ad4e0c0f5ece738ba62448f7c655">opflags</a>,
<a name="l00430"></a>00430                 Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#5645e3dfe55b1b6b2206ffb38379c44d">PC</a>, Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#f820451bdee352d521eb3bf905c3d4e0">targetPC</a>, Mop-&gt;<a class="code" href="structMop__t.html#f445a1796fbcfb01bb7094b956b4361a">oracle</a>.<a class="code" href="structMop__t.html#56859cbd74e3f756c4b2ef9f573fe642">NextPC</a>, (Mop-&gt;<a class="code" href="structMop__t.html#f445a1796fbcfb01bb7094b956b4361a">oracle</a>.<a class="code" href="structMop__t.html#56859cbd74e3f756c4b2ef9f573fe642">NextPC</a> != (Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#5645e3dfe55b1b6b2206ffb38379c44d">PC</a> + Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#268a8bdf9dc08de70db61fbbdd52480d">inst</a>.<a class="code" href="structmd__inst__t.html#5dad80b28e8ae15c2bd387663d32fb7e">len</a>)));
<a name="l00431"></a>00431             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#bb3b5f18fa768382f617bcdec3ee7d7e">fetch</a>-&gt;<a class="code" href="classcore__fetch__t.html#0dd5fd2d75f870de5fb95a496e3e6844">bpred</a>-&gt;<a class="code" href="classbpred__t.html#f9c3b3c249ede7672c20b900ff8768e9">return_state_cache</a>(Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#f33535affa9efa0509db7e31a70bea08">bpred_update</a>);
<a name="l00432"></a>00432             Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#f33535affa9efa0509db7e31a70bea08">bpred_update</a> = NULL;
<a name="l00433"></a>00433           }
<a name="l00434"></a>00434           <span class="keywordflow">break</span>;
<a name="l00435"></a>00435         }
<a name="l00436"></a>00436       }
<a name="l00437"></a>00437     }
<a name="l00438"></a>00438 
<a name="l00439"></a>00439     <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#bf12e6ea4212ed366a436c76d7b72fad">complete_index</a> == -1) <span class="comment">/* commit the uops if the Mop is done */</span>
<a name="l00440"></a>00440     {
<a name="l00441"></a>00441       <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * uop = <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[<a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a>];
<a name="l00442"></a>00442       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#bad67330b68f9df896e3846b50df1f14">when_completed</a> &lt;= <a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a>,(<span class="keywordtype">void</span>)0);
<a name="l00443"></a>00443       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(uop-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#e66802928ecce35d60f0495dee0a4ae7">ROB_index</a> == <a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a>,(<span class="keywordtype">void</span>)0);
<a name="l00444"></a>00444       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(uop == &amp;Mop-&gt;<a class="code" href="structMop__t.html#b435acfedb392843bc50658c7650cbdd">uop</a>[Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#2e86bc0a7037dfc0948a3dc895f02735">commit_index</a>],(<span class="keywordtype">void</span>)0);
<a name="l00445"></a>00445 
<a name="l00446"></a>00446       <span class="keywordflow">if</span>(uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#075d4a905368cc1eeb377d2a41bd9c20">BOM</a> &amp;&amp; (uop-&gt;<a class="code" href="structuop__t.html#5752c48ff1454c5c470509db2fa46b7a">Mop</a>-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#bb62262ae07e9e18cb4869c709e366ad">when_commit_started</a> == <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>))
<a name="l00447"></a>00447         uop-&gt;<a class="code" href="structuop__t.html#5752c48ff1454c5c470509db2fa46b7a">Mop</a>-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#bb62262ae07e9e18cb4869c709e366ad">when_commit_started</a> = <a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a>;
<a name="l00448"></a>00448 
<a name="l00449"></a>00449       <span class="keywordflow">if</span>(uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#fd9cc07575e4452cb5192588691e6814">is_load</a>)
<a name="l00450"></a>00450         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#9a7d0f033b9eddd6d725fa0477e6d013">LDQ_deallocate</a>(uop);
<a name="l00451"></a>00451       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#eec85d8cffdbdff59e335df7cf38174a">is_sta</a>)
<a name="l00452"></a>00452         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#6f97e052e83526ba786d2f02f82dfd66">STQ_deallocate_sta</a>();
<a name="l00453"></a>00453       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#85d4bc293425ae1bcd322b314414ce1b">is_std</a>) <span class="comment">/* we alloc on STA, dealloc on STD */</span>
<a name="l00454"></a>00454       {
<a name="l00455"></a>00455         <span class="keywordflow">if</span>(!<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#a47688b9de31bdfd1f56cadd6a735a12">STQ_deallocate_std</a>(uop))
<a name="l00456"></a>00456           <span class="keywordflow">break</span>;
<a name="l00457"></a>00457       }
<a name="l00458"></a>00458 
<a name="l00459"></a>00459       <span class="comment">/* any remaining transactions in-flight (only for loads)</span>
<a name="l00460"></a>00460 <span class="comment">         should now be ignored - such load requests may exist, for</span>
<a name="l00461"></a>00461 <span class="comment">         example as a result of a load that completes early due to</span>
<a name="l00462"></a>00462 <span class="comment">         a hit in the STQ while the cache request is still making</span>
<a name="l00463"></a>00463 <span class="comment">         its way through the memory hierarchy. */</span>
<a name="l00464"></a>00464       <span class="keywordflow">if</span>(uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#fd9cc07575e4452cb5192588691e6814">is_load</a>)
<a name="l00465"></a>00465         uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#47dc4af18b603fd6693da3d213ff3298">action_id</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#110f33d959a11c403fb9166326c7e5f3">new_action_id</a>();
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 <span class="preprocessor">#ifdef ZTRACE</span>
<a name="l00468"></a>00468 <span class="preprocessor"></span>      ztrace_print(uop,<span class="stringliteral">"c|commit|uop committed"</span>);
<a name="l00469"></a>00469 <span class="preprocessor">#endif</span>
<a name="l00470"></a>00470 <span class="preprocessor"></span>
<a name="l00471"></a>00471       <span class="keywordflow">if</span>(uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#be01a5d7b4a12d36d753ca8e295cceb6">EOM</a>)
<a name="l00472"></a>00472         uop-&gt;<a class="code" href="structuop__t.html#5752c48ff1454c5c470509db2fa46b7a">Mop</a>-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#e1bbc6ef1aa73472c028b716fc3c5ef8">when_commit_finished</a> = <a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a>;
<a name="l00473"></a>00473 
<a name="l00474"></a>00474       <span class="comment">/* remove uop from ROB */</span>
<a name="l00475"></a>00475       <span class="keywordflow">if</span>((!uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#831dde25d8ef14de7a0c73bc3a5fa3c9">in_fusion</a>) || (uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a> == NULL)) <span class="comment">/* fusion dealloc's on fusion-tail */</span>
<a name="l00476"></a>00476       {
<a name="l00477"></a>00477         <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[<a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a>] = NULL;
<a name="l00478"></a>00478         <a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> --;
<a name="l00479"></a>00479         <a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a> --;
<a name="l00480"></a>00480         <a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a> = <a class="code" href="misc_8h.html#ec0decc56f83415e5cd152f876e5dde1">modinc</a>(<a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a>,knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>); <span class="comment">//(ROB_head+1) % knobs-&gt;commit.ROB_size;</span>
<a name="l00481"></a>00481         <span class="keywordflow">if</span>(uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#831dde25d8ef14de7a0c73bc3a5fa3c9">in_fusion</a>)
<a name="l00482"></a>00482         {
<a name="l00483"></a>00483           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6c057bd1e63107df76c484a31595b75e">commit_fusions</a>++;)
<a name="l00484"></a>00484         }
<a name="l00485"></a>00485       }
<a name="l00486"></a>00486       <span class="keywordflow">else</span> <span class="comment">/* fusion body doesn't count toward commit width */</span>
<a name="l00487"></a>00487       {
<a name="l00488"></a>00488         commit_count--;
<a name="l00489"></a>00489         <span class="comment">/* XXX: this is really ugly.  To avoid inserting another</span>
<a name="l00490"></a>00490 <span class="comment">           uop-traversing loop within the commit loop, we replace</span>
<a name="l00491"></a>00491 <span class="comment">           the ROB[.] pointer with the next uop to commit (for</span>
<a name="l00492"></a>00492 <span class="comment">           fusion).  That is, if we have a two-uop fused set (A,B),</span>
<a name="l00493"></a>00493 <span class="comment">           originally ROB[.] would point to A, which has a pointer</span>
<a name="l00494"></a>00494 <span class="comment">           through fusion_next to B.  Once we commit A, we will</span>
<a name="l00495"></a>00495 <span class="comment">           replace ROB[.] with B. */</span>
<a name="l00496"></a>00496         <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[<a class="code" href="classcore__commit__DPM__t.html#472b312fa89b38b447adcad1f2e1093c">ROB_head</a>] = uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a>;
<a name="l00497"></a>00497         <a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a> --;
<a name="l00498"></a>00498         <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(<a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a> &gt;= 0,(<span class="keywordtype">void</span>)0);
<a name="l00499"></a>00499       }
<a name="l00500"></a>00500       uop-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#e66802928ecce35d60f0495dee0a4ae7">ROB_index</a> = -1;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502       <span class="keywordflow">if</span>(!uop-&gt;<a class="code" href="structuop__t.html#5752c48ff1454c5c470509db2fa46b7a">Mop</a>-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#2ac0786c8628d0e7042cdc07a8d6fcdd">is_trap</a>)
<a name="l00503"></a>00503       {
<a name="l00504"></a>00504         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a68f914b607a15a547982a11acb46de6">uop_decode2alloc_slip</a> += uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> - uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#67254717405ebd49e51d3e8633823a4c">when_decoded</a>;)
<a name="l00505"></a>00505         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#2558608f59a0d6feeb4ca9b7c0a56ad9">uop_alloc2ready_slip</a> += uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#0d34db19472056540aed52be61665241">when_ready</a> - uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a>;)
<a name="l00506"></a>00506         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a149b0bc43f0c6f36c02c682535ef69b">uop_ready2issue_slip</a> += uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#780ed24e3aa8b3709e7a93c88ff31132">when_issued</a> - uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#0d34db19472056540aed52be61665241">when_ready</a>;)
<a name="l00507"></a>00507         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#0091584a14f71deacbbb940022cfee09">uop_issue2exec_slip</a> += uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#6a823830b3496618e63ce4486f60fe8c">when_exec</a> - uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#780ed24e3aa8b3709e7a93c88ff31132">when_issued</a>;)
<a name="l00508"></a>00508         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#615ce46ec3e9886d71524faa67c1d7f9">uop_exec2complete_slip</a> += uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#bad67330b68f9df896e3846b50df1f14">when_completed</a> - uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#6a823830b3496618e63ce4486f60fe8c">when_exec</a>;)
<a name="l00509"></a>00509         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#dcedefe56d42005a7e99bb8aabca20bb">uop_complete2commit_slip</a> += <a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a> - uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#bad67330b68f9df896e3846b50df1f14">when_completed</a>;)
<a name="l00510"></a>00510 
<a name="l00511"></a>00511         <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#6a823830b3496618e63ce4486f60fe8c">when_exec</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>,(<span class="keywordtype">void</span>)0);
<a name="l00512"></a>00512       }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514       <span class="comment">/* this cleans up idep/odep ptrs, register mappings, and</span>
<a name="l00515"></a>00515 <span class="comment">         commit stores to the real (non-spec) memory system */</span>
<a name="l00516"></a>00516       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#e4ae7e910eea6077916a780537d3210e">oracle</a>-&gt;<a class="code" href="classcore__oracle__t.html#ba02df09c524181a44404676f33669a5">commit_uop</a>(uop);
<a name="l00517"></a>00517 
<a name="l00518"></a>00518       <span class="comment">/* mark uop as committed in Mop */</span>
<a name="l00519"></a>00519       Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#2e86bc0a7037dfc0948a3dc895f02735">commit_index</a> += uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#5f5acb91cf98e7630d1fff849c0458be">has_imm</a> ? 3 : 1;
<a name="l00520"></a>00520 
<a name="l00521"></a>00521       <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#2e86bc0a7037dfc0948a3dc895f02735">commit_index</a> &gt;= Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#7718f3555efe88921d86e395fc3fbc74">flow_length</a>)
<a name="l00522"></a>00522       {
<a name="l00523"></a>00523         Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#2e86bc0a7037dfc0948a3dc895f02735">commit_index</a> = -1; <span class="comment">/* The entire Mop has been committed */</span>
<a name="l00524"></a>00524 
<a name="l00525"></a>00525         <span class="comment">/* Update stats */</span>
<a name="l00526"></a>00526         <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#b435acfedb392843bc50658c7650cbdd">uop</a>[Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#82638df3748d18d1c8c2e3d58d077a49">last_uop_index</a>].<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#be01a5d7b4a12d36d753ca8e295cceb6">EOM</a>)
<a name="l00527"></a>00527         {
<a name="l00528"></a>00528           <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a41c519bf86d69b41a84c7253bf14276">eio_commit_insn</a>++;
<a name="l00529"></a>00529           <a class="code" href="zesto-opts_8h.html#171eaf944329f4e388ce310836b483e9">total_commit_insn</a> ++;
<a name="l00530"></a>00530           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#695be096dc6d4c3ef8dadfb9875a3c38">commit_insn</a>++;)
<a name="l00531"></a>00531           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#55d2bfdc168268ce43fc373ccd7d3420">commit_bytes</a> += Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#268a8bdf9dc08de70db61fbbdd52480d">inst</a>.<a class="code" href="structmd__inst__t.html#5dad80b28e8ae15c2bd387663d32fb7e">len</a>;) <span class="comment">/* REP counts as only 1 fetch */</span>
<a name="l00532"></a>00532         }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534         <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#64bb9f9c135012445c43e8823e98bb3d">is_ctrl</a>)
<a name="l00535"></a>00535           branches_committed++;
<a name="l00536"></a>00536 
<a name="l00537"></a>00537         <a class="code" href="zesto-opts_8h.html#6c3a3c20b2532043566ce7c55105a880">total_commit_uops</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#b63d1f53be60fd17e64b2e6fe22e6f3b">num_uops</a>;
<a name="l00538"></a>00538         <a class="code" href="zesto-opts_8h.html#bab3d62fd7bff25cd7429ee135d4dc3d">total_commit_eff_uops</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#e76ae084a61689a2170b98ffd872a6a3">num_eff_uops</a>;
<a name="l00539"></a>00539         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#92a5adf70cb88182f89436f5be116715">commit_uops</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#b63d1f53be60fd17e64b2e6fe22e6f3b">num_uops</a>;)
<a name="l00540"></a>00540         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b9b59be72d347627a29fff615fee71e6">commit_eff_uops</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#e76ae084a61689a2170b98ffd872a6a3">num_eff_uops</a>;)
<a name="l00541"></a>00541         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#ab2545830130a7d2c6cc828e896bee0b">commit_branches</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#3112da7835a7592682fa3c358e9d3cad">num_branches</a>;)
<a name="l00542"></a>00542         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#f7dad952fb9b6af8fa5e7bd24f793c7c">commit_refs</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#f0c857b3ff34e7bac381f3999036c251">num_refs</a>;)
<a name="l00543"></a>00543         <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6795007baed703f79069c605b342462c">commit_loads</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#52274c64edc3d83425766a0f8cdd71df">num_loads</a>;)
<a name="l00544"></a>00544         <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#268a8bdf9dc08de70db61fbbdd52480d">inst</a>.<a class="code" href="structmd__inst__t.html#3cb7c4132587d2f78d978d951ab0eef7">rep</a>)
<a name="l00545"></a>00545         {
<a name="l00546"></a>00546           <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#b435acfedb392843bc50658c7650cbdd">uop</a>[Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#82638df3748d18d1c8c2e3d58d077a49">last_uop_index</a>].<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#be01a5d7b4a12d36d753ca8e295cceb6">EOM</a>)
<a name="l00547"></a>00547             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6ed6d4bf6827a4b7f5f947ee1fe06461">commit_rep_insn</a>++;)
<a name="l00548"></a>00548           <span class="keywordflow">if</span>(!Mop-&gt;<a class="code" href="structMop__t.html#f445a1796fbcfb01bb7094b956b4361a">oracle</a>.<a class="code" href="structMop__t.html#4b7707567ffe0d3d712027c190dde6b1">zero_rep</a>)
<a name="l00549"></a>00549             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5fde43047a0bf209409fd84fea291cb7">commit_rep_iterations</a>++;)
<a name="l00550"></a>00550           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a4ceed200ed821113ab79de29aa771d3">commit_rep_uops</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#b63d1f53be60fd17e64b2e6fe22e6f3b">num_uops</a>;)
<a name="l00551"></a>00551         }
<a name="l00552"></a>00552         <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#b63d1f53be60fd17e64b2e6fe22e6f3b">num_uops</a> &gt; knobs-&gt;<a class="code" href="structcore__knobs__t.html#6dc1fa40282035ef593c34664e66c2a1">decode</a>.<a class="code" href="structcore__knobs__t.html#8d76625a7e883234d3f1987860d0cbf2">max_uops</a>[0])
<a name="l00553"></a>00553         {
<a name="l00554"></a>00554           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#f74f8ee918a3458e8c6eeda7519f1967">commit_UROM_insn</a>++;)
<a name="l00555"></a>00555           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#392acd37d5938f3a2b2623edc443ee19">commit_UROM_uops</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#b63d1f53be60fd17e64b2e6fe22e6f3b">num_uops</a>;)
<a name="l00556"></a>00556           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#bf911fc8f2203830b120207411ea1260">commit_UROM_eff_uops</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#e76ae084a61689a2170b98ffd872a6a3">num_eff_uops</a>;)
<a name="l00557"></a>00557         }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6d36cc9bbc761b78f6147cf11a99b3a8">flow_count</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#b63d1f53be60fd17e64b2e6fe22e6f3b">num_uops</a>;
<a name="l00560"></a>00560         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#46957b4310b2a3cab7583bef08b2d94b">eff_flow_count</a> += Mop-&gt;<a class="code" href="structMop__t.html#42838437539e18e14b2049aa3ad512c2">stat</a>.<a class="code" href="structMop__t.html#e76ae084a61689a2170b98ffd872a6a3">num_eff_uops</a>;
<a name="l00561"></a>00561 
<a name="l00562"></a>00562         <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#068ff277465b6ed03aad00e96daccc62">fetch</a>.<a class="code" href="structMop__t.html#268a8bdf9dc08de70db61fbbdd52480d">inst</a>.<a class="code" href="structmd__inst__t.html#3cb7c4132587d2f78d978d951ab0eef7">rep</a>) <span class="comment">/* all iterations of a REP count as one macro-op! */</span>
<a name="l00563"></a>00563         {
<a name="l00564"></a>00564           <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#b435acfedb392843bc50658c7650cbdd">uop</a>[0].<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#075d4a905368cc1eeb377d2a41bd9c20">BOM</a>)
<a name="l00565"></a>00565           {
<a name="l00566"></a>00566             <a class="code" href="classcore__commit__DPM__t.html#072fde6e7911be1d94a2e5ef7ad1220e">when_rep_fetch_started</a> = Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#074734a2c4989bb09528dc993321a01b">when_fetch_started</a>;
<a name="l00567"></a>00567             <a class="code" href="classcore__commit__DPM__t.html#01091807e59a8234ae1e226f6c84b84c">when_rep_fetched</a> = Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#9e740f401f882c0173adc702cea64834">when_fetched</a>;
<a name="l00568"></a>00568             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#9e740f401f882c0173adc702cea64834">when_fetched</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>,(<span class="keywordtype">void</span>)0);
<a name="l00569"></a>00569             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#074734a2c4989bb09528dc993321a01b">when_fetch_started</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>,(<span class="keywordtype">void</span>)0);
<a name="l00570"></a>00570             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#9e740f401f882c0173adc702cea64834">when_fetched</a> != 0,(<span class="keywordtype">void</span>)0);
<a name="l00571"></a>00571             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#074734a2c4989bb09528dc993321a01b">when_fetch_started</a> != 0,(<span class="keywordtype">void</span>)0);
<a name="l00572"></a>00572             <a class="code" href="classcore__commit__DPM__t.html#010d8926bef914213586b5f07e01fa57">when_rep_decode_started</a> = Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#d07da636f69ae00564cc491a2efc2a95">when_decode_started</a>;
<a name="l00573"></a>00573             <a class="code" href="classcore__commit__DPM__t.html#41fa0a9ac8cb5a538d42c9a48fc1b4b2">when_rep_commit_started</a> = Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#bb62262ae07e9e18cb4869c709e366ad">when_commit_started</a>;
<a name="l00574"></a>00574           }
<a name="l00575"></a>00575           <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#b435acfedb392843bc50658c7650cbdd">uop</a>[Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#82638df3748d18d1c8c2e3d58d077a49">last_uop_index</a>].<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#be01a5d7b4a12d36d753ca8e295cceb6">EOM</a>)
<a name="l00576"></a>00576           {
<a name="l00577"></a>00577             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="zesto_2stats_8h.html#702503b8068fdcce1dc8712be9791d42">stat_add_sample</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#fedfecd010b8b8c8f91aac0e0e8700d6">flow_histo</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6d36cc9bbc761b78f6147cf11a99b3a8">flow_count</a>);)
<a name="l00578"></a>00578             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="zesto_2stats_8h.html#702503b8068fdcce1dc8712be9791d42">stat_add_sample</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b6a60a80d28dae8b4d70540af78fc0ba">eff_flow_histo</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#46957b4310b2a3cab7583bef08b2d94b">eff_flow_count</a>);)
<a name="l00579"></a>00579             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6d36cc9bbc761b78f6147cf11a99b3a8">flow_count</a> = 0;
<a name="l00580"></a>00580             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#46957b4310b2a3cab7583bef08b2d94b">eff_flow_count</a> = 0;
<a name="l00581"></a>00581 
<a name="l00582"></a>00582             <span class="keywordflow">if</span>(!Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#2ac0786c8628d0e7042cdc07a8d6fcdd">is_trap</a>)
<a name="l00583"></a>00583             {
<a name="l00584"></a>00584               <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a15f0041c9b3bed648185155199f5718">Mop_fetch_slip</a> += <a class="code" href="classcore__commit__DPM__t.html#01091807e59a8234ae1e226f6c84b84c">when_rep_fetched</a> - <a class="code" href="classcore__commit__DPM__t.html#072fde6e7911be1d94a2e5ef7ad1220e">when_rep_fetch_started</a>;)
<a name="l00585"></a>00585               <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b64f8c00b6daf64bb83abecc174be7a6">Mop_fetch2decode_slip</a> += <a class="code" href="classcore__commit__DPM__t.html#010d8926bef914213586b5f07e01fa57">when_rep_decode_started</a> - <a class="code" href="classcore__commit__DPM__t.html#01091807e59a8234ae1e226f6c84b84c">when_rep_fetched</a>;)
<a name="l00586"></a>00586               <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5b29d573d49d3e185fcf636cbd41d098">Mop_decode_slip</a> += Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#d1e4ae6820210aefb1091db30d72f2a8">when_decode_finished</a> - <a class="code" href="classcore__commit__DPM__t.html#010d8926bef914213586b5f07e01fa57">when_rep_decode_started</a>;) <span class="comment">/* from decode of first Mop's first uop to decode of last Mop's last uop */</span>
<a name="l00587"></a>00587               <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#519e564423324c4a9a81ed285d6b98a6">Mop_decode2commit_slip</a> += <a class="code" href="classcore__commit__DPM__t.html#41fa0a9ac8cb5a538d42c9a48fc1b4b2">when_rep_commit_started</a> - Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#d1e4ae6820210aefb1091db30d72f2a8">when_decode_finished</a>;)
<a name="l00588"></a>00588               <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#34d777376f04eeaeb7a930b8e3df9fdd">Mop_commit_slip</a> += Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#e1bbc6ef1aa73472c028b716fc3c5ef8">when_commit_finished</a> - <a class="code" href="classcore__commit__DPM__t.html#41fa0a9ac8cb5a538d42c9a48fc1b4b2">when_rep_commit_started</a>;)
<a name="l00589"></a>00589             }
<a name="l00590"></a>00590             <span class="keywordflow">else</span>
<a name="l00591"></a>00591               <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#e8807b9f2691c7f2f705541a69733514">commit_traps</a>++;)
<a name="l00592"></a>00592           }
<a name="l00593"></a>00593         }
<a name="l00594"></a>00594         <span class="keywordflow">else</span>
<a name="l00595"></a>00595         {
<a name="l00596"></a>00596           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="zesto_2stats_8h.html#702503b8068fdcce1dc8712be9791d42">stat_add_sample</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#fedfecd010b8b8c8f91aac0e0e8700d6">flow_histo</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6d36cc9bbc761b78f6147cf11a99b3a8">flow_count</a>);)
<a name="l00597"></a>00597           <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="zesto_2stats_8h.html#702503b8068fdcce1dc8712be9791d42">stat_add_sample</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b6a60a80d28dae8b4d70540af78fc0ba">eff_flow_histo</a>, <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#46957b4310b2a3cab7583bef08b2d94b">eff_flow_count</a>);)
<a name="l00598"></a>00598           <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#6d36cc9bbc761b78f6147cf11a99b3a8">flow_count</a> = 0;
<a name="l00599"></a>00599           <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#46957b4310b2a3cab7583bef08b2d94b">eff_flow_count</a> = 0;
<a name="l00600"></a>00600 
<a name="l00601"></a>00601           <span class="keywordflow">if</span>(!Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#2ac0786c8628d0e7042cdc07a8d6fcdd">is_trap</a>)
<a name="l00602"></a>00602           {
<a name="l00603"></a>00603             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a15f0041c9b3bed648185155199f5718">Mop_fetch_slip</a> += Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#9e740f401f882c0173adc702cea64834">when_fetched</a> - Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#074734a2c4989bb09528dc993321a01b">when_fetch_started</a>;)
<a name="l00604"></a>00604             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#b64f8c00b6daf64bb83abecc174be7a6">Mop_fetch2decode_slip</a> += Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#d07da636f69ae00564cc491a2efc2a95">when_decode_started</a> - Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#9e740f401f882c0173adc702cea64834">when_fetched</a>;)
<a name="l00605"></a>00605             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5b29d573d49d3e185fcf636cbd41d098">Mop_decode_slip</a> += Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#d1e4ae6820210aefb1091db30d72f2a8">when_decode_finished</a> - Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#d07da636f69ae00564cc491a2efc2a95">when_decode_started</a>;)
<a name="l00606"></a>00606             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#519e564423324c4a9a81ed285d6b98a6">Mop_decode2commit_slip</a> += Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#bb62262ae07e9e18cb4869c709e366ad">when_commit_started</a> - Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#d1e4ae6820210aefb1091db30d72f2a8">when_decode_finished</a>;)
<a name="l00607"></a>00607             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#34d777376f04eeaeb7a930b8e3df9fdd">Mop_commit_slip</a> += Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#e1bbc6ef1aa73472c028b716fc3c5ef8">when_commit_finished</a> - Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#bb62262ae07e9e18cb4869c709e366ad">when_commit_started</a>;)
<a name="l00608"></a>00608             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#e1bbc6ef1aa73472c028b716fc3c5ef8">when_commit_finished</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>,(<span class="keywordtype">void</span>)0);
<a name="l00609"></a>00609             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#9e740f401f882c0173adc702cea64834">when_fetched</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>,(<span class="keywordtype">void</span>)0);
<a name="l00610"></a>00610             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#074734a2c4989bb09528dc993321a01b">when_fetch_started</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>,(<span class="keywordtype">void</span>)0);
<a name="l00611"></a>00611             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#9e740f401f882c0173adc702cea64834">when_fetched</a> != 0,(<span class="keywordtype">void</span>)0);
<a name="l00612"></a>00612             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(Mop-&gt;<a class="code" href="structMop__t.html#7cbb20c576aa6fff6bfcbd39a074528f">timing</a>.<a class="code" href="structMop__t.html#074734a2c4989bb09528dc993321a01b">when_fetch_started</a> != 0,(<span class="keywordtype">void</span>)0);
<a name="l00613"></a>00613           }
<a name="l00614"></a>00614           <span class="keywordflow">else</span>
<a name="l00615"></a>00615             <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#e8807b9f2691c7f2f705541a69733514">commit_traps</a>++;)
<a name="l00616"></a>00616         }
<a name="l00617"></a>00617 <span class="preprocessor">#ifdef ZTRACE</span>
<a name="l00618"></a>00618 <span class="preprocessor"></span>        ztrace_print(Mop,<span class="stringliteral">"c|commit:EOM=%d:trap=%d|all uops in Mop committed; Mop retired"</span>,
<a name="l00619"></a>00619           Mop-&gt;<a class="code" href="structMop__t.html#b435acfedb392843bc50658c7650cbdd">uop</a>[Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#82638df3748d18d1c8c2e3d58d077a49">last_uop_index</a>].<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#be01a5d7b4a12d36d753ca8e295cceb6">EOM</a>,Mop-&gt;<a class="code" href="structMop__t.html#28058bfb31dd9263c008929f3c4f7f08">decode</a>.<a class="code" href="structMop__t.html#2ac0786c8628d0e7042cdc07a8d6fcdd">is_trap</a>);
<a name="l00620"></a>00620 <span class="preprocessor">#endif</span>
<a name="l00621"></a>00621 <span class="preprocessor"></span>        
<a name="l00622"></a>00622         <span class="comment">/* Let the oracle know that we are done with this Mop. */</span>
<a name="l00623"></a>00623         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#e4ae7e910eea6077916a780537d3210e">oracle</a>-&gt;<a class="code" href="classcore__oracle__t.html#5656906c0caee72b39f9d3760341de99">commit</a>(Mop);
<a name="l00624"></a>00624       }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626     }
<a name="l00627"></a>00627     <span class="keywordflow">else</span>
<a name="l00628"></a>00628     {
<a name="l00629"></a>00629       <span class="keywordflow">if</span>(Mop-&gt;<a class="code" href="structMop__t.html#77cff2eda77d17e84d903d3dedd6d0af">commit</a>.<a class="code" href="structMop__t.html#bf12e6ea4212ed366a436c76d7b72fad">complete_index</a> == 0)
<a name="l00630"></a>00630         stall_reason = <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb729cde678fb551ee86b8a506daa600cbb">CSTALL_NOT_READY</a>;
<a name="l00631"></a>00631       <span class="keywordflow">else</span>
<a name="l00632"></a>00632         stall_reason = <a class="code" href="classcore__commit__DPM__t.html#2e788743b94674175ffd1e5522b75bb7b33cb6d430a0f2a4841d42ba1fdcbc42">CSTALL_PARTIAL</a>;
<a name="l00633"></a>00633       <span class="keywordflow">break</span>; <span class="comment">/* oldest Mop not done yet */</span>
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635 
<a name="l00636"></a>00636     <span class="comment">/*****************/</span>
<a name="l00637"></a>00637     <span class="comment">/* finish early? */</span>
<a name="l00638"></a>00638     <span class="comment">/*****************/</span>
<a name="l00639"></a>00639     <span class="keywordflow">if</span>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#47c204871c8aecc186222de0093d15b9">active</a>)
<a name="l00640"></a>00640     {
<a name="l00641"></a>00641       <span class="keywordflow">if</span> ( ( <a class="code" href="zesto-opts_8h.html#6035d8c1e668819da7877cd4a7563686">max_cycles</a> &amp;&amp; <a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a> &gt;= <a class="code" href="zesto-opts_8h.html#6035d8c1e668819da7877cd4a7563686">max_cycles</a> ) ||
<a name="l00642"></a>00642            (<a class="code" href="zesto-opts_8h.html#1d6aa8acff6f54b92087f434a3a2b7a9">max_insts</a> &amp;&amp; <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#695be096dc6d4c3ef8dadfb9875a3c38">commit_insn</a> &gt;= <a class="code" href="zesto-opts_8h.html#1d6aa8acff6f54b92087f434a3a2b7a9">max_insts</a>) ||
<a name="l00643"></a>00643            (<a class="code" href="zesto-opts_8h.html#1c19194f53ec4ac28fd2ceb40ea00ef7">max_uops</a> &amp;&amp; <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#92a5adf70cb88182f89436f5be116715">commit_uops</a> &gt;= <a class="code" href="zesto-opts_8h.html#1c19194f53ec4ac28fd2ceb40ea00ef7">max_uops</a>)  )
<a name="l00644"></a>00644       {
<a name="l00645"></a>00645         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#5bdfc20ac509b4f10d9ac1b28f8c5a35">final_sim_cycle</a> = <a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a>; <span class="comment">/* make note of when this core stopped simulating */</span>
<a name="l00646"></a>00646         <span class="keywordflow">if</span>(<a class="code" href="zesto-opts_8h.html#6035d8c1e668819da7877cd4a7563686">max_cycles</a> &amp;&amp; <a class="code" href="sim-zesto_8cpp.html#d93be82106e505ae03e3a443a62d7238">sim_cycle</a> &gt;= <a class="code" href="zesto-opts_8h.html#6035d8c1e668819da7877cd4a7563686">max_cycles</a>)
<a name="l00647"></a>00647           fprintf(stderr,<span class="stringliteral">"# Simulation cycle "</span>);
<a name="l00648"></a>00648         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="zesto-opts_8h.html#1d6aa8acff6f54b92087f434a3a2b7a9">max_insts</a> &amp;&amp; <a class="code" href="zesto-opts_8h.html#1c19194f53ec4ac28fd2ceb40ea00ef7">max_uops</a>)
<a name="l00649"></a>00649           fprintf(stderr,<span class="stringliteral">"# Committed instruction/uop "</span>);
<a name="l00650"></a>00650         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="zesto-opts_8h.html#1d6aa8acff6f54b92087f434a3a2b7a9">max_insts</a>)
<a name="l00651"></a>00651           fprintf(stderr,<span class="stringliteral">"# Committed instruction "</span>);
<a name="l00652"></a>00652         <span class="keywordflow">else</span>
<a name="l00653"></a>00653           fprintf(stderr,<span class="stringliteral">"# Committed uop "</span>);
<a name="l00654"></a>00654         fprintf(stderr,<span class="stringliteral">"limit reached for core %d.\n"</span>,<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>);
<a name="l00655"></a>00655 
<a name="l00656"></a>00656         <a class="code" href="sim-zesto_8cpp.html#1b2701dab57f1ffb6459bbde33452d68">simulated_processes_remaining</a>--;
<a name="l00657"></a>00657         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#514a179d7ff004ee9a5c5167d90c2119">current_thread</a>-&gt;<a class="code" href="structthread__t.html#47c204871c8aecc186222de0093d15b9">active</a> = <span class="keyword">false</span>;
<a name="l00658"></a>00658         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#bb3b5f18fa768382f617bcdec3ee7d7e">fetch</a>-&gt;<a class="code" href="classcore__fetch__t.html#0dd5fd2d75f870de5fb95a496e3e6844">bpred</a>-&gt;<a class="code" href="classbpred__t.html#6ccd38354851e9913ad09445cd5bcd5e">freeze_stats</a>();
<a name="l00659"></a>00659         <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#2acb90ed74004297268411a80b742794">freeze_stats</a>();
<a name="l00660"></a>00660         <a class="code" href="config_2zesto-cache_8cpp.html#bd1fe8334f2259dc773b85f98c7fbcfa">cache_freeze_stats</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>);
<a name="l00661"></a>00661         <span class="comment">/* start this core over */</span>
<a name="l00662"></a>00662 
<a name="l00663"></a>00663         <span class="keywordflow">if</span>(<a class="code" href="sim-zesto_8cpp.html#1b2701dab57f1ffb6459bbde33452d68">simulated_processes_remaining</a> &lt;= 0)
<a name="l00664"></a>00664           longjmp(<a class="code" href="manifold__fullsim_8cc.html#84727c65b24d2e32fd3d4a7af53aa15a">sim_exit_buf</a>, <span class="comment">/* exitcode + fudge */</span>0 + 1);
<a name="l00665"></a>00665       }
<a name="l00666"></a>00666     }
<a name="l00667"></a>00667 
<a name="l00668"></a>00668     <span class="comment">/* Reset the trace (eio file input) if we've hit the end of the</span>
<a name="l00669"></a>00669 <span class="comment">       trace.  This is used in multi-core simulation mode to keep</span>
<a name="l00670"></a>00670 <span class="comment">       cores that have reached their simulation limits busy. */</span>
<a name="l00671"></a>00671     <span class="keywordflow">if</span> (<a class="code" href="zesto-opts_8h.html#7f085ab1f80062bcfa4b9086e934c007">trace_limit</a> &amp;&amp; (<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a41c519bf86d69b41a84c7253bf14276">eio_commit_insn</a> &gt;= <a class="code" href="zesto-opts_8h.html#7f085ab1f80062bcfa4b9086e934c007">trace_limit</a>))
<a name="l00672"></a>00672     {
<a name="l00673"></a>00673       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#a41c519bf86d69b41a84c7253bf14276">eio_commit_insn</a> = 0;
<a name="l00674"></a>00674       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#e4ae7e910eea6077916a780537d3210e">oracle</a>-&gt;<a class="code" href="classcore__oracle__t.html#cd307b32aa377a56b3f4dc79b2122038">reset_execution</a>();
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676   }
<a name="l00677"></a>00677 
<a name="l00678"></a>00678   <a class="code" href="zesto-opts_8h.html#225a9a02a0c5a33775f2743a37dfd8d8">ZESTO_STAT</a>(<a class="code" href="zesto_2stats_8h.html#702503b8068fdcce1dc8712be9791d42">stat_add_sample</a>(<a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd66018e0e0529be576f673452a032df">stat</a>.<a class="code" href="structcore__t_1_1core__stat__t.html#9aa1b782d670256448505543248b88dd">commit_stall</a>, (<span class="keywordtype">int</span>)stall_reason);)
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 
<a name="l00681"></a>00681 <span class="comment">/* Walk ROB from youngest uop until we find the requested Mop.</span>
<a name="l00682"></a>00682 <span class="comment">   (NOTE: We stop at any uop belonging to the Mop.  We assume</span>
<a name="l00683"></a>00683 <span class="comment">   that recovery only occurs on Mop boundaries.)</span>
<a name="l00684"></a>00684 <span class="comment">   Release resources (PREGs, RS/ROB/LSQ entries, etc. as we go).</span>
<a name="l00685"></a>00685 <span class="comment">   If Mop == NULL, we're blowing away the entire pipeline. */</span>
<a name="l00686"></a>00686 <span class="keywordtype">void</span>
<a name="l00687"></a><a class="code" href="classcore__commit__DPM__t.html#15b00a68dd968c3fbfa365c85ec1b3d5">00687</a> <a class="code" href="classcore__commit__DPM__t.html#b0ca7c01d6c22c55f529bd9cec7a809b">core_commit_DPM_t::recover</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structMop__t.html">Mop_t</a> * <span class="keyword">const</span> <a class="code" href="structuop__t.html#5752c48ff1454c5c470509db2fa46b7a">Mop</a>)
<a name="l00688"></a>00688 {
<a name="l00689"></a>00689   assert(Mop != NULL);
<a name="l00690"></a>00690   <span class="keyword">struct </span><a class="code" href="structcore__knobs__t.html">core_knobs_t</a> * <a class="code" href="sim-zesto_8cpp.html#89a180011adecec49b08c8ef843388fa">knobs</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#a397a3f36f045e3c2a19dafc16dab1c1">knobs</a>;
<a name="l00691"></a>00691   <span class="keywordflow">if</span>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &gt; 0)
<a name="l00692"></a>00692   {
<a name="l00693"></a>00693     <span class="comment">/* requested uop should always be in the ROB */</span>
<a name="l00694"></a>00694     <span class="keywordtype">int</span> index = <a class="code" href="misc_8h.html#e72918bfe3eb9d02e83975f2739a7ab2">moddec</a>(<a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a>,knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>); <span class="comment">//(ROB_tail-1+knobs-&gt;commit.ROB_size) % knobs-&gt;commit.ROB_size;</span>
<a name="l00695"></a>00695 
<a name="l00696"></a>00696     <span class="comment">/* if there's only the one inst in the pipe, then we don't need to drain */</span>
<a name="l00697"></a>00697     <span class="keywordflow">if</span>(knobs-&gt;<a class="code" href="structcore__knobs__t.html#59dbf024a4199a4119773f12776f2e06">alloc</a>.<a class="code" href="structcore__knobs__t.html#e660d28db7f277e66f88c1560fd9da62">drain_flush</a> &amp;&amp; (<a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index]-&gt;<a class="code" href="structuop__t.html#5752c48ff1454c5c470509db2fa46b7a">Mop</a> != Mop))
<a name="l00698"></a>00698       <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#20394b8c7a44d5ad56a16e9cd635299e">alloc</a>-&gt;<a class="code" href="classcore__alloc__t.html#1b26b1159897c2dc2ca5a04380190632">start_drain</a>();
<a name="l00699"></a>00699 
<a name="l00700"></a>00700     <span class="keywordflow">while</span>(<a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index] &amp;&amp; (<a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index]-&gt;Mop != Mop))
<a name="l00701"></a>00701     {
<a name="l00702"></a>00702       <span class="keywordtype">int</span> i;
<a name="l00703"></a>00703       <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * dead_uop = <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index];
<a name="l00704"></a>00704 
<a name="l00705"></a>00705       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &gt; 0,(<span class="keywordtype">void</span>)0);
<a name="l00706"></a>00706 
<a name="l00707"></a>00707       <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#831dde25d8ef14de7a0c73bc3a5fa3c9">in_fusion</a>)
<a name="l00708"></a>00708       {
<a name="l00709"></a>00709         <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#e915e589eff078d3f108ff4d45ed216c">is_fusion_head</a>,(<span class="keywordtype">void</span>)0);
<a name="l00710"></a>00710         <span class="keywordflow">while</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a>)
<a name="l00711"></a>00711           dead_uop = dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a>;
<a name="l00712"></a>00712         <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(dead_uop != dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#430e0f4aeb84fac91fc04ae7d31b5329">fusion_head</a>,(<span class="keywordtype">void</span>)0);
<a name="l00713"></a>00713       }
<a name="l00714"></a>00714 
<a name="l00715"></a>00715       <span class="keywordflow">while</span>(dead_uop)
<a name="l00716"></a>00716       {
<a name="l00717"></a>00717         <span class="comment">/* squash this instruction - this invalidates all in-flight actions (e.g., uop execution, cache accesses) */</span>
<a name="l00718"></a>00718         dead_uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#47dc4af18b603fd6693da3d213ff3298">action_id</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#110f33d959a11c403fb9166326c7e5f3">new_action_id</a>();
<a name="l00719"></a>00719         <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>)
<a name="l00720"></a>00720           <a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a>--;
<a name="l00721"></a>00721 
<a name="l00722"></a>00722         <span class="comment">/* update allocation scoreboard if appropriate */</span>
<a name="l00723"></a>00723         <span class="comment">/* if(uop-&gt;alloc.RS_index != -1) */</span><span class="comment">/* fusion messes up this check */</span>
<a name="l00724"></a>00724         <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#6a823830b3496618e63ce4486f60fe8c">when_exec</a> == <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a> &amp;&amp; (dead_uop-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#09b2c63be80dd4e8800c1b59d0155b8e">port_assignment</a> != -1))
<a name="l00725"></a>00725           <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#20394b8c7a44d5ad56a16e9cd635299e">alloc</a>-&gt;<a class="code" href="classcore__alloc__t.html#5be5ea812a0a42bf67a1e307acf0dbd8">RS_deallocate</a>(dead_uop);
<a name="l00726"></a>00726 
<a name="l00727"></a>00727         <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#8d3f920949e75a969f27530e48001e43">RS_index</a> != -1) <span class="comment">/* currently in RS */</span>
<a name="l00728"></a>00728           <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#40b90ec949055afd7525ef3fc9592658">RS_deallocate</a>(dead_uop);
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 
<a name="l00731"></a>00731         <span class="comment">/* In the following, we have to check it the uop has even been allocated yet... this has</span>
<a name="l00732"></a>00732 <span class="comment">           to do with our non-atomic implementation of allocation for fused-uops */</span>
<a name="l00733"></a>00733         <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#fd9cc07575e4452cb5192588691e6814">is_load</a>)
<a name="l00734"></a>00734         {
<a name="l00735"></a>00735           <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>)
<a name="l00736"></a>00736             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#e89588e67823a1240158658814d3fa9c">LDQ_squash</a>(dead_uop);
<a name="l00737"></a>00737         }
<a name="l00738"></a>00738         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#85d4bc293425ae1bcd322b314414ce1b">is_std</a>) <span class="comment">/* dealloc when we get to the STA */</span>
<a name="l00739"></a>00739         {
<a name="l00740"></a>00740           <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>)
<a name="l00741"></a>00741             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#73339072a45e69a11de1f5e0d58f7b37">STQ_squash_std</a>(dead_uop);
<a name="l00742"></a>00742         }
<a name="l00743"></a>00743         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#eec85d8cffdbdff59e335df7cf38174a">is_sta</a>)
<a name="l00744"></a>00744         {
<a name="l00745"></a>00745           <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>)
<a name="l00746"></a>00746             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#2741e7d8d06e54281c7f5eb3603f8e91">STQ_squash_sta</a>(dead_uop);
<a name="l00747"></a>00747         }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749         <span class="comment">/* clean up idep/odep pointers.  Since we're working our</span>
<a name="l00750"></a>00750 <span class="comment">           way back from the most speculative instruction, we only</span>
<a name="l00751"></a>00751 <span class="comment">           need to clean-up our parent's forward-pointers (odeps)</span>
<a name="l00752"></a>00752 <span class="comment">           and our own back-pointers (our fwd-ptrs would have</span>
<a name="l00753"></a>00753 <span class="comment">           already cleaned-up our own children). */</span>
<a name="l00754"></a>00754         <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="zesto-structs_8h.html#dfffbd8f2596b46b6777c263be9e5a23">MAX_IDEPS</a>;i++)
<a name="l00755"></a>00755         {
<a name="l00756"></a>00756           <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * parent = dead_uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#e941cb97551b1b6f4205334d2c23fbc4">idep_uop</a>[i];
<a name="l00757"></a>00757           <span class="keywordflow">if</span>(parent) <span class="comment">/* I have an active parent */</span>
<a name="l00758"></a>00758           {
<a name="l00759"></a>00759             <span class="keyword">struct </span><a class="code" href="structodep__t.html">odep_t</a> * prev, * current;
<a name="l00760"></a>00760             prev = NULL;
<a name="l00761"></a>00761             current = parent-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#26d4b1db6fdef492b6f61b9624455f7c">odep_uop</a>;
<a name="l00762"></a>00762             <span class="keywordflow">while</span>(current)
<a name="l00763"></a>00763             {
<a name="l00764"></a>00764               <span class="keywordflow">if</span>((current-&gt;<a class="code" href="structodep__t.html#4870c3718dfdc8a6ac81f2455e8e7b60">uop</a> == dead_uop) &amp;&amp; (current-&gt;<a class="code" href="structodep__t.html#a9047cb0f60d68673900ec2fd18b2263">op_num</a> == i))
<a name="l00765"></a>00765                 <span class="keywordflow">break</span>;
<a name="l00766"></a>00766               prev = current;
<a name="l00767"></a>00767               current = current-&gt;<a class="code" href="structodep__t.html#a696a50e030a95db3b98795875dcd908">next</a>;
<a name="l00768"></a>00768             }
<a name="l00769"></a>00769 
<a name="l00770"></a>00770             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(current,(<span class="keywordtype">void</span>)0);
<a name="l00771"></a>00771 
<a name="l00772"></a>00772             <span class="comment">/* remove self from parent's odep list */</span>
<a name="l00773"></a>00773             <span class="keywordflow">if</span>(prev)
<a name="l00774"></a>00774               prev-&gt;<a class="code" href="structodep__t.html#a696a50e030a95db3b98795875dcd908">next</a> = current-&gt;<a class="code" href="structodep__t.html#a696a50e030a95db3b98795875dcd908">next</a>;
<a name="l00775"></a>00775             <span class="keywordflow">else</span>
<a name="l00776"></a>00776               parent-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#26d4b1db6fdef492b6f61b9624455f7c">odep_uop</a> = current-&gt;<a class="code" href="structodep__t.html#a696a50e030a95db3b98795875dcd908">next</a>;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778             <span class="comment">/* eliminate my own idep */</span>
<a name="l00779"></a>00779             dead_uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#e941cb97551b1b6f4205334d2c23fbc4">idep_uop</a>[i] = NULL;
<a name="l00780"></a>00780 
<a name="l00781"></a>00781             <span class="comment">/* return the odep struct */</span>
<a name="l00782"></a>00782             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#c76899d81828f8557930f9ab87f4938e">return_odep_link</a>(current);
<a name="l00783"></a>00783           }
<a name="l00784"></a>00784         }
<a name="l00785"></a>00785 
<a name="l00786"></a>00786         <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(dead_uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#26d4b1db6fdef492b6f61b9624455f7c">odep_uop</a> == NULL,(<span class="keywordtype">void</span>)0);
<a name="l00787"></a>00787 
<a name="l00788"></a>00788         <span class="keywordflow">if</span>((!dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#831dde25d8ef14de7a0c73bc3a5fa3c9">in_fusion</a>) || dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#e915e589eff078d3f108ff4d45ed216c">is_fusion_head</a>)
<a name="l00789"></a>00789           dead_uop = NULL;
<a name="l00790"></a>00790         <span class="keywordflow">else</span>
<a name="l00791"></a>00791         {
<a name="l00792"></a>00792           <span class="comment">/* this is ugly... need to traverse fused uop linked-list</span>
<a name="l00793"></a>00793 <span class="comment">             in reverse; most fused uops are short, so we're just</span>
<a name="l00794"></a>00794 <span class="comment">             going to re-traverse... if longer fused uops are</span>
<a name="l00795"></a>00795 <span class="comment">             supported, it may make sense to implement a</span>
<a name="l00796"></a>00796 <span class="comment">             doubly-linked list instead. */</span>
<a name="l00797"></a>00797           <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * p = <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index];
<a name="l00798"></a>00798           <span class="keywordflow">while</span>(p-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a> != dead_uop)
<a name="l00799"></a>00799             p = p-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a>;
<a name="l00800"></a>00800 
<a name="l00801"></a>00801           dead_uop = p;
<a name="l00802"></a>00802         }
<a name="l00803"></a>00803       }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805       <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index] = NULL;
<a name="l00806"></a>00806       <a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a> = <a class="code" href="misc_8h.html#e72918bfe3eb9d02e83975f2739a7ab2">moddec</a>(<a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a>,knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>); <span class="comment">//(ROB_tail-1+knobs-&gt;commit.ROB_size) % knobs-&gt;commit.ROB_size;</span>
<a name="l00807"></a>00807       <a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> --;
<a name="l00808"></a>00808       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &gt;= 0,(<span class="keywordtype">void</span>)0);
<a name="l00809"></a>00809       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(<a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a> &gt;= 0,(<span class="keywordtype">void</span>)0);
<a name="l00810"></a>00810 
<a name="l00811"></a>00811       index = <a class="code" href="misc_8h.html#e72918bfe3eb9d02e83975f2739a7ab2">moddec</a>(index,knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>); <span class="comment">//(index-1+knobs-&gt;commit.ROB_size) % knobs-&gt;commit.ROB_size;</span>
<a name="l00812"></a>00812     }
<a name="l00813"></a>00813   }
<a name="l00814"></a>00814 }
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 <span class="keywordtype">void</span>
<a name="l00817"></a><a class="code" href="classcore__commit__DPM__t.html#b0ca7c01d6c22c55f529bd9cec7a809b">00817</a> <a class="code" href="classcore__commit__DPM__t.html#b0ca7c01d6c22c55f529bd9cec7a809b">core_commit_DPM_t::recover</a>(<span class="keywordtype">void</span>)
<a name="l00818"></a>00818 {
<a name="l00819"></a>00819   <span class="keyword">struct </span><a class="code" href="structcore__knobs__t.html">core_knobs_t</a> * <a class="code" href="sim-zesto_8cpp.html#89a180011adecec49b08c8ef843388fa">knobs</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#a397a3f36f045e3c2a19dafc16dab1c1">knobs</a>;
<a name="l00820"></a>00820   <span class="keywordflow">if</span>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &gt; 0)
<a name="l00821"></a>00821   {
<a name="l00822"></a>00822     <span class="comment">/* requested uop should always be in the ROB */</span>
<a name="l00823"></a>00823     <span class="keywordtype">int</span> index = <a class="code" href="misc_8h.html#e72918bfe3eb9d02e83975f2739a7ab2">moddec</a>(<a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a>,knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>); <span class="comment">//(ROB_tail-1+knobs-&gt;commit.ROB_size) % knobs-&gt;commit.ROB_size;</span>
<a name="l00824"></a>00824 
<a name="l00825"></a>00825     <span class="keywordflow">while</span>(<a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index])
<a name="l00826"></a>00826     {
<a name="l00827"></a>00827       <span class="keywordtype">int</span> i;
<a name="l00828"></a>00828       <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * dead_uop = <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index];
<a name="l00829"></a>00829 
<a name="l00830"></a>00830       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &gt; 0,(<span class="keywordtype">void</span>)0);
<a name="l00831"></a>00831 
<a name="l00832"></a>00832       <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#831dde25d8ef14de7a0c73bc3a5fa3c9">in_fusion</a>)
<a name="l00833"></a>00833       {
<a name="l00834"></a>00834         <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#e915e589eff078d3f108ff4d45ed216c">is_fusion_head</a>,(<span class="keywordtype">void</span>)0);
<a name="l00835"></a>00835         <span class="keywordflow">while</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a>)
<a name="l00836"></a>00836           dead_uop = dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a>;
<a name="l00837"></a>00837         <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(dead_uop != dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#430e0f4aeb84fac91fc04ae7d31b5329">fusion_head</a>,(<span class="keywordtype">void</span>)0);
<a name="l00838"></a>00838       }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840       <span class="keywordflow">while</span>(dead_uop)
<a name="l00841"></a>00841       {
<a name="l00842"></a>00842         <span class="comment">/* squash this instruction - this invalidates all in-flight actions (e.g., uop execution, cache accesses) */</span>
<a name="l00843"></a>00843         dead_uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#47dc4af18b603fd6693da3d213ff3298">action_id</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#110f33d959a11c403fb9166326c7e5f3">new_action_id</a>();
<a name="l00844"></a>00844         <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>)
<a name="l00845"></a>00845           <a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a>--;
<a name="l00846"></a>00846 
<a name="l00847"></a>00847         <span class="comment">/* update allocation scoreboard if appropriate */</span>
<a name="l00848"></a>00848         <span class="comment">/* if(uop-&gt;alloc.RS_index != -1) */</span>
<a name="l00849"></a>00849         <span class="comment">/* fusion messes up this check */</span>
<a name="l00850"></a>00850         <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#6a823830b3496618e63ce4486f60fe8c">when_exec</a> == <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a> &amp;&amp; (dead_uop-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#09b2c63be80dd4e8800c1b59d0155b8e">port_assignment</a> != -1))
<a name="l00851"></a>00851           <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#20394b8c7a44d5ad56a16e9cd635299e">alloc</a>-&gt;<a class="code" href="classcore__alloc__t.html#5be5ea812a0a42bf67a1e307acf0dbd8">RS_deallocate</a>(dead_uop);
<a name="l00852"></a>00852 
<a name="l00853"></a>00853         <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#8d3f920949e75a969f27530e48001e43">RS_index</a> != -1) <span class="comment">/* currently in RS */</span>
<a name="l00854"></a>00854           <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#40b90ec949055afd7525ef3fc9592658">RS_deallocate</a>(dead_uop);
<a name="l00855"></a>00855 
<a name="l00856"></a>00856 
<a name="l00857"></a>00857         <span class="comment">/* In the following, we have to check it the uop has even</span>
<a name="l00858"></a>00858 <span class="comment">           been allocated yet... this has to do with our non-atomic</span>
<a name="l00859"></a>00859 <span class="comment">           implementation of allocation for fused-uops */</span>
<a name="l00860"></a>00860         <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#fd9cc07575e4452cb5192588691e6814">is_load</a>)
<a name="l00861"></a>00861         {
<a name="l00862"></a>00862           <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>)
<a name="l00863"></a>00863             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#e89588e67823a1240158658814d3fa9c">LDQ_squash</a>(dead_uop);
<a name="l00864"></a>00864         }
<a name="l00865"></a>00865         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#85d4bc293425ae1bcd322b314414ce1b">is_std</a>) <span class="comment">/* dealloc when we get to the STA */</span>
<a name="l00866"></a>00866         {
<a name="l00867"></a>00867           <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>)
<a name="l00868"></a>00868             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#73339072a45e69a11de1f5e0d58f7b37">STQ_squash_std</a>(dead_uop);
<a name="l00869"></a>00869         }
<a name="l00870"></a>00870         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#eec85d8cffdbdff59e335df7cf38174a">is_sta</a>)
<a name="l00871"></a>00871         {
<a name="l00872"></a>00872           <span class="keywordflow">if</span>(dead_uop-&gt;<a class="code" href="structuop__t.html#b61a7ea0dc1ac39e3e55da42e98454f0">timing</a>.<a class="code" href="structuop__t.html#826f35ba23d6193e5bfb44bddb3dabc9">when_allocated</a> != <a class="code" href="host_8h.html#d6479e80718c30aee08a7e9cc5cf9668">TICK_T_MAX</a>)
<a name="l00873"></a>00873             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#2741e7d8d06e54281c7f5eb3603f8e91">STQ_squash_sta</a>(dead_uop);
<a name="l00874"></a>00874         }
<a name="l00875"></a>00875 
<a name="l00876"></a>00876         <span class="comment">/* clean up idep/odep pointers.  Since we're working our</span>
<a name="l00877"></a>00877 <span class="comment">           way back from the most speculative instruction, we only</span>
<a name="l00878"></a>00878 <span class="comment">           need to clean-up our parent's forward-pointers (odeps)</span>
<a name="l00879"></a>00879 <span class="comment">           and our own back-pointers (our fwd-ptrs would have</span>
<a name="l00880"></a>00880 <span class="comment">           already cleaned-up our own children). */</span>
<a name="l00881"></a>00881         <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="zesto-structs_8h.html#dfffbd8f2596b46b6777c263be9e5a23">MAX_IDEPS</a>;i++)
<a name="l00882"></a>00882         {
<a name="l00883"></a>00883           <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * parent = dead_uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#e941cb97551b1b6f4205334d2c23fbc4">idep_uop</a>[i];
<a name="l00884"></a>00884           <span class="keywordflow">if</span>(parent) <span class="comment">/* I have an active parent */</span>
<a name="l00885"></a>00885           {
<a name="l00886"></a>00886             <span class="keyword">struct </span><a class="code" href="structodep__t.html">odep_t</a> * prev, * current;
<a name="l00887"></a>00887             prev = NULL;
<a name="l00888"></a>00888             current = parent-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#26d4b1db6fdef492b6f61b9624455f7c">odep_uop</a>;
<a name="l00889"></a>00889             <span class="keywordflow">while</span>(current)
<a name="l00890"></a>00890             {
<a name="l00891"></a>00891               <span class="keywordflow">if</span>((current-&gt;<a class="code" href="structodep__t.html#4870c3718dfdc8a6ac81f2455e8e7b60">uop</a> == dead_uop) &amp;&amp; (current-&gt;<a class="code" href="structodep__t.html#a9047cb0f60d68673900ec2fd18b2263">op_num</a> == i))
<a name="l00892"></a>00892                 <span class="keywordflow">break</span>;
<a name="l00893"></a>00893               prev = current;
<a name="l00894"></a>00894               current = current-&gt;<a class="code" href="structodep__t.html#a696a50e030a95db3b98795875dcd908">next</a>;
<a name="l00895"></a>00895             }
<a name="l00896"></a>00896 
<a name="l00897"></a>00897             <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(current,(<span class="keywordtype">void</span>)0);
<a name="l00898"></a>00898 
<a name="l00899"></a>00899             <span class="comment">/* remove self from parent's odep list */</span>
<a name="l00900"></a>00900             <span class="keywordflow">if</span>(prev)
<a name="l00901"></a>00901               prev-&gt;<a class="code" href="structodep__t.html#a696a50e030a95db3b98795875dcd908">next</a> = current-&gt;<a class="code" href="structodep__t.html#a696a50e030a95db3b98795875dcd908">next</a>;
<a name="l00902"></a>00902             <span class="keywordflow">else</span>
<a name="l00903"></a>00903               parent-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#26d4b1db6fdef492b6f61b9624455f7c">odep_uop</a> = current-&gt;<a class="code" href="structodep__t.html#a696a50e030a95db3b98795875dcd908">next</a>;
<a name="l00904"></a>00904 
<a name="l00905"></a>00905             <span class="comment">/* eliminate my own idep */</span>
<a name="l00906"></a>00906             dead_uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#e941cb97551b1b6f4205334d2c23fbc4">idep_uop</a>[i] = NULL;
<a name="l00907"></a>00907 
<a name="l00908"></a>00908             <span class="comment">/* return the odep struct */</span>
<a name="l00909"></a>00909             <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#c76899d81828f8557930f9ab87f4938e">return_odep_link</a>(current);
<a name="l00910"></a>00910           }
<a name="l00911"></a>00911         }
<a name="l00912"></a>00912 
<a name="l00913"></a>00913         <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(dead_uop-&gt;<a class="code" href="structuop__t.html#effc0bd8baf056d9abde991743af3cc3">exec</a>.<a class="code" href="structuop__t.html#26d4b1db6fdef492b6f61b9624455f7c">odep_uop</a> == NULL,(<span class="keywordtype">void</span>)0);
<a name="l00914"></a>00914 
<a name="l00915"></a>00915         <span class="keywordflow">if</span>((!dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#831dde25d8ef14de7a0c73bc3a5fa3c9">in_fusion</a>) || dead_uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#e915e589eff078d3f108ff4d45ed216c">is_fusion_head</a>)
<a name="l00916"></a>00916           dead_uop = NULL;
<a name="l00917"></a>00917         <span class="keywordflow">else</span>
<a name="l00918"></a>00918         {
<a name="l00919"></a>00919           <span class="comment">/* this is ugly... need to traverse fused uop linked-list</span>
<a name="l00920"></a>00920 <span class="comment">             in reverse; most fused uops are short, so we're just</span>
<a name="l00921"></a>00921 <span class="comment">             going to retraverse... if longer fused uops are</span>
<a name="l00922"></a>00922 <span class="comment">             supported, it may make sense to implement a</span>
<a name="l00923"></a>00923 <span class="comment">             doubly-linked list instead. */</span>
<a name="l00924"></a>00924           <span class="keyword">struct </span><a class="code" href="structuop__t.html">uop_t</a> * p = <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index];
<a name="l00925"></a>00925           <span class="keywordflow">while</span>(p-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a> != dead_uop)
<a name="l00926"></a>00926             p = p-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#17e765e3d22399396fbe31aab97cdf06">fusion_next</a>;
<a name="l00927"></a>00927 
<a name="l00928"></a>00928           dead_uop = p;
<a name="l00929"></a>00929         }
<a name="l00930"></a>00930       }
<a name="l00931"></a>00931 
<a name="l00932"></a>00932       <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[index] = NULL;
<a name="l00933"></a>00933       <a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a> = <a class="code" href="misc_8h.html#e72918bfe3eb9d02e83975f2739a7ab2">moddec</a>(<a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a>,knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>); <span class="comment">//(ROB_tail-1+knobs-&gt;commit.ROB_size) % knobs-&gt;commit.ROB_size;</span>
<a name="l00934"></a>00934       <a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> --;
<a name="l00935"></a>00935       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &gt;= 0,(<span class="keywordtype">void</span>)0);
<a name="l00936"></a>00936       <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(<a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a> &gt;= 0,(<span class="keywordtype">void</span>)0);
<a name="l00937"></a>00937 
<a name="l00938"></a>00938       index = <a class="code" href="misc_8h.html#e72918bfe3eb9d02e83975f2739a7ab2">moddec</a>(index,knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>); <span class="comment">//(index-1+knobs-&gt;commit.ROB_size) % knobs-&gt;commit.ROB_size;</span>
<a name="l00939"></a>00939     }
<a name="l00940"></a>00940   }
<a name="l00941"></a>00941 
<a name="l00942"></a>00942   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#58c23da8566bbc08e23f6a61c9859f59">STQ_squash_senior</a>();
<a name="l00943"></a>00943 
<a name="l00944"></a>00944   <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#fd8831061ddb119a3abe035f7a482b55">exec</a>-&gt;<a class="code" href="classcore__exec__t.html#b8d15b77bc3cb1d7da22b25c864ebab2">recover_check_assertions</a>();
<a name="l00945"></a>00945   <a class="code" href="zesto-oracle_8h.html#4f942292a4c30024a9b7fe4f9b1820a4">zesto_assert</a>(<a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> == 0,(<span class="keywordtype">void</span>)0);
<a name="l00946"></a>00946 }
<a name="l00947"></a>00947 
<a name="l00948"></a><a class="code" href="classcore__commit__DPM__t.html#eba764df3f73e22de74685b52976bd14">00948</a> <span class="keywordtype">bool</span> <a class="code" href="classcore__commit__DPM__t.html#eba764df3f73e22de74685b52976bd14">core_commit_DPM_t::ROB_available</a>(<span class="keywordtype">void</span>)
<a name="l00949"></a>00949 {
<a name="l00950"></a>00950   <span class="keyword">struct </span><a class="code" href="structcore__knobs__t.html">core_knobs_t</a> * <a class="code" href="sim-zesto_8cpp.html#89a180011adecec49b08c8ef843388fa">knobs</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#a397a3f36f045e3c2a19dafc16dab1c1">knobs</a>;
<a name="l00951"></a>00951   <span class="keywordflow">return</span> <a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a> &lt; knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>;
<a name="l00952"></a>00952 }
<a name="l00953"></a>00953 
<a name="l00954"></a><a class="code" href="classcore__commit__DPM__t.html#42a6e65fd798bfb75b5a036efd9e4ae1">00954</a> <span class="keywordtype">bool</span> <a class="code" href="classcore__commit__DPM__t.html#42a6e65fd798bfb75b5a036efd9e4ae1">core_commit_DPM_t::ROB_empty</a>(<span class="keywordtype">void</span>)
<a name="l00955"></a>00955 {
<a name="l00956"></a>00956   <span class="keywordflow">return</span> 0 == <a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a>;
<a name="l00957"></a>00957 }
<a name="l00958"></a>00958 
<a name="l00959"></a><a class="code" href="classcore__commit__DPM__t.html#0bce05d30731b67e31f691bf95f87851">00959</a> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#0bce05d30731b67e31f691bf95f87851">core_commit_DPM_t::ROB_insert</a>(<span class="keyword">struct</span> <a class="code" href="structuop__t.html">uop_t</a> * <span class="keyword">const</span> uop)
<a name="l00960"></a>00960 {
<a name="l00961"></a>00961   <span class="keyword">struct </span><a class="code" href="structcore__knobs__t.html">core_knobs_t</a> * <a class="code" href="sim-zesto_8cpp.html#89a180011adecec49b08c8ef843388fa">knobs</a> = <a class="code" href="classcore__commit__t.html#d56ace13088d783b83e8ac19744d2064">core</a>-&gt;<a class="code" href="classcore__t.html#a397a3f36f045e3c2a19dafc16dab1c1">knobs</a>;
<a name="l00962"></a>00962   <a class="code" href="classcore__commit__DPM__t.html#278cf60521965a4d7c8461e150923171">ROB</a>[<a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a>] = uop;
<a name="l00963"></a>00963   uop-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#e66802928ecce35d60f0495dee0a4ae7">ROB_index</a> = <a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a>;
<a name="l00964"></a>00964   <a class="code" href="classcore__commit__DPM__t.html#424e7e3d0aae69fe63ea78d62ab8de3b">ROB_num</a>++;
<a name="l00965"></a>00965   <a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a>++;
<a name="l00966"></a>00966   <a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a> = <a class="code" href="misc_8h.html#ec0decc56f83415e5cd152f876e5dde1">modinc</a>(<a class="code" href="classcore__commit__DPM__t.html#f5a7e2b1bc8484d728128bbc83fbe340">ROB_tail</a>,knobs-&gt;<a class="code" href="structcore__knobs__t.html#2b7876a4f411b3ae2041c14a7cae699e">commit</a>.<a class="code" href="structcore__knobs__t.html#8648564800ae0fe984ac1f418deace94">ROB_size</a>); <span class="comment">//(ROB_tail+1) % knobs-&gt;commit.ROB_size;</span>
<a name="l00967"></a>00967 }
<a name="l00968"></a>00968 
<a name="l00969"></a><a class="code" href="classcore__commit__DPM__t.html#a8e1a57946e18f029d405718664a4b54">00969</a> <span class="keywordtype">void</span> <a class="code" href="classcore__commit__DPM__t.html#a8e1a57946e18f029d405718664a4b54">core_commit_DPM_t::ROB_fuse_insert</a>(<span class="keyword">struct</span> <a class="code" href="structuop__t.html">uop_t</a> * <span class="keyword">const</span> uop)
<a name="l00970"></a>00970 {
<a name="l00971"></a>00971   uop-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#e66802928ecce35d60f0495dee0a4ae7">ROB_index</a> = uop-&gt;<a class="code" href="structuop__t.html#c42cc8544fd53bb8513c3aabef62c13b">decode</a>.<a class="code" href="structuop__t.html#430e0f4aeb84fac91fc04ae7d31b5329">fusion_head</a>-&gt;<a class="code" href="structuop__t.html#6f62c942e5cb41dfcf20a650a32fcc6b">alloc</a>.<a class="code" href="structuop__t.html#e66802928ecce35d60f0495dee0a4ae7">ROB_index</a>;
<a name="l00972"></a>00972   <a class="code" href="classcore__commit__DPM__t.html#7271d8dd3aae01ff5d72811b1da2300e">ROB_eff_num</a>++;
<a name="l00973"></a>00973 }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 23 00:20:56 2010 for IRIS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
