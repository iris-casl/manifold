<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>IRIS: bus_handler.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_014faa727c0b2aaba2cbdd8f326de4f6.html">source</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_d8734cd78c62b720986516d0af0d7d96.html">memctrl</a>
  </div>
</div>
<div class="contents">
<h1>bus_handler.cc</h1><a href="bus__handler_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * =====================================================================================</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> *       Filename:  bus_handler.cc</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> *    Description:  </span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> *        Version:  1.0</span>
<a name="l00009"></a>00009 <span class="comment"> *        Created:  02/18/2010 11:48:34 AM</span>
<a name="l00010"></a>00010 <span class="comment"> *       Revision:  none</span>
<a name="l00011"></a>00011 <span class="comment"> *       Compiler:  gcc</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> *         Author:  Mitchelle Rasquinha (), mitchelle.rasquinha@gatech.edu</span>
<a name="l00014"></a>00014 <span class="comment"> *        Company:  Georgia Institute of Technology</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * =====================================================================================</span>
<a name="l00017"></a>00017 <span class="comment"> */</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include "<a class="code" href="bus__handler_8h.html">bus_handler.h</a>"</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include "<a class="code" href="request__handler_8h.html">request_handler.h</a>"</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include "<a class="code" href="bus_8h.html">bus.h</a>"</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="keyword">using namespace </span>std;
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="comment">/*</span>
<a name="l00027"></a>00027 <span class="comment"> *--------------------------------------------------------------------------------------</span>
<a name="l00028"></a>00028 <span class="comment"> *       Class:  BusHandler</span>
<a name="l00029"></a>00029 <span class="comment"> *      Method:  BusHandler</span>
<a name="l00030"></a>00030 <span class="comment"> * Description:  constructor</span>
<a name="l00031"></a>00031 <span class="comment"> *--------------------------------------------------------------------------------------</span>
<a name="l00032"></a>00032 <span class="comment"> */</span>
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="classBusHandler.html#8e0f1cd4cc53c51152413eb19a0a5c63">00034</a> <a class="code" href="classBusHandler.html#8e0f1cd4cc53c51152413eb19a0a5c63">BusHandler::BusHandler</a>()
<a name="l00035"></a>00035 {
<a name="l00036"></a>00036     <a class="code" href="classBusHandler.html#4a132b59f5b4e15f316d3bb3409c6ff0">oneReq</a>.resize(<a class="code" href="mc__constants_8h.html#c60f68d55e472737b2890684e0d41ab9">NO_OF_CHANNELS</a>);
<a name="l00037"></a>00037     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="mc__constants_8h.html#c60f68d55e472737b2890684e0d41ab9">NO_OF_CHANNELS</a>; i++)
<a name="l00038"></a>00038         <a class="code" href="classBusHandler.html#4a132b59f5b4e15f316d3bb3409c6ff0">oneReq</a>[i].resize(<a class="code" href="config__constants_8h.html#e1acef1609deca0291eaf30593109d17">NO_OF_RANKS</a>);
<a name="l00039"></a>00039     
<a name="l00040"></a>00040     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;NO_OF_CHANNELS; i++)
<a name="l00041"></a>00041         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="config__constants_8h.html#e1acef1609deca0291eaf30593109d17">NO_OF_RANKS</a>; j++)
<a name="l00042"></a>00042             <a class="code" href="classBusHandler.html#4a132b59f5b4e15f316d3bb3409c6ff0">oneReq</a>[i][j].resize(<a class="code" href="config__constants_8h.html#a9a8bc812122b9b1129824fdea80e872">NO_OF_BANKS</a>);
<a name="l00043"></a>00043 
<a name="l00044"></a>00044     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;NO_OF_CHANNELS; i++)
<a name="l00045"></a>00045     {
<a name="l00046"></a>00046         <a class="code" href="classBusHandler.html#2fe96733417204a2a206c1f2522b3c5b">full</a>[i] = <span class="keyword">false</span>;
<a name="l00047"></a>00047         <a class="code" href="classBusHandler.html#9200377626ca177f01880335ccc0101e">stopSignal</a> = <span class="keyword">false</span>;
<a name="l00048"></a>00048         <a class="code" href="classBusHandler.html#24b8ef732b4bf23223bfcae98053f8ae">linkBusy</a>[i] = <span class="keyword">false</span>;    
<a name="l00049"></a>00049         <a class="code" href="classBusHandler.html#be8960744c8252a6e87e16cb4e053c27">cmdIssuer</a>[i].<a class="code" href="classCmdIssuer.html#5e1ed2ce5508ea4bd898bbc6f46fd8ba">parent</a> = (<a class="code" href="classComponent.html">Component</a>*)<span class="keyword">this</span>;
<a name="l00050"></a>00050         <a class="code" href="classBusHandler.html#be8960744c8252a6e87e16cb4e053c27">cmdIssuer</a>[i].<a class="code" href="classCmdIssuer.html#cac87f00286cca7f0a03dce0542f6fde">Id</a> = i;
<a name="l00051"></a>00051         <a class="code" href="classBusHandler.html#be8960744c8252a6e87e16cb4e053c27">cmdIssuer</a>[i].<a class="code" href="classCmdIssuer.html#5349d862a11425e1feeb656149341352">bufferId</a> = i;
<a name="l00052"></a>00052         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;NO_OF_RANKS; j++)
<a name="l00053"></a>00053         {
<a name="l00054"></a>00054             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="config__constants_8h.html#a9a8bc812122b9b1129824fdea80e872">NO_OF_BANKS</a>; k++)
<a name="l00055"></a>00055             {
<a name="l00056"></a>00056                 <a class="code" href="classBusHandler.html#4a132b59f5b4e15f316d3bb3409c6ff0">oneReq</a>[i][j][k] = <span class="keyword">false</span>;
<a name="l00057"></a>00057             }
<a name="l00058"></a>00058         }
<a name="l00059"></a>00059     }
<a name="l00060"></a>00060 }
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/*</span>
<a name="l00063"></a>00063 <span class="comment"> *--------------------------------------------------------------------------------------</span>
<a name="l00064"></a>00064 <span class="comment"> *       Class:  BusHandler</span>
<a name="l00065"></a>00065 <span class="comment"> *      Method:  ~BusHandler</span>
<a name="l00066"></a>00066 <span class="comment"> * Description:  destructor</span>
<a name="l00067"></a>00067 <span class="comment"> *--------------------------------------------------------------------------------------</span>
<a name="l00068"></a>00068 <span class="comment"> */</span>
<a name="l00069"></a><a class="code" href="classBusHandler.html#4167c4a5b3fed2e3c90dfb55ae051d38">00069</a> <a class="code" href="classBusHandler.html#4167c4a5b3fed2e3c90dfb55ae051d38">BusHandler::~BusHandler</a>()
<a name="l00070"></a>00070 {
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 }
<a name="l00073"></a>00073 
<a name="l00074"></a><a class="code" href="classBusHandler.html#892d4aa770091924a43ee446848db5e5">00074</a> std::string <a class="code" href="classBusHandler.html#892d4aa770091924a43ee446848db5e5">BusHandler::toString</a>()
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076         <span class="keywordflow">return</span> <span class="stringliteral">"BusHandler"</span>;
<a name="l00077"></a>00077 }
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="classBusHandler.html#ec754a189e4f6fe2a4644691e80c3891">00079</a> <span class="keywordtype">void</span> <a class="code" href="classBusHandler.html#ec754a189e4f6fe2a4644691e80c3891">BusHandler::SetIfFull</a>()
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="mc__constants_8h.html#c60f68d55e472737b2890684e0d41ab9">NO_OF_CHANNELS</a>; i++)
<a name="l00082"></a>00082     {   
<a name="l00083"></a>00083         <span class="keywordflow">if</span> (<a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[i].size() &gt;= <a class="code" href="config__constants_8h.html#7b3f5203e83ae79d6e9c365f6286dc97">MAX_CMD_BUFFER_SIZE</a>-2)
<a name="l00084"></a>00084             <a class="code" href="classBusHandler.html#2fe96733417204a2a206c1f2522b3c5b">full</a>[i] = <span class="keyword">true</span>;
<a name="l00085"></a>00085         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classBusHandler.html#9200377626ca177f01880335ccc0101e">stopSignal</a>)
<a name="l00086"></a>00086             <a class="code" href="classBusHandler.html#2fe96733417204a2a206c1f2522b3c5b">full</a>[i] = <span class="keyword">false</span>;    
<a name="l00087"></a>00087     }   
<a name="l00088"></a>00088 }
<a name="l00089"></a><a class="code" href="classBusHandler.html#c0ecf6b699545c251b6f75bbea68c2f2">00089</a> <span class="keywordtype">bool</span> <a class="code" href="classBusHandler.html#c0ecf6b699545c251b6f75bbea68c2f2">BusHandler::IsFull</a>(<span class="keywordtype">int</span> i)
<a name="l00090"></a>00090 {
<a name="l00091"></a>00091     <span class="keywordflow">return</span> <a class="code" href="classBusHandler.html#2fe96733417204a2a206c1f2522b3c5b">full</a>[i];
<a name="l00092"></a>00092 }
<a name="l00093"></a><a class="code" href="classBusHandler.html#08661b7c676ea61de65a76a615e2d8e0">00093</a> <span class="keywordtype">bool</span> <a class="code" href="classBusHandler.html#08661b7c676ea61de65a76a615e2d8e0">BusHandler::BankRankFree</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bankNo, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rankNo, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channelNo)
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095     <span class="keywordflow">return</span> !<a class="code" href="classBusHandler.html#4a132b59f5b4e15f316d3bb3409c6ff0">oneReq</a>[channelNo][rankNo][bankNo];
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="classBusHandler.html#2b8cd5f4be39270cf6abd4e6a64d45d0">00098</a> <span class="keywordtype">void</span> <a class="code" href="classBusHandler.html#2b8cd5f4be39270cf6abd4e6a64d45d0">BusHandler::LowLevelCmdGen</a>(<a class="code" href="classRequest.html" title="The main data structure for each memory operation that flows in the memory controller...">Request</a> *req)
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100     <a class="code" href="structDRAMCmdState.html">DRAMCmdState</a> cmdState;      
<a name="l00101"></a>00101     <a class="code" href="structDRAMCmdState.html">DRAMCmdState</a> cmdState2;
<a name="l00102"></a>00102     <a class="code" href="structDRAMCmdState.html">DRAMCmdState</a> cmdState3;     
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="keywordflow">switch</span> (<a class="code" href="config__constants_8h.html#9b7e9850a84a1625ba61689a4c8b7686">dram_page_policy</a>)
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106   <span class="keywordflow">case</span> <a class="code" href="config__constants_8h.html#02b5ad5e16eaacab3c36f43c6acfcd90438d37ce8f9a1cede22242b06ea8dd6d">OPEN_PAGE_POLICY</a>:
<a name="l00107"></a>00107   {
<a name="l00108"></a>00108     <span class="keywordflow">if</span> (req-&gt;<a class="code" href="classRequest.html#35b354c58fc167256a37d5e553fcbda9" title="The type of cmd (read(load), write(store), writeback, prefetch) coming from the cache...">cmdType</a> == <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb2551418c4911c72f0c5ae1eed401facb41a">REFRESH</a>)
<a name="l00109"></a>00109     {
<a name="l00110"></a>00110         cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af1f3d28bfdcf36bc1a1fdebe21670ee317">ALL_BANK_REFRESH</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044050d1448013c6f17125caee18aa418af7">NORMAL</a>,*req);
<a name="l00111"></a>00111         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="mc__constants_8h.html#c60f68d55e472737b2890684e0d41ab9">NO_OF_CHANNELS</a>; i++)
<a name="l00112"></a>00112             <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[i].push_back(cmdState);
<a name="l00113"></a>00113     }
<a name="l00114"></a>00114     <span class="keywordflow">else</span>
<a name="l00115"></a>00115     {
<a name="l00116"></a>00116         <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="classRequest.html#48599e50c349bc0a36d886a24a7e578e" title="Signal to indicate the request is a hit or conflict.">status</a>)
<a name="l00117"></a>00117         {
<a name="l00118"></a>00118             <span class="keywordflow">case</span> <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf00e0143636c29971736eab47415868eae">OPEN</a>:
<a name="l00119"></a>00119                   <span class="keywordflow">break</span>;  
<a name="l00120"></a>00120             <span class="keywordflow">case</span> <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf0929f0327e17604ce9713b2a6117bd603">CLOSED</a>:
<a name="l00121"></a>00121                   cmdState2.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af19a25989a7678e52c9900c88a81fb18d3">ACTIVATE</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044050d1448013c6f17125caee18aa418af7">NORMAL</a>,*req);
<a name="l00122"></a>00122                   <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[req-&gt;<a class="code" href="classRequest.html#08d39ad8a398f52881062f2adf382b54">channelNo</a>].push_back(cmdState2);        
<a name="l00123"></a>00123                   <span class="keywordflow">break</span>;
<a name="l00124"></a>00124             <span class="keywordflow">case</span> <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf03124eeef4801cbb117a96b9e4a0d7eb7">CONFLICT</a>:
<a name="l00125"></a>00125                   cmdState3.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af19d4d157d6a0a8dd2d28ed2284d4d3ec6">PRECHARGE</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044050d1448013c6f17125caee18aa418af7">NORMAL</a>,*req);
<a name="l00126"></a>00126                   <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[req-&gt;<a class="code" href="classRequest.html#08d39ad8a398f52881062f2adf382b54">channelNo</a>].push_back(cmdState3);
<a name="l00127"></a>00127                   cmdState2.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af19a25989a7678e52c9900c88a81fb18d3">ACTIVATE</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044050d1448013c6f17125caee18aa418af7">NORMAL</a>,*req);
<a name="l00128"></a>00128                   <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[req-&gt;<a class="code" href="classRequest.html#08d39ad8a398f52881062f2adf382b54">channelNo</a>].push_back(cmdState2);
<a name="l00129"></a>00129                   <span class="keywordflow">break</span>;
<a name="l00130"></a>00130             <span class="keywordflow">case</span> <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf0fd6a0e4343048b10646dd2976cc5ad18">IDLE</a>:
<a name="l00131"></a>00131                   cout &lt;&lt; <span class="stringliteral">"why I came in IDLE in CmdGen??"</span> &lt;&lt; endl;
<a name="l00132"></a>00132                   <span class="keywordflow">break</span>;
<a name="l00133"></a>00133             <span class="keywordflow">default</span>:
<a name="l00134"></a>00134                   cout &lt;&lt; <span class="stringliteral">"I cannot came in default of request status in CmdGen??"</span> &lt;&lt; endl;
<a name="l00135"></a>00135                   <span class="keywordflow">break</span>;
<a name="l00136"></a>00136         }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <span class="keywordflow">if</span> (req-&gt;<a class="code" href="classRequest.html#48599e50c349bc0a36d886a24a7e578e" title="Signal to indicate the request is a hit or conflict.">status</a> == <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf00e0143636c29971736eab47415868eae">OPEN</a> || req-&gt;<a class="code" href="classRequest.html#48599e50c349bc0a36d886a24a7e578e" title="Signal to indicate the request is a hit or conflict.">status</a> == <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf0929f0327e17604ce9713b2a6117bd603">CLOSED</a> || req-&gt;<a class="code" href="classRequest.html#48599e50c349bc0a36d886a24a7e578e" title="Signal to indicate the request is a hit or conflict.">status</a> == <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf03124eeef4801cbb117a96b9e4a0d7eb7">CONFLICT</a>)
<a name="l00139"></a>00139         {
<a name="l00140"></a>00140             <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="classRequest.html#35b354c58fc167256a37d5e553fcbda9" title="The type of cmd (read(load), write(store), writeback, prefetch) coming from the cache...">cmdType</a>)
<a name="l00141"></a>00141             {
<a name="l00142"></a>00142                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb255a614c7f88fbcfcc7dc4e5e9fd697f585">CACHE_READ</a>: 
<a name="l00143"></a>00143                       cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af1cb9be765f361bb7efb9073730aac92c6">READ</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b4004406d086721853c328d7d9052c2b66a5118">READL</a>,*req);
<a name="l00144"></a>00144                       <span class="keywordflow">break</span>;
<a name="l00145"></a>00145                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb255f31232fbf9e45b41922cf68b09a4a201">CACHE_WRITE</a>:
<a name="l00146"></a>00146                       cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af1cb9be765f361bb7efb9073730aac92c6">READ</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044035f0763ba91158c66aab8bd6feaa3ec1">WRITEL</a>,*req);
<a name="l00147"></a>00147                       <span class="keywordflow">break</span>;
<a name="l00148"></a>00148                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb25532d220872fec4028b8b25e094c84837c">CACHE_WRITEBACK</a>:
<a name="l00149"></a>00149                       cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af161aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b4004400d95d20a06bbdfd25a649592a8d7c12b">WRITEBACKL</a>,*req);
<a name="l00150"></a>00150                       <span class="keywordflow">break</span>;
<a name="l00151"></a>00151                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb25537348416545a4253a253b1a4371e6ccf">CACHE_PREFETCH</a>:
<a name="l00152"></a>00152                       cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af1cb9be765f361bb7efb9073730aac92c6">READ</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b400440af4e0aeef5e1629777f124878ba23471">PREFETCHL</a>,*req);
<a name="l00153"></a>00153                       <span class="keywordflow">break</span>;
<a name="l00154"></a>00154                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb2551418c4911c72f0c5ae1eed401facb41a">REFRESH</a>:
<a name="l00155"></a>00155                       cout &lt;&lt; <span class="stringliteral">"should not come to refresh\n"</span>;
<a name="l00156"></a>00156                       <span class="keywordflow">break</span>;
<a name="l00157"></a>00157                 <span class="keywordflow">default</span>: 
<a name="l00158"></a>00158                       <span class="keywordflow">break</span>;
<a name="l00159"></a>00159             }   
<a name="l00160"></a>00160             <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[req-&gt;<a class="code" href="classRequest.html#08d39ad8a398f52881062f2adf382b54">channelNo</a>].push_back(cmdState);
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163     <span class="keywordflow">break</span>;
<a name="l00164"></a>00164   }
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="keywordflow">case</span> <a class="code" href="config__constants_8h.html#02b5ad5e16eaacab3c36f43c6acfcd9029c3f4e40ff3e9a39e81f11d7d11ee68">CLOSE_PAGE_POLICY</a>:
<a name="l00167"></a>00167   {
<a name="l00168"></a>00168     <span class="keywordflow">if</span> (req-&gt;<a class="code" href="classRequest.html#35b354c58fc167256a37d5e553fcbda9" title="The type of cmd (read(load), write(store), writeback, prefetch) coming from the cache...">cmdType</a> == <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb2551418c4911c72f0c5ae1eed401facb41a">REFRESH</a>)
<a name="l00169"></a>00169     {
<a name="l00170"></a>00170         cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af1f3d28bfdcf36bc1a1fdebe21670ee317">ALL_BANK_REFRESH</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044050d1448013c6f17125caee18aa418af7">NORMAL</a>,*req);
<a name="l00171"></a>00171         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="mc__constants_8h.html#c60f68d55e472737b2890684e0d41ab9">NO_OF_CHANNELS</a>; i++)
<a name="l00172"></a>00172             <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[i].push_back(cmdState);
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174     <span class="keywordflow">else</span>
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176           cmdState2.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af19a25989a7678e52c9900c88a81fb18d3">ACTIVATE</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044050d1448013c6f17125caee18aa418af7">NORMAL</a>,*req);
<a name="l00177"></a>00177           <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[req-&gt;<a class="code" href="classRequest.html#08d39ad8a398f52881062f2adf382b54">channelNo</a>].push_back(cmdState2);        
<a name="l00178"></a>00178 
<a name="l00179"></a>00179         <span class="keywordflow">if</span> (req-&gt;<a class="code" href="classRequest.html#48599e50c349bc0a36d886a24a7e578e" title="Signal to indicate the request is a hit or conflict.">status</a> == <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf00e0143636c29971736eab47415868eae">OPEN</a> || req-&gt;<a class="code" href="classRequest.html#48599e50c349bc0a36d886a24a7e578e" title="Signal to indicate the request is a hit or conflict.">status</a> == <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf0929f0327e17604ce9713b2a6117bd603">CLOSED</a> || req-&gt;<a class="code" href="classRequest.html#48599e50c349bc0a36d886a24a7e578e" title="Signal to indicate the request is a hit or conflict.">status</a> == <a class="code" href="request_8h.html#8d135869d04d8d8c55c0e45752845cf03124eeef4801cbb117a96b9e4a0d7eb7">CONFLICT</a>)
<a name="l00180"></a>00180         {
<a name="l00181"></a>00181             <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="classRequest.html#35b354c58fc167256a37d5e553fcbda9" title="The type of cmd (read(load), write(store), writeback, prefetch) coming from the cache...">cmdType</a>)
<a name="l00182"></a>00182             {
<a name="l00183"></a>00183                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb255a614c7f88fbcfcc7dc4e5e9fd697f585">CACHE_READ</a>: 
<a name="l00184"></a>00184                       cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af1cb9be765f361bb7efb9073730aac92c6">READ</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b4004406d086721853c328d7d9052c2b66a5118">READL</a>,*req);
<a name="l00185"></a>00185                       <span class="keywordflow">break</span>;
<a name="l00186"></a>00186                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb255f31232fbf9e45b41922cf68b09a4a201">CACHE_WRITE</a>:
<a name="l00187"></a>00187                       cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af1cb9be765f361bb7efb9073730aac92c6">READ</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044035f0763ba91158c66aab8bd6feaa3ec1">WRITEL</a>,*req);
<a name="l00188"></a>00188                       <span class="keywordflow">break</span>;
<a name="l00189"></a>00189                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb25532d220872fec4028b8b25e094c84837c">CACHE_WRITEBACK</a>:
<a name="l00190"></a>00190                       cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af161aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b4004400d95d20a06bbdfd25a649592a8d7c12b">WRITEBACKL</a>,*req);
<a name="l00191"></a>00191                       <span class="keywordflow">break</span>;
<a name="l00192"></a>00192                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb25537348416545a4253a253b1a4371e6ccf">CACHE_PREFETCH</a>:
<a name="l00193"></a>00193                       cmdState.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af1cb9be765f361bb7efb9073730aac92c6">READ</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b400440af4e0aeef5e1629777f124878ba23471">PREFETCHL</a>,*req);
<a name="l00194"></a>00194                       <span class="keywordflow">break</span>;
<a name="l00195"></a>00195                 <span class="keywordflow">case</span> <a class="code" href="config_2zesto-cache_8h.html#aa2f5ac205a00e5df606ccf951edb2551418c4911c72f0c5ae1eed401facb41a">REFRESH</a>:
<a name="l00196"></a>00196                       cout &lt;&lt; <span class="stringliteral">"should not come to refresh\n"</span>;
<a name="l00197"></a>00197                       <span class="keywordflow">break</span>;
<a name="l00198"></a>00198                 <span class="keywordflow">default</span>: 
<a name="l00199"></a>00199                       <span class="keywordflow">break</span>;
<a name="l00200"></a>00200             }   
<a name="l00201"></a>00201             <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[req-&gt;<a class="code" href="classRequest.html#08d39ad8a398f52881062f2adf382b54">channelNo</a>].push_back(cmdState);
<a name="l00202"></a>00202             cmdState3.<a class="code" href="structDRAMCmdState.html#901fee4ee232a13830c3705ab9c514cc">set</a>(<a class="code" href="cmd__issuer_8h.html#a04b28724f7b03d4f96d73f228348af19d4d157d6a0a8dd2d28ed2284d4d3ec6">PRECHARGE</a>,<a class="code" href="cmd__issuer_8h.html#5a39718eef659ba9081830c39b40044050d1448013c6f17125caee18aa418af7">NORMAL</a>,*req);
<a name="l00203"></a>00203             <a class="code" href="classBusHandler.html#a2fcdc7c7117ee34c79ca742dab2a595">cmdQueue</a>[req-&gt;<a class="code" href="classRequest.html#08d39ad8a398f52881062f2adf382b54">channelNo</a>].push_back(cmdState3);
<a name="l00204"></a>00204         }
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206     <span class="keywordflow">break</span>;
<a name="l00207"></a>00207   }
<a name="l00208"></a>00208   <span class="keywordflow">default</span>:
<a name="l00209"></a>00209   {
<a name="l00210"></a>00210       cout &lt;&lt; <span class="stringliteral">"Wrong page policy in bus"</span> &lt;&lt; endl;
<a name="l00211"></a>00211       exit(1);
<a name="l00212"></a>00212   }
<a name="l00213"></a>00213 }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 23 00:20:56 2010 for IRIS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
