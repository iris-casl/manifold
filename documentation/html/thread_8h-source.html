<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>IRIS: thread.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_014faa727c0b2aaba2cbdd8f326de4f6.html">source</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_4516642e80adc9bf50ea604a2fbf2492.html">zesto</a>
  </div>
</div>
<div class="contents">
<h1>thread.h</h1><a href="thread_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef ARCH_CPU_INCLUDED</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define ARCH_CPU_INCLUDED</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "<a class="code" href="machine_8h.html">machine.h</a>"</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include "<a class="code" href="memory_8h.html">memory.h</a>"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="regs_8h.html">regs.h</a>"</span>
<a name="l00007"></a>00007 
<a name="l00008"></a><a class="code" href="thread_8h.html#3e8bd7832d770102979335a24585c78f">00008</a> <span class="preprocessor">#define BOOT_PC  0x00000000     </span><span class="comment">/*PC where each thread starts at boot up*/</span>
<a name="l00009"></a>00009 
<a name="l00010"></a><a class="code" href="structthread__t.html">00010</a> <span class="keyword">struct </span><a class="code" href="structthread__t.html">thread_t</a> {
<a name="l00011"></a>00011 
<a name="l00012"></a><a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">00012</a>   <span class="keywordtype">int</span> <a class="code" href="structthread__t.html#96d4de2e7317c46b7f55f1ca2ef6a350">id</a>;                    <span class="comment">/* unique ID for each thread */</span>
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="structthread__t.html#fe142c06b5866f3f0c7cecdcb09dd4b2">00014</a>   <span class="keywordtype">int</span> <a class="code" href="structthread__t.html#fe142c06b5866f3f0c7cecdcb09dd4b2">current_core</a>;          <span class="comment">/* id of current core this thread is running on */</span>
<a name="l00015"></a>00015 
<a name="l00016"></a><a class="code" href="structthread__t.html#5a5007f71bf42d78ac7305cd30f7dd3f">00016</a>   <span class="keyword">struct </span><a class="code" href="structmem__t.html">mem_t</a> *<a class="code" href="structthread__t.html#5a5007f71bf42d78ac7305cd30f7dd3f">mem</a>;         <span class="comment">/* simulated virtual memory */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="structthread__t.html#91103da0506a0127e32ad580eef763f2">00018</a>   <span class="keyword">struct </span><a class="code" href="structregs__t.html">regs_t</a> <a class="code" href="structthread__t.html#91103da0506a0127e32ad580eef763f2">regs</a>;        <span class="comment">/* simulated registers */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="structthread__t.html#2b2709c2f5cc8eb7d9c87c8cc4e62b5d">00020</a>   FILE *<a class="code" href="structthread__t.html#2b2709c2f5cc8eb7d9c87c8cc4e62b5d">pin_trace</a>;      <span class="comment">/*File decriptor for traces generated by PIN*/</span>
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="structthread__t.html#e98de5d835e817cbeac9cc573ef5e30d">00022</a>   <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> * <a class="code" href="structthread__t.html#e98de5d835e817cbeac9cc573ef5e30d">ldt_p</a>;
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="structthread__t.html#d907b780c1717ccfc70ddc4c6f56d17b">00024</a>   <span class="keywordtype">int</span> <a class="code" href="structthread__t.html#d907b780c1717ccfc70ddc4c6f56d17b">rep_sequence</a>;          <span class="comment">/* for implementing REP instructions */</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026   <span class="keyword">struct </span>{
<a name="l00027"></a><a class="code" href="structthread__t.html#36571a5c9c6d6454f4e5627037f886ed">00027</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#36571a5c9c6d6454f4e5627037f886ed">text_base</a>;     <span class="comment">/* program text (code) segment base */</span>
<a name="l00028"></a><a class="code" href="structthread__t.html#7fc99de8048e941778c53de3f733aed9">00028</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#7fc99de8048e941778c53de3f733aed9">text_bound</a>;    <span class="comment">/* program text (code) segment bound */</span>
<a name="l00029"></a><a class="code" href="structthread__t.html#706e6e5c74792b2c5a20ee69b504c7db">00029</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structthread__t.html#706e6e5c74792b2c5a20ee69b504c7db">text_size</a>;  <span class="comment">/* program text (code) size in bytes */</span>
<a name="l00030"></a><a class="code" href="structthread__t.html#c441bcf5fa5936c0146e500ceba852b5">00030</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#c441bcf5fa5936c0146e500ceba852b5">data_base</a>;     <span class="comment">/* program initialized data segment base */</span>
<a name="l00031"></a><a class="code" href="structthread__t.html#8a33131270eda03bab8714241edb44b3">00031</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#8a33131270eda03bab8714241edb44b3">data_bound</a>;    <span class="comment">/* program initialized data segment bound */</span>
<a name="l00032"></a><a class="code" href="structthread__t.html#9e668c7ba65c996e9f6175fb95199bea">00032</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#9e668c7ba65c996e9f6175fb95199bea">brk_point</a>;     <span class="comment">/* top of the data segment */</span>
<a name="l00033"></a><a class="code" href="structthread__t.html#5ab70f5887949085e78b37f367d3e79c">00033</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structthread__t.html#5ab70f5887949085e78b37f367d3e79c">data_size</a>;  <span class="comment">/* program initialized ".data" and uninitialized ".bss" size in bytes */</span>
<a name="l00034"></a><a class="code" href="structthread__t.html#43ed6f4ff6654b32c1f2c51ee9bd5c0c">00034</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#43ed6f4ff6654b32c1f2c51ee9bd5c0c">stack_base</a>;    <span class="comment">/* program stack segment base (highest address in stack) */</span>
<a name="l00035"></a><a class="code" href="structthread__t.html#74eafa6a2f3dbcef60499e781c5ee524">00035</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structthread__t.html#74eafa6a2f3dbcef60499e781c5ee524">stack_size</a>; <span class="comment">/* program initial stack size */</span>
<a name="l00036"></a><a class="code" href="structthread__t.html#61cec3b38f6d5b3f349792b3b2953f3d">00036</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#61cec3b38f6d5b3f349792b3b2953f3d">stack_min</a>;     <span class="comment">/* lowest address accessed on the stack */</span>
<a name="l00037"></a><a class="code" href="structthread__t.html#8221672d9c28579298ee6c4e6a571036">00037</a>     <span class="keywordtype">char</span> *<a class="code" href="structthread__t.html#8221672d9c28579298ee6c4e6a571036">prog_fname</a>;        <span class="comment">/* program file name */</span>
<a name="l00038"></a><a class="code" href="structthread__t.html#90fa56619db7fcad03dc391e24d61ade">00038</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#90fa56619db7fcad03dc391e24d61ade">prog_entry</a>;    <span class="comment">/* program entry point (initial PC) */</span>
<a name="l00039"></a><a class="code" href="structthread__t.html#70742c9de3b34df4630fb7930617987b">00039</a>     <a class="code" href="machine_8h.html#fba784f22c1d8233f95c4f4db103018a">md_addr_t</a> <a class="code" href="structthread__t.html#70742c9de3b34df4630fb7930617987b">environ_base</a>;  <span class="comment">/* program environment base address address */</span>
<a name="l00040"></a><a class="code" href="structthread__t.html#4c798d0344a67cbb7a457c177fa6c8bf">00040</a>     <span class="keywordtype">int</span> <a class="code" href="structthread__t.html#4c798d0344a67cbb7a457c177fa6c8bf">target_big_endian</a>;   <span class="comment">/* target executable endian-ness, non-zero if big endian */</span>
<a name="l00041"></a>00041   } <a class="code" href="structthread__t.html#07734cbe5f64b48d7f77dc9c36ca42a6">loader</a>;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043   <span class="keyword">struct </span>{
<a name="l00044"></a><a class="code" href="structthread__t.html#f868fe7453e104d71cbe7cd80248a451">00044</a>     <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="structthread__t.html#f868fe7453e104d71cbe7cd80248a451">num_insn</a>;
<a name="l00045"></a><a class="code" href="structthread__t.html#732f09c6857f2306c5948129fb77d698">00045</a>     <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="structthread__t.html#732f09c6857f2306c5948129fb77d698">num_refs</a>;
<a name="l00046"></a><a class="code" href="structthread__t.html#f169c1f51d54e1d3547b7e4ac24efcbd">00046</a>     <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="structthread__t.html#f169c1f51d54e1d3547b7e4ac24efcbd">num_loads</a>;
<a name="l00047"></a><a class="code" href="structthread__t.html#48a033989c53df8b551a79be22772a3a">00047</a>     <a class="code" href="host_8h.html#14de020ee0096509154b24721dbc901a">counter_t</a> <a class="code" href="structthread__t.html#48a033989c53df8b551a79be22772a3a">num_branches</a>;
<a name="l00048"></a>00048   } <a class="code" href="structthread__t.html#9ec7f775f2b8390dc4088ee1c40d9cc3">stat</a>;
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#ifdef __cpluplus</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> <a class="code" href="structthread__t.html#47c204871c8aecc186222de0093d15b9">active</a>; <span class="comment">/* FALSE if this core has hit its max-inst/uop limit */</span>
<a name="l00052"></a>00052 <span class="preprocessor">#else</span>
<a name="l00053"></a><a class="code" href="structthread__t.html#47c204871c8aecc186222de0093d15b9">00053</a> <span class="preprocessor"></span>  <span class="keywordtype">int</span> <a class="code" href="structthread__t.html#47c204871c8aecc186222de0093d15b9">active</a>;
<a name="l00054"></a>00054 <span class="preprocessor">#endif</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>};
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">/* architected state for each simulated thread/process */</span>
<a name="l00058"></a>00058 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structthread__t.html">thread_t</a> ** <a class="code" href="sim-zesto_8cpp.html#f227be61b1f91b71aafae105501d92f7">threads</a>;
<a name="l00059"></a>00059 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="sim-zesto_8cpp.html#26a8352e9cd3bc9a6a35bc8d88152985">num_threads</a>;
<a name="l00060"></a>00060 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="sim-zesto_8cpp.html#1b2701dab57f1ffb6459bbde33452d68">simulated_processes_remaining</a>;
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/* load program into simulated state; returns 1 if program is an eio trace */</span>
<a name="l00063"></a>00063 <span class="keywordtype">int</span> <a class="code" href="thread_8h.html#524226e93ca6adccd26acb04ba5f00e8">sim_load_prog</a>(<span class="keyword">struct</span> <a class="code" href="structthread__t.html">thread_t</a> * thread,  <span class="comment">/* target thread */</span>
<a name="l00064"></a>00064                    <span class="keywordtype">char</span> *fname,              <span class="comment">/* program to load */</span>
<a name="l00065"></a>00065                    <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv,    <span class="comment">/* program arguments */</span>
<a name="l00066"></a>00066                    <span class="keywordtype">char</span> **envp               <span class="comment">/* program environment */</span>
<a name="l00067"></a>00067                   );
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="comment">/* print simulator-specific configuration information */</span>
<a name="l00070"></a>00070 <span class="keywordtype">void</span> <a class="code" href="sim-zesto_8cpp.html#67e5d7a21600d2eb1fb2f0798fc24a7c">sim_aux_config</a>(FILE *stream);
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="comment">/* dump simulator-specific auxiliary simulator statistics */</span>
<a name="l00073"></a>00073 <span class="keywordtype">void</span> <a class="code" href="sim-zesto_8cpp.html#f0d3b44eaaad1fd53b38c9f82deb05fd">sim_aux_stats</a>(FILE *stream);
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="comment">/* un-initialize simulator-specific state */</span>
<a name="l00076"></a>00076 <span class="keywordtype">void</span> <a class="code" href="sim-zesto_8cpp.html#12f418d794abd0896d834c9582373b00">sim_uninit</a>(<span class="keywordtype">void</span>);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="preprocessor">#endif </span><span class="comment">/* ARCH_CPU_INCLUDED */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 23 00:20:57 2010 for IRIS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
